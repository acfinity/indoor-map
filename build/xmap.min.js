var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(l){var r=0;return function(){return r<l.length?{done:!1,value:l[r++]}:{done:!0}}};$jscomp.arrayIterator=function(l){return{next:$jscomp.arrayIteratorImpl(l)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(l,r,z){l!=Array.prototype&&l!=Object.prototype&&(l[r]=z.value)};$jscomp.getGlobal=function(l){return"undefined"!=typeof window&&window===l?l:"undefined"!=typeof global&&null!=global?global:l};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var l=0;return function(r){return $jscomp.SYMBOL_PREFIX+(r||"")+l++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.iterator;l||(l=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[l]&&$jscomp.defineProperty(Array.prototype,l,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.asyncIterator;l||(l=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(l){$jscomp.initSymbolIterator();l={next:l};l[$jscomp.global.Symbol.iterator]=function(){return this};return l};
$jscomp.iteratorFromArray=function(l,r){$jscomp.initSymbolIterator();l instanceof String&&(l+="");var z=0,v={next:function(){if(z<l.length){var C=z++;return{value:r(C,l[C]),done:!1}}v.next=function(){return{done:!0,value:void 0}};return v.next()}};v[Symbol.iterator]=function(){return v};return v};
$jscomp.polyfill=function(l,r,z,v){if(r){z=$jscomp.global;l=l.split(".");for(v=0;v<l.length-1;v++){var C=l[v];C in z||(z[C]={});z=z[C]}l=l[l.length-1];v=z[l];r=r(v);r!=v&&null!=r&&$jscomp.defineProperty(z,l,{configurable:!0,writable:!0,value:r})}};$jscomp.polyfill("Array.prototype.keys",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(l){return l})}},"es6","es3");$jscomp.underscoreProtoCanBeSet=function(){var l={a:!0},r={};try{return r.__proto__=l,r.a}catch(z){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(l,r){l.__proto__=r;if(l.__proto__!==r)throw new TypeError(l+" is not extensible");return l}:null;$jscomp.polyfill("Object.setPrototypeOf",function(l){return l||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("Array.from",function(l){return l?l:function(l,z,v){z=null!=z?z:function(l){return l};var r=[],W="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];if("function"==typeof W){l=W.call(l);for(var G=0;!(W=l.next()).done;)r.push(z.call(v,W.value,G++))}else for(W=l.length,G=0;G<W;G++)r.push(z.call(v,l[G],G));return r}},"es6","es3");$jscomp.owns=function(l,r){return Object.prototype.hasOwnProperty.call(l,r)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(l,r){for(var z=1;z<arguments.length;z++){var v=arguments[z];if(v)for(var C in v)$jscomp.owns(v,C)&&(l[C]=v[C])}return l};$jscomp.polyfill("Object.assign",function(l){return l||$jscomp.assign},"es6","es3");$jscomp.polyfill("Number.EPSILON",function(l){return Math.pow(2,-52)},"es6","es3");
$jscomp.checkStringArgs=function(l,r,z){if(null==l)throw new TypeError("The 'this' value for String.prototype."+z+" must not be null or undefined");if(r instanceof RegExp)throw new TypeError("First argument to String.prototype."+z+" must not be a regular expression");return l+""};
$jscomp.polyfill("String.prototype.repeat",function(l){return l?l:function(l){var r=$jscomp.checkStringArgs(this,null,"repeat");if(0>l||1342177279<l)throw new RangeError("Invalid count value");l|=0;for(var v="";l;)if(l&1&&(v+=r),l>>>=1)r+=r;return v}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var l={},r=Object.create(new $jscomp.global.Proxy(l,{get:function(z,v,C){return z==l&&"q"==v&&C==r}}));return!0===r.q}catch(z){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(l){var r="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];return r?r.call(l):$jscomp.arrayIterator(l)};
$jscomp.polyfill("WeakMap",function(l){function r(){if(!l||!Object.seal)return!1;try{var P=Object.seal({}),r=Object.seal({}),v=new l([[P,2],[r,3]]);if(2!=v.get(P)||3!=v.get(r))return!1;v.delete(P);v.set(r,4);return!v.has(P)&&4==v.get(r)}catch(Ja){return!1}}function z(){}function v(l){if(!$jscomp.owns(l,W)){var P=new z;$jscomp.defineProperty(l,W,{value:P})}}function C(l){var P=Object[l];P&&(Object[l]=function(l){if(l instanceof z)return l;v(l);return P(l)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&
$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;var W="$jscomp_hidden_"+Math.random();C("freeze");C("preventExtensions");C("seal");var G=0,ka=function(l){this.id_=(G+=Math.random()+1).toString();if(l){l=$jscomp.makeIterator(l);for(var P;!(P=l.next()).done;)P=P.value,this.set(P[0],P[1])}};ka.prototype.set=function(l,r){v(l);if(!$jscomp.owns(l,W))throw Error("WeakMap key fail: "+l);l[W][this.id_]=r;return this};ka.prototype.get=function(l){return $jscomp.owns(l,W)?l[W][this.id_]:void 0};ka.prototype.has=
function(l){return $jscomp.owns(l,W)&&$jscomp.owns(l[W],this.id_)};ka.prototype.delete=function(l){return $jscomp.owns(l,W)&&$jscomp.owns(l[W],this.id_)?delete l[W][this.id_]:!1};return ka},"es6","es3");$jscomp.polyfill("String.prototype.startsWith",function(l){return l?l:function(l,z){var v=$jscomp.checkStringArgs(this,l,"startsWith");l+="";var r=v.length,W=l.length;z=Math.max(0,Math.min(z|0,v.length));for(var G=0;G<W&&z<r;)if(v[z++]!=l[G++])return!1;return G>=W}},"es6","es3");
$jscomp.polyfill("Math.sign",function(l){return l?l:function(l){l=Number(l);return 0===l||isNaN(l)?l:0<l?1:-1}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(l,z){return z})}},"es8","es3");$jscomp.polyfill("Number.isFinite",function(l){return l?l:function(l){return"number"!==typeof l?!1:!isNaN(l)&&Infinity!==l&&-Infinity!==l}},"es6","es3");
$jscomp.polyfill("Number.isInteger",function(l){return l?l:function(l){return Number.isFinite(l)?l===Math.floor(l):!1}},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(l){function r(){if($jscomp.ASSUME_NO_NATIVE_MAP||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var P=Object.seal({x:4}),v=new l($jscomp.makeIterator([[P,"s"]]));if("s"!=v.get(P)||1!=v.size||v.get({x:4})||v.set({x:4},"t")!=v||2!=v.size)return!1;var r=v.entries(),G=r.next();if(G.done||G.value[0]!=P||"s"!=G.value[1])return!1;G=r.next();return G.done||4!=G.value[0].x||"t"!=G.value[1]||!r.next().done?!1:!0}catch(x){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;$jscomp.initSymbolIterator();var z=new WeakMap,v=function(l){this.data_={};this.head_=G();this.size=0;if(l){l=$jscomp.makeIterator(l);for(var v;!(v=l.next()).done;)v=v.value,this.set(v[0],v[1])}};v.prototype.set=function(l,v){l=0===l?0:l;var P=C(this,l);P.list||(P.list=this.data_[P.id]=[]);P.entry?P.entry.value=v:(P.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:l,
value:v},P.list.push(P.entry),this.head_.previous.next=P.entry,this.head_.previous=P.entry,this.size++);return this};v.prototype.delete=function(l){l=C(this,l);return l.entry&&l.list?(l.list.splice(l.index,1),l.list.length||delete this.data_[l.id],l.entry.previous.next=l.entry.next,l.entry.next.previous=l.entry.previous,l.entry.head=null,this.size--,!0):!1};v.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=G();this.size=0};v.prototype.has=function(l){return!!C(this,l).entry};
v.prototype.get=function(l){return(l=C(this,l).entry)&&l.value};v.prototype.entries=function(){return W(this,function(l){return[l.key,l.value]})};v.prototype.keys=function(){return W(this,function(l){return l.key})};v.prototype.values=function(){return W(this,function(l){return l.value})};v.prototype.forEach=function(l,v){for(var G=this.entries(),r;!(r=G.next()).done;)r=r.value,l.call(v,r[1],r[0],this)};v.prototype[Symbol.iterator]=v.prototype.entries;var C=function(l,v){var r=v&&typeof v;"object"==
r||"function"==r?z.has(v)?r=z.get(v):(r=""+ ++ka,z.set(v,r)):r="p_"+v;var G=l.data_[r];if(G&&$jscomp.owns(l.data_,r))for(l=0;l<G.length;l++){var x=G[l];if(v!==v&&x.key!==x.key||v===x.key)return{id:r,list:G,index:l,entry:x}}return{id:r,list:G,index:-1,entry:void 0}},W=function(l,v){var r=l.head_;return $jscomp.iteratorPrototype(function(){if(r){for(;r.head!=l.head_;)r=r.previous;for(;r.next!=r.head;)return r=r.next,{done:!1,value:v(r)};r=null}return{done:!0,value:void 0}})},G=function(){var l={};return l.previous=
l.next=l.head=l},ka=0;return v},"es6","es3");$jscomp.polyfill("Array.prototype.fill",function(l){return l?l:function(l,z,v){var r=this.length||0;0>z&&(z=Math.max(0,r+z));if(null==v||v>r)v=r;v=Number(v);0>v&&(v=Math.max(0,r+v));for(z=Number(z||0);z<v;z++)this[z]=l;return this}},"es6","es3");$jscomp.findInternal=function(l,r,z){l instanceof String&&(l=String(l));for(var v=l.length,C=0;C<v;C++){var W=l[C];if(r.call(z,W,C,l))return{i:C,v:W}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(l){return l?l:function(l,z){return $jscomp.findInternal(this,l,z).v}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(l){function r(){this.batch_=null}function z(l){return l instanceof C?l:new C(function(v,r){v(l)})}if(l&&!$jscomp.FORCE_POLYFILL_PROMISE)return l;r.prototype.asyncExecute=function(l){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(l);return this};r.prototype.asyncExecuteBatch_=function(){var l=this;this.asyncExecuteFunction(function(){l.executeBatch_()})};var v=$jscomp.global.setTimeout;r.prototype.asyncExecuteFunction=function(l){v(l,
0)};r.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var l=this.batch_;this.batch_=[];for(var v=0;v<l.length;++v){var r=l[v];l[v]=null;try{r()}catch(dd){this.asyncThrow_(dd)}}}this.batch_=null};r.prototype.asyncThrow_=function(l){this.asyncExecuteFunction(function(){throw l;})};var C=function(l){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var v=this.createResolveAndReject_();try{l(v.resolve,v.reject)}catch(P){v.reject(P)}};C.prototype.createResolveAndReject_=
function(){function l(l){return function(G){r||(r=!0,l.call(v,G))}}var v=this,r=!1;return{resolve:l(this.resolveTo_),reject:l(this.reject_)}};C.prototype.resolveTo_=function(l){if(l===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(l instanceof C)this.settleSameAsPromise_(l);else{a:switch(typeof l){case "object":var v=null!=l;break a;case "function":v=!0;break a;default:v=!1}v?this.resolveToNonPromiseObj_(l):this.fulfill_(l)}};C.prototype.resolveToNonPromiseObj_=function(l){var v=
void 0;try{v=l.then}catch(P){this.reject_(P);return}"function"==typeof v?this.settleSameAsThenable_(v,l):this.fulfill_(l)};C.prototype.reject_=function(l){this.settle_(2,l)};C.prototype.fulfill_=function(l){this.settle_(1,l)};C.prototype.settle_=function(l,v){if(0!=this.state_)throw Error("Cannot settle("+l+", "+v+"): Promise already settled in state"+this.state_);this.state_=l;this.result_=v;this.executeOnSettledCallbacks_()};C.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var l=
0;l<this.onSettledCallbacks_.length;++l)W.asyncExecute(this.onSettledCallbacks_[l]);this.onSettledCallbacks_=null}};var W=new r;C.prototype.settleSameAsPromise_=function(l){var v=this.createResolveAndReject_();l.callWhenSettled_(v.resolve,v.reject)};C.prototype.settleSameAsThenable_=function(l,v){var r=this.createResolveAndReject_();try{l.call(v,r.resolve,r.reject)}catch(dd){r.reject(dd)}};C.prototype.then=function(l,v){function r(l,v){return"function"==typeof l?function(v){try{z(l(v))}catch(n){G(n)}}:
v}var z,G,W=new C(function(l,v){z=l;G=v});this.callWhenSettled_(r(l,z),r(v,G));return W};C.prototype.catch=function(l){return this.then(void 0,l)};C.prototype.callWhenSettled_=function(l,v){function r(){switch(z.state_){case 1:l(z.result_);break;case 2:v(z.result_);break;default:throw Error("Unexpected state: "+z.state_);}}var z=this;null==this.onSettledCallbacks_?W.asyncExecute(r):this.onSettledCallbacks_.push(r)};C.resolve=z;C.reject=function(l){return new C(function(v,r){r(l)})};C.race=function(l){return new C(function(v,
r){for(var C=$jscomp.makeIterator(l),G=C.next();!G.done;G=C.next())z(G.value).callWhenSettled_(v,r)})};C.all=function(l){var v=$jscomp.makeIterator(l),r=v.next();return r.done?z([]):new C(function(l,C){function G(v){return function(n){x[v]=n;I--;0==I&&l(x)}}var x=[],I=0;do x.push(void 0),I++,z(r.value).callWhenSettled_(G(x.length-1),C),r=v.next();while(!r.done)})};return C},"es6","es3");
$jscomp.polyfill("Object.entries",function(l){return l?l:function(l){var r=[],v;for(v in l)$jscomp.owns(l,v)&&r.push([v,l[v]]);return r}},"es8","es3");
$jscomp.polyfill("Set",function(l){function r(){if($jscomp.ASSUME_NO_NATIVE_SET||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var v=Object.seal({x:4}),r=new l($jscomp.makeIterator([v]));if(!r.has(v)||1!=r.size||r.add(v)!=r||1!=r.size||r.add({x:4})!=r||2!=r.size)return!1;var z=r.entries(),G=z.next();if(G.done||G.value[0]!=v||G.value[1]!=v)return!1;G=z.next();return G.done||G.value[0]==v||4!=G.value[0].x||G.value[1]!=G.value[0]?!1:z.next().done}catch(ka){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;$jscomp.initSymbolIterator();var z=function(l){this.map_=new Map;if(l){l=$jscomp.makeIterator(l);for(var v;!(v=l.next()).done;)this.add(v.value)}this.size=this.map_.size};z.prototype.add=function(l){l=0===l?0:l;this.map_.set(l,l);this.size=this.map_.size;return this};z.prototype.delete=function(l){l=this.map_.delete(l);this.size=this.map_.size;return l};z.prototype.clear=function(){this.map_.clear();
this.size=0};z.prototype.has=function(l){return this.map_.has(l)};z.prototype.entries=function(){return this.map_.entries()};z.prototype.values=function(){return this.map_.values()};z.prototype.keys=z.prototype.values;z.prototype[Symbol.iterator]=z.prototype.values;z.prototype.forEach=function(l,r){var v=this;this.map_.forEach(function(z){return l.call(r,z,z,v)})};return z},"es6","es3");
!function(l,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):l.XMap=r()}(this,function(){function l(a){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function z(a,b){for(var c=
0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function v(a,b,c){return b&&z(a.prototype,b),c&&z(a,c),a}function C(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});b&&G(a,b)}function W(a){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||
Object.getPrototypeOf(a)})(a)}function G(a,b){return(G=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function ka(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function P(a,b){return!b||"object"!=typeof b&&"function"!=typeof b?ka(a):b}function dd(a,b){var c=Array.isArray(a)?a:void 0;if(!c){c=[];var d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=
!0);}catch(k){e=!0,f=k}finally{try{d||null==h.return||h.return()}finally{if(e)throw f;}}}if(!(a=c))throw new TypeError("Invalid attempt to destructure non-iterable instance");return a}function Fb(a){if(Array.isArray(a)){var b=0;for(var c=Array(a.length);b<a.length;b++)c[b]=a[b];b=c}else b=void 0;b||(b=Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)?Array.from(a):void 0);if(!(a=b))throw new TypeError("Invalid attempt to spread non-iterable instance");return a}
function Ja(){}function x(a,b){this.x=a||0;this.y=b||0}function I(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];arguments.length}function la(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1}function n(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0}function ua(){this.elements=[1,0,0,0,1,0,0,0,1];arguments.length}function Z(a,b,c,d,e,f,g,h,k,m){Object.defineProperty(this,"id",{value:Dj++});this.uuid=Q.generateUUID();this.name="";this.image=void 0!==a?a:Z.DEFAULT_IMAGE;this.mipmaps=
[];this.mapping=void 0!==b?b:Z.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:1001;this.wrapT=void 0!==d?d:1001;this.magFilter=void 0!==e?e:1006;this.minFilter=void 0!==f?f:1008;this.anisotropy=void 0!==k?k:1;this.format=void 0!==g?g:1023;this.type=void 0!==h?h:1009;this.offset=new x(0,0);this.repeat=new x(1,1);this.center=new x(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new ua;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==m?m:
3E3;this.version=0;this.onUpdate=null}function da(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1}function Gb(a,b,c){this.width=a;this.height=b;this.scissor=new da(0,0,a,b);this.scissorTest=!1;this.viewport=new da(0,0,a,b);c=c||{};this.texture=new Z(void 0,void 0,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding);this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps;this.texture.minFilter=void 0!==c.minFilter?c.minFilter:1006;this.depthBuffer=
void 0===c.depthBuffer||c.depthBuffer;this.stencilBuffer=void 0===c.stencilBuffer||c.stencilBuffer;this.depthTexture=void 0!==c.depthTexture?c.depthTexture:null}function jc(a,b,c){Gb.call(this,a,b,c);this.activeMipMapLevel=this.activeCubeFace=0}function Hb(a,b,c,d,e,f,g,h,k,m,q,p){Z.call(this,null,f,g,h,k,m,d,e,q,p);this.image={data:a,width:b,height:c};this.magFilter=void 0!==k?k:1003;this.minFilter=void 0!==m?m:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function fb(a,b){this.min=
void 0!==a?a:new n(1/0,1/0,1/0);this.max=void 0!==b?b:new n(-1/0,-1/0,-1/0)}function Ka(a,b){this.center=void 0!==a?a:new n;this.radius=void 0!==b?b:0}function Xa(a,b){this.normal=void 0!==a?a:new n(1,0,0);this.constant=void 0!==b?b:0}function Ae(a,b,c,d,e,f){this.planes=[void 0!==a?a:new Xa,void 0!==b?b:new Xa,void 0!==c?c:new Xa,void 0!==d?d:new Xa,void 0!==e?e:new Xa,void 0!==f?f:new Xa]}function kc(a){var b={},c;for(c in a)for(var d in b[c]={},a[c]){var e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||
e.isVector2||e.isVector3||e.isVector4||e.isTexture)?b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}return b}function Aa(a){for(var b={},c=0;c<a.length;c++){var d=kc(a[c]),e;for(e in d)b[e]=d[e]}return b}function L(a,b,c){return void 0===b&&void 0===c?this.set(a):this.setRGB(a,b,c)}function Cf(){function a(e,f){!1!==c&&(d(e,f),b.requestAnimationFrame(a))}var b=null,c=!1,d=null;return{start:function(){!0!==c&&null!==d&&(b.requestAnimationFrame(a),c=!0)},stop:function(){c=!1},setAnimationLoop:function(a){d=
a},setContext:function(a){b=a}}}function Ej(a){var b=new WeakMap;return{get:function(a){return a.isInterleavedBufferAttribute&&(a=a.data),b.get(a)},remove:function(c){c.isInterleavedBufferAttribute&&(c=c.data);var d=b.get(c);d&&(a.deleteBuffer(d.buffer),b.delete(c))},update:function(c,d){c.isInterleavedBufferAttribute&&(c=c.data);var e,f,g,h,k=b.get(c);void 0===k?b.set(c,function(b,c){var d=b.array,e=b.dynamic?35048:35044,f=a.createBuffer();a.bindBuffer(c,f);a.bufferData(c,d,e);b.onUploadCallback();
c=5126;return d instanceof Float32Array?c=5126:d instanceof Float64Array||(d instanceof Uint16Array?c=5123:d instanceof Int16Array?c=5122:d instanceof Uint32Array?c=5125:d instanceof Int32Array?c=5124:d instanceof Int8Array?c=5120:d instanceof Uint8Array&&(c=5121)),{buffer:f,type:c,bytesPerElement:d.BYTES_PER_ELEMENT,version:b.version}}(c,d)):k.version<c.version&&(e=k.buffer,g=(f=c).array,h=f.updateRange,a.bindBuffer(d,e),!1===f.dynamic?a.bufferData(d,g,35044):-1===h.count?a.bufferSubData(d,0,g):
0===h.count||(a.bufferSubData(d,h.offset*g.BYTES_PER_ELEMENT,g.subarray(h.offset,h.offset+h.count)),h.count=-1),k.version=c.version)}}}function lc(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d&&d.isVector3?d:new n;this.vertexNormals=Array.isArray(d)?d:[];this.color=e&&e.isColor?e:new L;this.vertexColors=Array.isArray(e)?e:[];this.materialIndex=void 0!==f?f:0}function Ib(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||Ib.DefaultOrder}function Df(){this.mask=1}function E(){Object.defineProperty(this,
"id",{value:Fj++});this.uuid=Q.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=E.DefaultUp.clone();var a=new n,b=new Ib,c=new la,d=new n(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,
value:d},modelViewMatrix:{value:new I},normalMatrix:{value:new ua}});this.matrix=new I;this.matrixWorld=new I;this.matrixAutoUpdate=E.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new Df;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}}function J(){Object.defineProperty(this,"id",{value:Gj+=2});this.uuid=Q.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=
[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function X(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/
b:0;this.normalized=!0===c;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function ed(a,b,c){X.call(this,new Int8Array(a),b,c)}function fd(a,b,c){X.call(this,new Uint8Array(a),b,c)}function gd(a,b,c){X.call(this,new Uint8ClampedArray(a),b,c)}function hd(a,b,c){X.call(this,new Int16Array(a),b,c)}function Jb(a,b,c){X.call(this,new Uint16Array(a),b,c)}function id(a,b,c){X.call(this,new Int32Array(a),b,c)}function Kb(a,b,c){X.call(this,new Uint32Array(a),b,c)}function B(a,b,c){X.call(this,
new Float32Array(a),b,c)}function jd(a,b,c){X.call(this,new Float64Array(a),b,c)}function Ah(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Bh(a){if(0===a.length)return-1/0;for(var b=a[0],c=1,d=a.length;c<d;++c)a[c]>b&&(b=a[c]);return b}
function F(){Object.defineProperty(this,"id",{value:Hj+=2});this.uuid=Q.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:1/0};this.userData={}}function mc(a,b,c,d,e,f){J.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};this.fromBufferGeometry(new Lb(a,b,c,d,e,f));this.mergeVertices()}
function Lb(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,l,V,R,M){var t=f/V,u=g/R,D=f/2,O=g/2,y=l/2,N=V+1,qa=R+1,v=0,r=0,Ca=new n;for(f=0;f<qa;f++){var x=f*u-O;for(g=0;g<N;g++)Ca[a]=(g*t-D)*d,Ca[b]=x*e,Ca[c]=y,m.push(Ca.x,Ca.y,Ca.z),Ca[a]=0,Ca[b]=0,Ca[c]=0<l?1:-1,q.push(Ca.x,Ca.y,Ca.z),p.push(g/V),p.push(1-f/R),v+=1}for(f=0;f<R;f++)for(g=0;g<V;g++)a=w+g+N*(f+1),b=w+(g+1)+N*(f+1),c=w+(g+1)+N*f,k.push(w+g+N*f,a,c),k.push(a,b,c),r+=6;h.addGroup(T,r,M);T+=r;w+=v}F.call(this);this.type="BoxBufferGeometry";this.parameters=
{width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};var h=this;a=a||1;b=b||1;c=c||1;d=Math.floor(d)||1;e=Math.floor(e)||1;f=Math.floor(f)||1;var k=[],m=[],q=[],p=[],w=0,T=0;g("z","y","x",-1,-1,c,b,a,f,e,0);g("z","y","x",1,-1,c,b,-a,f,e,1);g("x","z","y",1,1,a,c,b,d,f,2);g("x","z","y",1,-1,a,c,-b,d,f,3);g("x","y","z",1,-1,a,b,c,d,e,4);g("x","y","z",-1,-1,a,b,-c,d,e,5);this.setIndex(k);this.addAttribute("position",new B(m,3));this.addAttribute("normal",new B(q,3));this.addAttribute("uv",
new B(p,2))}function kd(a,b,c,d){J.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new Mb(a,b,c,d));this.mergeVertices()}function Mb(a,b,c,d){F.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var e=(a=a||1)/2,f=(b=b||1)/2;c=Math.floor(c)||1;d=Math.floor(d)||1;var g=c+1,h=d+1,k=a/c,m=b/d,q=[],p=[],w=[],T=[];for(a=0;a<h;a++){var u=a*m-f;for(b=0;b<g;b++)p.push(b*
k-e,-u,0),w.push(0,0,1),T.push(b/c),T.push(1-a/d)}for(a=0;a<d;a++)for(b=0;b<c;b++)e=b+g*(a+1),f=b+1+g*(a+1),h=b+1+g*a,q.push(b+g*a,e,h),q.push(e,f,h);this.setIndex(q);this.addAttribute("position",new B(p,3));this.addAttribute("normal",new B(w,3));this.addAttribute("uv",new B(T,2))}function U(){Object.defineProperty(this,"id",{value:Ij++});this.uuid=Q.generateUUID();this.name="";this.type="Material";this.lights=this.fog=!0;this.blending=1;this.side=0;this.flatShading=!1;this.vertexColors=0;this.opacity=
1;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.dithering=!1;this.alphaTest=0;this.premultipliedAlpha=!1;this.visible=!0;this.userData={};this.needsUpdate=
!0}function Ea(a){U.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};
this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;void 0!==a&&(a.attributes,this.setValues(a))}function Nb(a,b){this.origin=void 0!==a?a:new n;this.direction=void 0!==b?b:new n}function sa(a,b,c){this.a=void 0!==a?a:new n;this.b=void 0!==b?b:new n;this.c=void 0!==c?c:new n}function Ha(a){U.call(this);this.type="MeshBasicMaterial";this.color=new L(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=
1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.lights=this.morphTargets=this.skinning=!1;this.setValues(a)}function wa(a,b){E.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new F;this.material=void 0!==b?b:new Ha({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}function Jj(a,b,c,d){function e(a,c){b.buffers.color.setClear(a.r,
a.g,a.b,c,d)}var f,g,h=new L(0),k=0,m=null,q=0;return{getClearColor:function(){return h},setClearColor:function(a,b){h.set(a);e(h,k=void 0!==b?b:1)},getClearAlpha:function(){return k},setClearAlpha:function(a){e(h,k=a)},render:function(b,d,T,u){d=d.background;(null===d?(e(h,k),m=null,q=0):d&&d.isColor&&(e(d,1),u=!0,m=null,q=0),(a.autoClear||u)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLRenderTargetCube))?(void 0===g&&((g=new wa(new Lb(1,1,1),new Ea({type:"BackgroundCubeMaterial",
uniforms:kc(Ya.cube.uniforms),vertexShader:Ya.cube.vertexShader,fragmentShader:Ya.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),g.geometry.removeAttribute("uv"),g.onBeforeRender=function(a,b,c){this.matrixWorld.copyPosition(c.matrixWorld)},Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.tCube.value}}),c.update(g)),u=d.isWebGLRenderTargetCube?d.texture:d,g.material.uniforms.tCube.value=u,g.material.uniforms.tFlip.value=
d.isWebGLRenderTargetCube?1:-1,m===d&&q===u.version||(g.material.needsUpdate=!0,m=d,q=u.version),b.unshift(g,g.geometry,g.material,0,null)):d&&d.isTexture&&(void 0===f&&((f=new wa(new Mb(2,2),new Ea({type:"BackgroundMaterial",uniforms:kc(Ya.background.uniforms),vertexShader:Ya.background.vertexShader,fragmentShader:Ya.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),
c.update(f)),!0===(f.material.uniforms.t2D.value=d).matrixAutoUpdate&&d.updateMatrix(),f.material.uniforms.uvTransform.value.copy(d.matrix),m===d&&q===d.version||(f.material.needsUpdate=!0,q=(m=d).version),b.unshift(f,f.geometry,f.material,0,null))}}}function Kj(a,b,c,d){var e;this.setMode=function(a){e=a};this.render=function(b,d){a.drawArrays(e,b,d);c.update(d,e)};this.renderInstances=function(f,g,h){if(d.isWebGL2)var k=a;else if(null===(k=b.get("ANGLE_instanced_arrays")))return;k[d.isWebGL2?"drawArraysInstanced":
"drawArraysInstancedANGLE"](e,g,h,f.maxInstancedCount);c.update(h,e,f.maxInstancedCount)}}function Lj(a,b,c){function d(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(35633,36338).precision&&0<a.getShaderPrecisionFormat(35632,36338).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(35633,36337).precision&&0<a.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var e,f="undefined"!=typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext,
g=void 0!==c.precision?c.precision:"highp",h=d(g);h!==g&&(g=h);c=!0===c.logarithmicDepthBuffer;h=a.getParameter(34930);var k=a.getParameter(35660),m=a.getParameter(3379),q=a.getParameter(34076),p=a.getParameter(34921),w=a.getParameter(36347),T=a.getParameter(36348),u=a.getParameter(36349),t=0<k,l=f||!!b.get("OES_texture_float");return{isWebGL2:f,getMaxAnisotropy:function(){if(void 0!==e)return e;var c=b.get("EXT_texture_filter_anisotropic");return e=null!==c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):
0},getMaxPrecision:d,precision:g,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:k,maxTextureSize:m,maxCubemapSize:q,maxAttributes:p,maxVertexUniforms:w,maxVaryings:T,maxFragmentUniforms:u,vertexTextures:t,floatFragmentTextures:l,floatVertexTextures:t&&l}}function Mj(){function a(){m.value!==d&&(m.value=d,m.needsUpdate=0<e);c.numPlanes=e;c.numIntersection=0}function b(a,b,d,e){var f=null!==a?a.length:0,g=null;if(0!==f){if(g=m.value,!0!==e||null===g)for(e=d+4*f,b=b.matrixWorldInverse,k.getNormalMatrix(b),
(null===g||g.length<e)&&(g=new Float32Array(e)),e=0;e!==f;++e,d+=4)h.copy(a[e]).applyMatrix4(b,k),h.normal.toArray(g,d),g[d+3]=h.constant;m.value=g;m.needsUpdate=!0}return c.numPlanes=f,g}var c=this,d=null,e=0,f=!1,g=!1,h=new Xa,k=new ua,m={value:null,needsUpdate:!1};this.uniform=m;this.numIntersection=this.numPlanes=0;this.init=function(a,c,g){var h=0!==a.length||c||0!==e||f;return f=c,d=b(a,g,0),e=a.length,h};this.beginShadows=function(){g=!0;b(null)};this.endShadows=function(){g=!1;a()};this.setState=
function(c,h,k,l,u,t){if(!f||null===c||0===c.length||g&&!k)g?b(null):a();else{k=g?0:e;var q=4*k,p=u.clippingState||null;m.value=p;p=b(c,l,q,t);for(c=0;c!==q;++c)p[c]=d[c];u.clippingState=p;this.numIntersection=h?this.numPlanes:0;this.numPlanes+=k}}}function Nj(a){var b={};return{get:function(c){if(void 0!==b[c])return b[c];switch(c){case "WEBGL_depth_texture":var d=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;
case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
break;default:d=a.getExtension(c)}return b[c]=d}}}function Oj(a,b,c){function d(a){var g=a.target;a=e[g.id];for(var k in null!==a.index&&b.remove(a.index),a.attributes)b.remove(a.attributes[k]);g.removeEventListener("dispose",d);delete e[g.id];(k=f[a.id])&&(b.remove(k),delete f[a.id]);c.memory.geometries--}var e={},f={};return{get:function(a,b){var f=e[b.id];return f||(b.addEventListener("dispose",d),b.isBufferGeometry?f=b:b.isGeometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new F).setFromObject(a)),
f=b._bufferGeometry),e[b.id]=f,c.memory.geometries++,f)},update:function(a){var c=a.index,d=a.attributes,e;for(e in null!==c&&b.update(c,34963),d)b.update(d[e],34962);a=a.morphAttributes;for(e in a){c=a[e];d=0;for(var f=c.length;d<f;d++)b.update(c[d],34962)}},getWireframeAttribute:function(a){var c=f[a.id];if(c)return c;var d=[];var e=a.index;var g=a.attributes;if(null!==e){var p=0;for(g=(e=e.array).length;p<g;p+=3){var w=e[p+0],l=e[p+1],u=e[p+2];d.push(w,l,l,u,u,w)}}else for(p=0,g=g.position.array.length/
3-1;p<g;p+=3)w=p+0,l=p+1,u=p+2,d.push(w,l,l,u,u,w);return c=new (65535<Bh(d)?Kb:Jb)(d,1),b.update(c,34963),f[a.id]=c}}}function Pj(a,b,c,d){var e,f,g;this.setMode=function(a){e=a};this.setIndex=function(a){f=a.type;g=a.bytesPerElement};this.render=function(b,d){a.drawElements(e,d,f,b*g);c.update(d,e)};this.renderInstances=function(h,k,m){if(d.isWebGL2)var q=a;else if(null===(q=b.get("ANGLE_instanced_arrays")))return;q[d.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](e,m,f,k*g,h.maxInstancedCount);
c.update(m,e,h.maxInstancedCount)}}function Qj(a){var b={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:b,programs:null,autoReset:!0,reset:function(){b.frame++;b.calls=0;b.triangles=0;b.points=0;b.lines=0},update:function(a,d,e){switch(e=e||1,b.calls++,d){case 4:b.triangles+=a/3*e;break;case 5:case 6:b.triangles+=e*(a-2);break;case 1:b.lines+=a/2*e;break;case 3:b.lines+=e*(a-1);break;case 2:b.lines+=e*a;break;case 0:b.points+=e*a}}}}function Rj(a,b){return Math.abs(b[1])-
Math.abs(a[1])}function Sj(a){var b={},c=new Float32Array(8);return{update:function(d,e,f,g){var h=d.morphTargetInfluences,k=h.length;d=b[e.id];if(void 0===d){d=[];for(var m=0;m<k;m++)d[m]=[m,0];b[e.id]=d}var q=f.morphTargets&&e.morphAttributes.position;f=f.morphNormals&&e.morphAttributes.normal;for(m=0;m<k;m++)0!==d[m][1]&&(q&&e.removeAttribute("morphTarget"+m),f&&e.removeAttribute("morphNormal"+m));for(m=0;m<k;m++)(p=d[m])[0]=m,p[1]=h[m];d.sort(Rj);for(m=0;8>m;m++){var p;if(p=d[m])if(h=p[0],k=p[1]){q&&
e.addAttribute("morphTarget"+m,q[h]);f&&e.addAttribute("morphNormal"+m,f[h]);c[m]=k;continue}c[m]=0}g.getUniforms().setValue(a,"morphTargetInfluences",c)}}}function Tj(a,b){var c={};return{update:function(d){var e=b.render.frame,f=d.geometry,g=a.get(d,f);return c[g.id]!==e&&(f.isGeometry&&g.updateFromObject(d),a.update(g),c[g.id]=e),g},dispose:function(){c={}}}}function gb(a,b,c,d,e,f,g,h,k,m){a=void 0!==a?a:[];Z.call(this,a,void 0!==b?b:301,c,d,e,f,g,h,k,m);this.flipY=!1}function nc(a,b,c,d){Z.call(this,
null);this.image={data:a,width:b,height:c,depth:d};this.minFilter=this.magFilter=1003;this.flipY=this.generateMipmaps=!1}function oc(a,b,c){var d=a[0];if(0>=d||0<d)return a;var e=b*c,f=Ch[e];if(void 0===f&&(f=new Float32Array(e),Ch[e]=f),0!==b)for(d.toArray(f,0),d=1,e=0;d!==b;++d)e+=c,a[d].toArray(f,e);return f}function ha(a,b){if(a.length!==b.length)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}function na(a,b){for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}function Dh(a,b){var c=
Eh[b];void 0===c&&(c=new Int32Array(b),Eh[b]=c);for(var d=0;d!==b;++d)c[d]=a.allocTextureUnit();return c}function Uj(a,b){var c=this.cache;c[0]!==b&&(a.uniform1f(this.addr,b),c[0]=b)}function Vj(a,b){var c=this.cache;c[0]!==b&&(a.uniform1i(this.addr,b),c[0]=b)}function Wj(a,b){var c=this.cache;void 0!==b.x?c[0]===b.x&&c[1]===b.y||(a.uniform2f(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y):ha(c,b)||(a.uniform2fv(this.addr,b),na(c,b))}function Xj(a,b){var c=this.cache;void 0!==b.x?c[0]===b.x&&c[1]===b.y&&c[2]===
b.z||(a.uniform3f(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z):void 0!==b.r?c[0]===b.r&&c[1]===b.g&&c[2]===b.b||(a.uniform3f(this.addr,b.r,b.g,b.b),c[0]=b.r,c[1]=b.g,c[2]=b.b):ha(c,b)||(a.uniform3fv(this.addr,b),na(c,b))}function Yj(a,b){var c=this.cache;void 0!==b.x?c[0]===b.x&&c[1]===b.y&&c[2]===b.z&&c[3]===b.w||(a.uniform4f(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w):ha(c,b)||(a.uniform4fv(this.addr,b),na(c,b))}function Zj(a,b){var c=this.cache,d=b.elements;void 0===d?
ha(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),na(c,b)):ha(c,d)||(Fh.set(d),a.uniformMatrix2fv(this.addr,!1,Fh),na(c,d))}function ak(a,b){var c=this.cache,d=b.elements;void 0===d?ha(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),na(c,b)):ha(c,d)||(Gh.set(d),a.uniformMatrix3fv(this.addr,!1,Gh),na(c,d))}function bk(a,b){var c=this.cache,d=b.elements;void 0===d?ha(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),na(c,b)):ha(c,d)||(Hh.set(d),a.uniformMatrix4fv(this.addr,!1,Hh),na(c,d))}function ck(a,b,c){var d=this.cache,
e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture2D(b||Ih,e)}function dk(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture3D(b||ek,e)}function fk(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTextureCube(b||Jh,e)}function Kh(a,b){var c=this.cache;ha(c,b)||(a.uniform2iv(this.addr,b),na(c,b))}function Lh(a,b){var c=this.cache;ha(c,b)||(a.uniform3iv(this.addr,b),na(c,
b))}function Mh(a,b){var c=this.cache;ha(c,b)||(a.uniform4iv(this.addr,b),na(c,b))}function gk(a){switch(a){case 5126:return Uj;case 35664:return Wj;case 35665:return Xj;case 35666:return Yj;case 35674:return Zj;case 35675:return ak;case 35676:return bk;case 35678:case 36198:return ck;case 35679:return dk;case 35680:return fk;case 5124:case 35670:return Vj;case 35667:case 35671:return Kh;case 35668:case 35672:return Lh;case 35669:case 35673:return Mh}}function hk(a,b){var c=this.cache;ha(c,b)||(a.uniform1fv(this.addr,
b),na(c,b))}function ik(a,b){var c=this.cache;ha(c,b)||(a.uniform1iv(this.addr,b),na(c,b))}function jk(a,b){var c=this.cache;b=oc(b,this.size,2);ha(c,b)||(a.uniform2fv(this.addr,b),this.updateCache(b))}function kk(a,b){var c=this.cache;b=oc(b,this.size,3);ha(c,b)||(a.uniform3fv(this.addr,b),this.updateCache(b))}function lk(a,b){var c=this.cache;b=oc(b,this.size,4);ha(c,b)||(a.uniform4fv(this.addr,b),this.updateCache(b))}function mk(a,b){var c=this.cache;b=oc(b,this.size,4);ha(c,b)||(a.uniformMatrix2fv(this.addr,
!1,b),this.updateCache(b))}function nk(a,b){var c=this.cache;b=oc(b,this.size,9);ha(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),this.updateCache(b))}function ok(a,b){var c=this.cache;b=oc(b,this.size,16);ha(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),this.updateCache(b))}function pk(a,b,c){var d=this.cache,e=b.length,f=Dh(c,e);!1===ha(d,f)&&(a.uniform1iv(this.addr,f),na(d,f));for(a=0;a!==e;++a)c.setTexture2D(b[a]||Ih,f[a])}function qk(a,b,c){var d=this.cache,e=b.length,f=Dh(c,e);!1===ha(d,f)&&(a.uniform1iv(this.addr,
f),na(d,f));for(a=0;a!==e;++a)c.setTextureCube(b[a]||Jh,f[a])}function rk(a){switch(a){case 5126:return hk;case 35664:return jk;case 35665:return kk;case 35666:return lk;case 35674:return mk;case 35675:return nk;case 35676:return ok;case 35678:return pk;case 35680:return qk;case 5124:case 35670:return ik;case 35667:case 35671:return Kh;case 35668:case 35672:return Lh;case 35669:case 35673:return Mh}}function sk(a,b,c){this.id=a;this.addr=c;this.cache=[];this.setValue=gk(b.type)}function Nh(a,b,c){this.id=
a;this.addr=c;this.cache=[];this.size=b.size;this.setValue=rk(b.type)}function Oh(a){this.id=a;this.seq=[];this.map={}}function rb(a,b,c){this.seq=[];this.map={};this.renderer=c;c=a.getProgramParameter(b,35718);for(var d=0;d<c;++d){var e=a.getActiveUniform(b,d),f=e;e=a.getUniformLocation(b,e.name);var g=this,h=f.name,k=h.length;for(Ff.lastIndex=0;;){var m=Ff.exec(h),q=Ff.lastIndex,p=m[1],w=m[3];if("]"===m[2]&&(p|=0),void 0===w||"["===w&&q+2===k){h=g;f=void 0===w?new sk(p,f,e):new Nh(p,f,e);h.seq.push(f);
h.map[f.id]=f;break}w=g.map[p];void 0===w&&(p=w=new Oh(p),g.seq.push(p),g.map[p.id]=p);g=w}}}function Ph(a,b,c){b=a.createShader(b);return a.shaderSource(b,c),a.compileShader(b),a.getShaderParameter(b,35713),a.getShaderInfoLog(b),b}function Qh(a){switch(a){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma",
"( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a);}}function De(a,b){b=Qh(b);return"vec4 "+a+"( vec4 value ) { return "+b[0]+"ToLinear"+b[1]+"; }"}function tk(a,b){b=Qh(b);return"vec4 "+a+"( vec4 value ) { return LinearTo"+b[0]+b[1]+"; }"}function uk(a,b){switch(b){case 1:b="Linear";break;case 2:b="Reinhard";break;case 3:b="Uncharted2";break;case 4:b="OptimizedCineon";break;case 5:b="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+b);}return"vec3 "+
a+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}function vk(a,b,c){return[(a=a||{}).derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap&&!b.objectSpaceNormalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":
""].filter(ld).join("\n")}function wk(a){var b=[],c;for(c in a){var d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function ld(a){return""!==a}function Rh(a,b){return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights)}function Sh(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,
b.numClippingPlanes-b.numClipIntersection)}function Gf(a){return a.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(a,c){a=Y[c];if(void 0===a)throw Error("Can not resolve #include <"+c+">");return Gf(a)})}function Th(a){return a.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,c,d,e){a="";for(c=parseInt(c);c<parseInt(d);c++)a+=e.replace(/\[ i \]/g,"[ "+c+" ]");return a})}function xk(a,b,c,d,e,f,g){var h=a.context,k=d.defines,m=e.vertexShader,
q=e.fragmentShader,p="SHADOWMAP_TYPE_BASIC";1===f.shadowMapType?p="SHADOWMAP_TYPE_PCF":2===f.shadowMapType&&(p="SHADOWMAP_TYPE_PCF_SOFT");var w="ENVMAP_TYPE_CUBE",l="ENVMAP_MODE_REFLECTION",u="ENVMAP_BLENDING_MULTIPLY";if(f.envMap){switch(d.envMap.mapping){case 301:case 302:w="ENVMAP_TYPE_CUBE";break;case 306:case 307:w="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:w="ENVMAP_TYPE_EQUIREC";break;case 305:w="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case 302:case 304:l="ENVMAP_MODE_REFRACTION"}switch(d.combine){case 0:u=
"ENVMAP_BLENDING_MULTIPLY";break;case 1:u="ENVMAP_BLENDING_MIX";break;case 2:u="ENVMAP_BLENDING_ADD"}}var t,n,qa=0<a.gammaFactor?a.gammaFactor:1,y=g.isWebGL2?"":vk(d.extensions,f,b);k=wk(k);var O=h.createProgram();if(d.isRawShaderMaterial?(0<(t=[k].filter(ld).join("\n")).length&&(t+="\n"),0<(n=[y,k].filter(ld).join("\n")).length&&(n+="\n")):(t=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,k,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"",
"#define GAMMA_FACTOR "+qa,"#define MAX_BONES "+f.maxBones,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+l:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?
"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":
"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+p:"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;",
"attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;",
"\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ld).join("\n"),n=[y,"precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,k,f.alphaTest?"#define ALPHATEST "+f.alphaTest+(f.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+qa,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":
"",f.matcap?"#define USE_MATCAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+w:"",f.envMap?"#define "+l:"",f.envMap?"#define "+u:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?
"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.gradientMap?"#define USE_GRADIENTMAP":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+p:"",f.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":
"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",f.envMap&&(g.isWebGL2||b.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==f.toneMapping?"#define TONE_MAPPING":"",0!==f.toneMapping?Y.tonemapping_pars_fragment:"",0!==f.toneMapping?uk("toneMapping",f.toneMapping):"",f.dithering?"#define DITHERING":"",f.outputEncoding||f.mapEncoding||f.matcapEncoding||f.envMapEncoding||f.emissiveMapEncoding?
Y.encodings_pars_fragment:"",f.mapEncoding?De("mapTexelToLinear",f.mapEncoding):"",f.matcapEncoding?De("matcapTexelToLinear",f.matcapEncoding):"",f.envMapEncoding?De("envMapTexelToLinear",f.envMapEncoding):"",f.emissiveMapEncoding?De("emissiveMapTexelToLinear",f.emissiveMapEncoding):"",f.outputEncoding?tk("linearToOutputTexel",f.outputEncoding):"",f.depthPacking?"#define DEPTH_PACKING "+d.depthPacking:"","\n"].filter(ld).join("\n")),m=Sh(m=Rh(m=Gf(m),f),f),q=Sh(q=Rh(q=Gf(q),f),f),m=Th(m),q=Th(q),
g.isWebGL2&&!d.isRawShaderMaterial)b=!1,g=/^\s*#version\s+300\s+es\s*\n/,d.isShaderMaterial&&null!==m.match(g)&&null!==q.match(g)&&(b=!0,m=m.replace(g,""),q=q.replace(g,"")),t="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+t,n=["#version 300 es\n\n#define varying in",b?"":"out highp vec4 pc_fragColor;",b?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+
"\n"+n;q=n+q;m=Ph(h,35633,t+m);q=Ph(h,35632,q);h.attachShader(O,m);h.attachShader(O,q);void 0!==d.index0AttributeName?h.bindAttribLocation(O,0,d.index0AttributeName):!0===f.morphTargets&&h.bindAttribLocation(O,0,"position");h.linkProgram(O);var N,v;f=h.getProgramInfoLog(O).trim();b=h.getShaderInfoLog(m).trim();g=h.getShaderInfoLog(q).trim();w=p=!0;return!1===h.getProgramParameter(O,35714)?p=!1:""!==f||""!==b&&""!==g||(w=!1),w&&(this.diagnostics={runnable:p,material:d,programLog:f,vertexShader:{log:b,
prefix:t},fragmentShader:{log:g,prefix:n}}),h.deleteShader(m),h.deleteShader(q),this.getUniforms=function(){return void 0===N&&(N=new rb(h,O,a)),N},this.getAttributes=function(){if(void 0===v){for(var a={},b=h.getProgramParameter(O,35721),c=0;c<b;c++){var d=h.getActiveAttrib(O,c).name;a[d]=h.getAttribLocation(O,d)}v=a}return v},this.destroy=function(){h.deleteProgram(O);this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return this.getUniforms()}},attributes:{get:function(){return this.getAttributes()}}}),
this.name=e.name,this.id=yk++,this.code=c,this.usedTimes=1,this.program=O,this.vertexShader=m,this.fragmentShader=q,this}function zk(a,b,c){function d(a,b){var c;return a?a.isTexture?c=a.encoding:a.isWebGLRenderTarget&&(c=a.texture.encoding):c=3E3,3E3===c&&b&&(c=3007),c}var e=[],f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",
MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},g="precision supportsVertexTextures map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");
this.getParameters=function(b,e,g,q,p,w,l){var h=f[b.type];if(l.isSkinnedMesh){var k=l.skeleton.bones;if(c.floatVertexTextures)k=1024;else{var m=Math.min(Math.floor((c.maxVertexUniforms-20)/4),k.length);k=m<k.length?0:m}}else k=0;m=c.precision;null!==b.precision&&(m=c.getMaxPrecision(b.precision),b.precision);var T=a.getRenderTarget();return{shaderID:h,precision:m,supportsVertexTextures:c.vertexTextures,outputEncoding:d(T?T.texture:null,a.gammaOutput),map:!!b.map,mapEncoding:d(b.map,a.gammaInput),
matcap:!!b.matcap,matcapEncoding:d(b.matcap,a.gammaInput),envMap:!!b.envMap,envMapMode:b.envMap&&b.envMap.mapping,envMapEncoding:d(b.envMap,a.gammaInput),envMapCubeUV:!!b.envMap&&(306===b.envMap.mapping||307===b.envMap.mapping),lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:d(b.emissiveMap,a.gammaInput),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,objectSpaceNormalMap:1===b.normalMapType,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,
specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,combine:b.combine,vertexColors:b.vertexColors,fog:!!q,useFog:b.fog,fogExp:q&&q.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:c.logarithmicDepthBuffer,skinning:b.skinning&&0<k,maxBones:k,useVertexTexture:c.floatVertexTextures,morphTargets:b.morphTargets,morphNormals:b.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:e.directional.length,
numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numClippingPlanes:p,numClipIntersection:w,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&l.receiveShadow&&0<g.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,alphaTest:b.alphaTest,doubleSided:2===b.side,flipSided:1===b.side,depthPacking:void 0!==b.depthPacking&&
b.depthPacking}};this.getProgramCode=function(b,c){var d=[];if(c.shaderID?d.push(c.shaderID):(d.push(b.fragmentShader),d.push(b.vertexShader)),void 0!==b.defines)for(var e in b.defines)d.push(e),d.push(b.defines[e]);for(e=0;e<g.length;e++)d.push(c[g[e]]);return d.push(b.onBeforeCompile.toString()),d.push(a.gammaOutput),d.push(a.gammaFactor),d.join()};this.acquireProgram=function(d,f,g,q){for(var h,k=0,m=e.length;k<m;k++){var l=e[k];if(l.code===q){++(h=l).usedTimes;break}}return void 0===h&&(h=new xk(a,
b,q,d,f,g,c),e.push(h)),h};this.releaseProgram=function(a){if(0==--a.usedTimes){var b=e.indexOf(a);e[b]=e[e.length-1];e.pop();a.destroy()}};this.programs=e}function Ak(){var a=new WeakMap;return{get:function(b){var c=a.get(b);return void 0===c&&(c={},a.set(b,c)),c},remove:function(b){a.delete(b)},update:function(b,c,d){a.get(b)[c]=d},dispose:function(){a=new WeakMap}}}function Bk(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program&&b.program&&a.program!==b.program?a.program.id-
b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function Ck(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function Uh(){function a(a,d,e,k,m){var f=b[c];return void 0===f?(f={id:a.id,object:a,geometry:d,material:e,program:e.program,renderOrder:a.renderOrder,z:k,group:m},b[c]=f):(f.id=a.id,f.object=a,f.geometry=d,f.material=e,f.program=e.program,f.renderOrder=a.renderOrder,f.z=k,f.group=m),c++,f}
var b=[],c=0,d=[],e=[];return{opaque:d,transparent:e,init:function(){c=0;d.length=0;e.length=0},push:function(b,c,h,k,m){b=a(b,c,h,k,m);(!0===h.transparent?e:d).push(b)},unshift:function(b,c,h,k,m){b=a(b,c,h,k,m);(!0===h.transparent?e:d).unshift(b)},sort:function(){1<d.length&&d.sort(Bk);1<e.length&&e.sort(Ck)}}}function Dk(){var a={};return{get:function(b,c){var d,e=a[b.id];return void 0===e?(d=new Uh,a[b.id]={},a[b.id][c.id]=d):void 0===(d=e[c.id])&&(d=new Uh,e[c.id]=d),d},dispose:function(){a=
{}}}}function Ek(){var a={};return{get:function(b){if(void 0!==a[b.id])return a[b.id];switch(b.type){case "DirectionalLight":var c={direction:new n,color:new L,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new x};break;case "SpotLight":c={position:new n,direction:new n,color:new L,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new x};break;case "PointLight":c={position:new n,color:new L,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,
shadowMapSize:new x,shadowCameraNear:1,shadowCameraFar:1E3};break;case "HemisphereLight":c={direction:new n,skyColor:new L,groundColor:new L};break;case "RectAreaLight":c={color:new L,position:new n,halfWidth:new n,halfHeight:new n}}return a[b.id]=c}}}function Fk(){var a=new Ek,b={id:Gk++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],
spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},c=new n,d=new I,e=new I;return{setup:function(f,g,h){var k=0,m=0,q=0,p=0,w=0,l=0,u=0,t=0;h=h.matrixWorldInverse;for(var n=0,qa=f.length;n<qa;n++){var y=f[n],O=y.color,N=y.intensity,v=y.distance,V=y.shadow&&y.shadow.map?y.shadow.map.texture:null;if(y.isAmbientLight)k+=O.r*N,m+=O.g*N,q+=O.b*N;else if(y.isDirectionalLight){if((M=a.get(y)).color.copy(y.color).multiplyScalar(y.intensity),M.direction.setFromMatrixPosition(y.matrixWorld),
c.setFromMatrixPosition(y.target.matrixWorld),M.direction.sub(c),M.direction.transformDirection(h),M.shadow=y.castShadow,y.castShadow){var R=y.shadow;M.shadowBias=R.bias;M.shadowRadius=R.radius;M.shadowMapSize=R.mapSize}b.directionalShadowMap[p]=V;b.directionalShadowMatrix[p]=y.shadow.matrix;b.directional[p]=M;p++}else if(y.isSpotLight)(M=a.get(y)).position.setFromMatrixPosition(y.matrixWorld),M.position.applyMatrix4(h),M.color.copy(O).multiplyScalar(N),M.distance=v,M.direction.setFromMatrixPosition(y.matrixWorld),
c.setFromMatrixPosition(y.target.matrixWorld),M.direction.sub(c),M.direction.transformDirection(h),M.coneCos=Math.cos(y.angle),M.penumbraCos=Math.cos(y.angle*(1-y.penumbra)),M.decay=y.decay,(M.shadow=y.castShadow)&&(R=y.shadow,M.shadowBias=R.bias,M.shadowRadius=R.radius,M.shadowMapSize=R.mapSize),b.spotShadowMap[l]=V,b.spotShadowMatrix[l]=y.shadow.matrix,b.spot[l]=M,l++;else if(y.isRectAreaLight)(M=a.get(y)).color.copy(O).multiplyScalar(N),M.position.setFromMatrixPosition(y.matrixWorld),M.position.applyMatrix4(h),
e.identity(),d.copy(y.matrixWorld),d.premultiply(h),e.extractRotation(d),M.halfWidth.set(.5*y.width,0,0),M.halfHeight.set(0,.5*y.height,0),M.halfWidth.applyMatrix4(e),M.halfHeight.applyMatrix4(e),b.rectArea[u]=M,u++;else if(y.isPointLight)(M=a.get(y)).position.setFromMatrixPosition(y.matrixWorld),M.position.applyMatrix4(h),M.color.copy(y.color).multiplyScalar(y.intensity),M.distance=y.distance,M.decay=y.decay,(M.shadow=y.castShadow)&&(R=y.shadow,M.shadowBias=R.bias,M.shadowRadius=R.radius,M.shadowMapSize=
R.mapSize,M.shadowCameraNear=R.camera.near,M.shadowCameraFar=R.camera.far),b.pointShadowMap[w]=V,b.pointShadowMatrix[w]=y.shadow.matrix,b.point[w]=M,w++;else if(y.isHemisphereLight){var M;(M=a.get(y)).direction.setFromMatrixPosition(y.matrixWorld);M.direction.transformDirection(h);M.direction.normalize();M.skyColor.copy(y.color).multiplyScalar(N);M.groundColor.copy(y.groundColor).multiplyScalar(N);b.hemi[t]=M;t++}}b.ambient[0]=k;b.ambient[1]=m;b.ambient[2]=q;b.directional.length=p;b.spot.length=l;
b.rectArea.length=u;b.point.length=w;b.hemi.length=t;b.hash.stateID=b.id;b.hash.directionalLength=p;b.hash.pointLength=w;b.hash.spotLength=l;b.hash.rectAreaLength=u;b.hash.hemiLength=t;b.hash.shadowsLength=g.length},state:b}}function Vh(){var a=new Fk,b=[],c=[];return{init:function(){b.length=0;c.length=0},state:{lightsArray:b,shadowsArray:c,lights:a},setupLights:function(d){a.setup(b,c,d)},pushLight:function(a){b.push(a)},pushShadow:function(a){c.push(a)}}}function Hk(){var a={};return{get:function(b,
c){var d;return void 0===a[b.id]?(d=new Vh,a[b.id]={},a[b.id][c.id]=d):void 0===a[b.id][c.id]?(d=new Vh,a[b.id][c.id]=d):d=a[b.id][c.id],d},dispose:function(){a={}}}}function sb(a){U.call(this);this.type="MeshDepthMaterial";this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(a)}function tb(a){U.call(this);this.type=
"MeshDistanceMaterial";this.referencePosition=new n;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(a)}function Wh(a,b,c){function d(b,c,d,e,f,g){var h=b.geometry;var k=l;var m=b.customDepthMaterial;(d&&(k=u,m=b.customDistanceMaterial),m)?k=m:(m=!1,c.morphTargets&&(h&&h.isBufferGeometry?m=h.morphAttributes&&h.morphAttributes.position&&
0<h.morphAttributes.position.length:h&&h.isGeometry&&(m=h.morphTargets&&0<h.morphTargets.length)),b.isSkinnedMesh&&c.skinning,b=b.isSkinnedMesh&&c.skinning,h=0,m&&(h|=p),b&&(h|=w),k=k[h]);a.localClippingEnabled&&!0===c.clipShadows&&0!==c.clippingPlanes.length&&(h=k.uuid,m=c.uuid,b=t[h],void 0===b&&(b={},t[h]=b),h=b[m],void 0===h&&(h=k.clone(),b[m]=h),k=h);return k.visible=c.visible,k.wireframe=c.wireframe,k.side=null!=c.shadowSide?c.shadowSide:D[c.side],k.clipShadows=c.clipShadows,k.clippingPlanes=
c.clippingPlanes,k.clipIntersection=c.clipIntersection,k.wireframeLinewidth=c.wireframeLinewidth,k.linewidth=c.linewidth,d&&k.isMeshDistanceMaterial&&(k.referencePosition.copy(e),k.nearDistance=f,k.farDistance=g),k}function e(c,g,h,k){if(!1!==c.visible){if(c.layers.test(g.layers)&&(c.isMesh||c.isLine||c.isPoints)&&c.castShadow&&(!c.frustumCulled||f.intersectsObject(c))){c.modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,c.matrixWorld);var m=b.update(c),p=c.material;if(Array.isArray(p))for(var w=
m.groups,l=0,u=w.length;l<u;l++){var t=w[l],V=p[t.materialIndex];V&&V.visible&&(V=d(c,V,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,V,c,t))}else p.visible&&(V=d(c,p,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,V,c,null))}c=c.children;m=0;for(p=c.length;m<p;m++)e(c[m],g,h,k)}}var f=new Ae,g=new I,h=new x,k=new x(c,c),m=new n,q=new n,p=1,w=2;c=1+(p|w);for(var l=Array(c),u=Array(c),t={},D={0:1,1:0,2:2},v=[new n(1,0,0),new n(-1,0,0),new n(0,0,1),new n(0,0,-1),new n(0,1,0),new n(0,-1,0)],y=[new n(0,
1,0),new n(0,1,0),new n(0,1,0),new n(0,1,0),new n(0,0,1),new n(0,0,-1)],O=[new da,new da,new da,new da,new da,new da],N=0;N!==c;++N){var r=0!=(N&p),V=0!=(N&w),R=new sb({depthPacking:3201,morphTargets:r,skinning:V});l[N]=R;r=new tb({morphTargets:r,skinning:V});u[N]=r}var M=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(b,c,d){if(!1!==M.enabled&&(!1!==M.autoUpdate||!1!==M.needsUpdate)&&0!==b.length){a.context;var p,w=a.state;w.disable(3042);w.buffers.color.setClear(1,
1,1,1);w.buffers.depth.setTest(!0);w.setScissorTest(!1);for(var l=0,u=b.length;l<u;l++){var V=b[l],t=V.shadow,T=V&&V.isPointLight;if(void 0!==t){var n=t.camera;if(h.copy(t.mapSize),h.min(k),T){var R=h.x,D=h.y;O[0].set(2*R,D,R,D);O[1].set(0,D,R,D);O[2].set(3*R,D,R,D);O[3].set(R,D,R,D);O[4].set(3*R,0,R,D);O[5].set(R,0,R,D);h.x*=4;h.y*=2}null===t.map&&(t.map=new Gb(h.x,h.y,{minFilter:1003,magFilter:1003,format:1023}),t.map.texture.name=V.name+".shadowMap",n.updateProjectionMatrix());t.isSpotLightShadow&&
t.update(V);R=t.map;t=t.matrix;q.setFromMatrixPosition(V.matrixWorld);n.position.copy(q);T?(p=6,t.makeTranslation(-q.x,-q.y,-q.z)):(p=1,m.setFromMatrixPosition(V.target.matrixWorld),n.lookAt(m),n.updateMatrixWorld(),t.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),t.multiply(n.projectionMatrix),t.multiply(n.matrixWorldInverse));a.setRenderTarget(R);a.clear();for(V=0;V<p;V++)T&&(m.copy(n.position),m.add(v[V]),n.up.copy(y[V]),n.lookAt(m),n.updateMatrixWorld(),w.viewport(O[V])),g.multiplyMatrices(n.projectionMatrix,
n.matrixWorldInverse),f.setFromMatrix(g),e(c,d,n,T)}}M.needsUpdate=!1}}}function Ik(a,b,c,d){function e(b,c,d){var e=new Uint8Array(4),f=a.createTexture();a.bindTexture(b,f);a.texParameteri(b,10241,9728);a.texParameteri(b,10240,9728);for(b=0;b<d;b++)a.texImage2D(c+b,0,6408,1,1,0,6408,5121,e);return f}function f(c,e){(v[c]=1,0===y[c]&&(a.enableVertexAttribArray(c),y[c]=1),O[c]!==e)&&((d.isWebGL2?a:b.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](c,e),O[c]=
e)}function g(b){!0!==N[b]&&(a.enable(b),N[b]=!0)}function h(b){!1!==N[b]&&(a.disable(b),N[b]=!1)}function k(b,d,e,f,k,m,q,p){if(0!==b)if(R||(g(3042),R=!0),5===b)k=k||d,m=m||e,q=q||f,d===Be&&k===Ce||(a.blendEquationSeparate(c.convert(d),c.convert(k)),Be=d,Ce=k),e===x&&f===Ef&&m===z&&q===A||(a.blendFuncSeparate(c.convert(e),c.convert(f),c.convert(m),c.convert(q)),x=e,Ef=f,z=m,A=q),M=b,B=null;else{if(b!==M||p!==B){if(100===Be&&100===Ce||(a.blendEquation(32774),Ce=Be=100),p)switch(b){case 1:a.blendFuncSeparate(1,
771,1,771);break;case 2:a.blendFunc(1,1);break;case 3:a.blendFuncSeparate(0,0,769,771);break;case 4:a.blendFuncSeparate(0,768,0,770)}else switch(b){case 1:a.blendFuncSeparate(770,771,1,771);break;case 2:a.blendFunc(770,1);break;case 3:a.blendFunc(0,769);break;case 4:a.blendFunc(0,768)}A=z=Ef=x=null;M=b;B=p}}else R&&(h(3042),R=!1)}function m(b){E!==b&&(b?a.frontFace(2304):a.frontFace(2305),E=b)}function q(b){0!==b?(g(2884),b!==C&&(1===b?a.cullFace(1029):2===b?a.cullFace(1028):a.cullFace(1032))):h(2884);
C=b}function p(b,c,d){b?(g(32823),H===c&&G===d||(a.polygonOffset(c,d),H=c,G=d)):h(32823)}function w(b){void 0===b&&(b=33984+L-1);J!==b&&(a.activeTexture(b),J=b)}var l=new function(){var b=!1,c=new da,d=null,e=new da(0,0,0,0);return{setMask:function(c){d===c||b||(a.colorMask(c,c,c,c),d=c)},setLocked:function(a){b=a},setClear:function(b,d,f,g,h){!0===h&&(b*=g,d*=g,f*=g);c.set(b,d,f,g);!1===e.equals(c)&&(a.clearColor(b,d,f,g),e.copy(c))},reset:function(){b=!1;d=null;e.set(-1,0,0,0)}}},u=new function(){var b=
!1,c=null,d=null,e=null;return{setTest:function(a){a?g(2929):h(2929)},setMask:function(d){c===d||b||(a.depthMask(d),c=d)},setFunc:function(b){if(d!==b){if(b)switch(b){case 0:a.depthFunc(512);break;case 1:a.depthFunc(519);break;case 2:a.depthFunc(513);break;case 3:a.depthFunc(515);break;case 4:a.depthFunc(514);break;case 5:a.depthFunc(518);break;case 6:a.depthFunc(516);break;case 7:a.depthFunc(517);break;default:a.depthFunc(515)}else a.depthFunc(515);d=b}},setLocked:function(a){b=a},setClear:function(b){e!==
b&&(a.clearDepth(b),e=b)},reset:function(){b=!1;e=d=c=null}}},t=new function(){var b=!1,c=null,d=null,e=null,f=null,k=null,m=null,q=null,p=null;return{setTest:function(a){a?g(2960):h(2960)},setMask:function(d){c===d||b||(a.stencilMask(d),c=d)},setFunc:function(b,c,g){d===b&&e===c&&f===g||(a.stencilFunc(b,c,g),d=b,e=c,f=g)},setOp:function(b,c,d){k===b&&m===c&&q===d||(a.stencilOp(b,c,d),k=b,m=c,q=d)},setLocked:function(a){b=a},setClear:function(b){p!==b&&(a.clearStencil(b),p=b)},reset:function(){b=
!1;p=q=m=k=f=e=d=c=null}}},n=a.getParameter(34921),v=new Uint8Array(n),y=new Uint8Array(n),O=new Uint8Array(n),N={},r=null,V=null,R=null,M=null,Be=null,x=null,Ef=null,Ce=null,z=null,A=null,B=!1,E=null,C=null,F=null,H=null,G=null,L=a.getParameter(35661),I=!1;n=0;var S=a.getParameter(7938);-1!==S.indexOf("WebGL")?(n=parseFloat(/^WebGL ([0-9])/.exec(S)[1]),I=1<=n):-1!==S.indexOf("OpenGL ES")&&(n=parseFloat(/^OpenGL ES ([0-9])/.exec(S)[1]),I=2<=n);var J=null,U={},Q=new da,K=new da,W={};return W[3553]=
e(3553,3553,1),W[34067]=e(34067,34069,6),l.setClear(0,0,0,1),u.setClear(1),t.setClear(0),g(2929),u.setFunc(3),m(!1),q(1),g(2884),k(0),{buffers:{color:l,depth:u,stencil:t},initAttributes:function(){for(var a=0,b=v.length;a<b;a++)v[a]=0},enableAttribute:function(a){f(a,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var b=0,c=y.length;b!==c;++b)y[b]!==v[b]&&(a.disableVertexAttribArray(b),y[b]=0)},enable:g,disable:h,getCompressedTextureFormats:function(){if(null===r&&(r=[],b.get("WEBGL_compressed_texture_pvrtc")||
b.get("WEBGL_compressed_texture_s3tc")||b.get("WEBGL_compressed_texture_etc1")||b.get("WEBGL_compressed_texture_astc")))for(var c=a.getParameter(34467),d=0;d<c.length;d++)r.push(c[d]);return r},useProgram:function(b){return V!==b&&(a.useProgram(b),V=b,!0)},setBlending:k,setMaterial:function(a,b){2===a.side?h(2884):g(2884);var c=1===a.side;b&&(c=!c);m(c);1===a.blending&&!1===a.transparent?k(0):k(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha,a.premultipliedAlpha);
u.setFunc(a.depthFunc);u.setTest(a.depthTest);u.setMask(a.depthWrite);l.setMask(a.colorWrite);p(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)},setFlipSided:m,setCullFace:q,setLineWidth:function(b){b!==F&&(I&&a.lineWidth(b),F=b)},setPolygonOffset:p,setScissorTest:function(a){a?g(3089):h(3089)},activeTexture:w,bindTexture:function(b,c){null===J&&w();var d=U[J];void 0===d&&(d={type:void 0,texture:void 0},U[J]=d);d.type===b&&d.texture===c||(a.bindTexture(b,c||W[b]),d.type=b,d.texture=c)},
compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Xh){}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(Xh){}},texImage3D:function(){try{a.texImage3D.apply(a,arguments)}catch(Xh){}},scissor:function(b){!1===Q.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),Q.copy(b))},viewport:function(b){!1===K.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),K.copy(b))},reset:function(){for(var b=0;b<y.length;b++)1===y[b]&&(a.disableVertexAttribArray(b),y[b]=0);N={};U={};C=E=M=V=
J=r=null;l.reset();u.reset();t.reset()}}}function Jk(a,b,c,d,e,f,g){function h(a,b){if(a.width>b||a.height>b){if("data"in a)return;b/=Math.max(a.width,a.height);var c=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return c.width=Math.floor(a.width*b),c.height=Math.floor(a.height*b),c.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,c.width,c.height),c}return a}function k(a){return Q.isPowerOfTwo(a.width)&&Q.isPowerOfTwo(a.height)}function m(a,b){return a.generateMipmaps&&b&&
1003!==a.minFilter&&1006!==a.minFilter}function q(b,c,e,f){a.generateMipmap(b);d.get(c).__maxMipLevel=Math.log(Math.max(e,f))*Math.LOG2E}function p(a,b){if(!e.isWebGL2)return a;if(6403===a){if(5126===b)return 33326;if(5131===b)return 33325;if(5121===b)return 33321}if(6407===a){if(5126===b)return 34837;if(5131===b)return 34843;if(5121===b)return 32849}if(6408===a){if(5126===b)return 34836;if(5131===b)return 34842;if(5121===b)return 32856}return a}function w(a){return 1003===a||1004===a||1005===a?9728:
9729}function l(b){b=b.target;b.removeEventListener("dispose",l);a:{var c=d.get(b);if(b.image&&c.__image__webglTextureCube)a.deleteTexture(c.__image__webglTextureCube);else{if(void 0===c.__webglInit)break a;a.deleteTexture(c.__webglTexture)}d.remove(b)}b.isVideoTexture&&delete r[b.id];g.memory.textures--}function u(b){b=b.target;b.removeEventListener("dispose",u);var c=d.get(b),e=d.get(b.texture);if(b){void 0!==e.__webglTexture&&a.deleteTexture(e.__webglTexture);b.depthTexture&&b.depthTexture.dispose();
if(b.isWebGLRenderTargetCube)for(e=0;6>e;e++)a.deleteFramebuffer(c.__webglFramebuffer[e]),c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer[e]);else a.deleteFramebuffer(c.__webglFramebuffer),c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer);d.remove(b.texture);d.remove(b)}g.memory.textures--}function t(a,b){var e,f,h=d.get(a);if(a.isVideoTexture&&(e=a.id,f=g.render.frame,r[e]!==f&&(r[e]=f,a.update())),0<a.version&&h.__version!==a.version)if(e=a.image,void 0!==e&&!1!==
e.complete)return void v(h,a,b);c.activeTexture(33984+b);c.bindTexture(3553,h.__webglTexture)}function n(c,g,h){(h?(a.texParameteri(c,10242,f.convert(g.wrapS)),a.texParameteri(c,10243,f.convert(g.wrapT)),a.texParameteri(c,10240,f.convert(g.magFilter)),a.texParameteri(c,10241,f.convert(g.minFilter))):(a.texParameteri(c,10242,33071),a.texParameteri(c,10243,33071),1001!==g.wrapS||g.wrapT,a.texParameteri(c,10240,w(g.magFilter)),a.texParameteri(c,10241,w(g.minFilter)),1003!==g.minFilter&&g.minFilter),
h=b.get("EXT_texture_filter_anisotropic"))&&!(1015===g.type&&null===b.get("OES_texture_float_linear")||1016===g.type&&null===(e.isWebGL2||b.get("OES_texture_half_float_linear")))&&(1<g.anisotropy||d.get(g).__currentAnisotropy)&&(a.texParameterf(c,h.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(g.anisotropy,e.getMaxAnisotropy())),d.get(g).__currentAnisotropy=g.anisotropy)}function v(b,d,w){var t=d.isDataTexture3D?32879:3553;void 0===b.__webglInit&&(b.__webglInit=!0,d.addEventListener("dispose",l),b.__webglTexture=
a.createTexture(),g.memory.textures++);c.activeTexture(33984+w);c.bindTexture(t,b.__webglTexture);a.pixelStorei(37440,d.flipY);a.pixelStorei(37441,d.premultiplyAlpha);a.pixelStorei(3317,d.unpackAlignment);var u;w=h(d.image,e.maxTextureSize);e.isWebGL2||1001===d.wrapS&&1001===d.wrapT&&(1003===d.minFilter||1006===d.minFilter)||!1!==k(w)||(w=(u=w)instanceof HTMLImageElement||u instanceof HTMLCanvasElement||u instanceof ImageBitmap?(void 0===N&&(N=document.createElementNS("http://www.w3.org/1999/xhtml",
"canvas")),N.width=Q.floorPowerOfTwo(u.width),N.height=Q.floorPowerOfTwo(u.height),N.getContext("2d").drawImage(u,0,0,N.width,N.height),N):u);u=k(w);var T=f.convert(d.format),V=f.convert(d.type),D=p(T,V);n(t,d,u);var O=d.mipmaps;if(d.isDepthTexture){if(D=6402,1015===d.type){if(!e.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");D=36012}else e.isWebGL2&&(D=33189);1026===d.format&&6402===D&&1012!==d.type&&1014!==d.type&&(d.type=1012,V=f.convert(d.type));1027===d.format&&(D=34041,
1020!==d.type&&(d.type=1020,V=f.convert(d.type)));c.texImage2D(3553,0,D,w.width,w.height,0,T,V,null)}else if(d.isDataTexture)if(0<O.length&&u){for(var y=0,R=O.length;y<R;y++)t=O[y],c.texImage2D(3553,y,D,t.width,t.height,0,T,V,t.data);d.generateMipmaps=!1;b.__maxMipLevel=O.length-1}else c.texImage2D(3553,0,D,w.width,w.height,0,T,V,w.data),b.__maxMipLevel=0;else if(d.isCompressedTexture){y=0;for(R=O.length;y<R;y++)t=O[y],1023!==d.format&&1022!==d.format?-1<c.getCompressedTextureFormats().indexOf(T)&&
c.compressedTexImage2D(3553,y,D,t.width,t.height,0,t.data):c.texImage2D(3553,y,D,t.width,t.height,0,T,V,t.data);b.__maxMipLevel=O.length-1}else if(d.isDataTexture3D)c.texImage3D(32879,0,D,w.width,w.height,w.depth,0,T,V,w.data),b.__maxMipLevel=0;else if(0<O.length&&u){y=0;for(R=O.length;y<R;y++)t=O[y],c.texImage2D(3553,y,D,T,V,t);d.generateMipmaps=!1;b.__maxMipLevel=O.length-1}else c.texImage2D(3553,0,D,T,V,w),b.__maxMipLevel=0;m(d,u)&&q(3553,d,w.width,w.height);b.__version=d.version;d.onUpdate&&d.onUpdate(d)}
function y(b,e,g,h){var k=f.convert(e.texture.format),m=f.convert(e.texture.type),q=p(k,m);c.texImage2D(h,0,q,e.width,e.height,0,k,m,null);a.bindFramebuffer(36160,b);a.framebufferTexture2D(36160,g,h,d.get(e.texture).__webglTexture,0);a.bindFramebuffer(36160,null)}function O(b,c){a.bindRenderbuffer(36161,b);c.depthBuffer&&!c.stencilBuffer?(a.renderbufferStorage(36161,33189,c.width,c.height),a.framebufferRenderbuffer(36160,36096,36161,b)):c.depthBuffer&&c.stencilBuffer?(a.renderbufferStorage(36161,
34041,c.width,c.height),a.framebufferRenderbuffer(36160,33306,36161,b)):a.renderbufferStorage(36161,32854,c.width,c.height);a.bindRenderbuffer(36161,null)}var N,r={};this.setTexture2D=t;this.setTexture3D=function(a,b){var e=d.get(a);0<a.version&&e.__version!==a.version?v(e,a,b):(c.activeTexture(33984+b),c.bindTexture(32879,e.__webglTexture))};this.setTextureCube=function(b,w){var t=d.get(b);if(6===b.image.length)if(0<b.version&&t.__version!==b.version){t.__image__webglTextureCube||(b.addEventListener("dispose",
l),t.__image__webglTextureCube=a.createTexture(),g.memory.textures++);c.activeTexture(33984+w);c.bindTexture(34067,t.__image__webglTextureCube);a.pixelStorei(37440,b.flipY);w=b&&b.isCompressedTexture;for(var u=b.image[0]&&b.image[0].isDataTexture,T=[],D=0;6>D;D++)T[D]=w||u?u?b.image[D].image:b.image[D]:h(b.image[D],e.maxCubemapSize);var V=T[0],y=k(V),O=f.convert(b.format),N=f.convert(b.type),R=p(O,N);n(34067,b,y);for(D=0;6>D;D++)if(w)for(var v,r=T[D].mipmaps,qa=0,Ca=r.length;qa<Ca;qa++)v=r[qa],1023!==
b.format&&1022!==b.format?-1<c.getCompressedTextureFormats().indexOf(O)&&c.compressedTexImage2D(34069+D,qa,R,v.width,v.height,0,v.data):c.texImage2D(34069+D,qa,R,v.width,v.height,0,O,N,v.data);else u?c.texImage2D(34069+D,0,R,T[D].width,T[D].height,0,O,N,T[D].data):c.texImage2D(34069+D,0,R,O,N,T[D]);t.__maxMipLevel=w?r.length-1:0;m(b,y)&&q(34067,b,V.width,V.height);t.__version=b.version;b.onUpdate&&b.onUpdate(b)}else c.activeTexture(33984+w),c.bindTexture(34067,t.__image__webglTextureCube)};this.setTextureCubeDynamic=
function(a,b){c.activeTexture(33984+b);c.bindTexture(34067,d.get(a).__webglTexture)};this.setupRenderTarget=function(b){var e=d.get(b),f=d.get(b.texture);b.addEventListener("dispose",u);f.__webglTexture=a.createTexture();g.memory.textures++;var h=!0===b.isWebGLRenderTargetCube,p=k(b);if(h){e.__webglFramebuffer=[];for(var w=0;6>w;w++)e.__webglFramebuffer[w]=a.createFramebuffer()}else e.__webglFramebuffer=a.createFramebuffer();if(h){c.bindTexture(34067,f.__webglTexture);n(34067,b.texture,p);for(w=0;6>
w;w++)y(e.__webglFramebuffer[w],b,36064,34069+w);m(b.texture,p)&&q(34067,b.texture,b.width,b.height);c.bindTexture(34067,null)}else c.bindTexture(3553,f.__webglTexture),n(3553,b.texture,p),y(e.__webglFramebuffer,b,36064,3553),m(b.texture,p)&&q(3553,b.texture,b.width,b.height),c.bindTexture(3553,null);if(b.depthBuffer){e=d.get(b);f=!0===b.isWebGLRenderTargetCube;if(b.depthTexture){if(f)throw Error("target.depthTexture not supported in Cube render targets");if(b&&b.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");
if(a.bindFramebuffer(36160,e.__webglFramebuffer),!b.depthTexture||!b.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");d.get(b.depthTexture).__webglTexture&&b.depthTexture.image.width===b.width&&b.depthTexture.image.height===b.height||(b.depthTexture.image.width=b.width,b.depthTexture.image.height=b.height,b.depthTexture.needsUpdate=!0);t(b.depthTexture,0);e=d.get(b.depthTexture).__webglTexture;if(1026===b.depthTexture.format)a.framebufferTexture2D(36160,
36096,3553,e,0);else{if(1027!==b.depthTexture.format)throw Error("Unknown depthTexture format");a.framebufferTexture2D(36160,33306,3553,e,0)}!0}else if(f)for(e.__webglDepthbuffer=[],f=0;6>f;f++)a.bindFramebuffer(36160,e.__webglFramebuffer[f]),e.__webglDepthbuffer[f]=a.createRenderbuffer(),O(e.__webglDepthbuffer[f],b);else a.bindFramebuffer(36160,e.__webglFramebuffer),e.__webglDepthbuffer=a.createRenderbuffer(),O(e.__webglDepthbuffer,b);a.bindFramebuffer(36160,null)}};this.updateRenderTargetMipmap=
function(a){var b=a.texture;if(m(b,k(a))){var e=a.isWebGLRenderTargetCube?34067:3553,f=d.get(b).__webglTexture;c.bindTexture(e,f);q(e,b,a.width,a.height);c.bindTexture(e,null)}}}function Yh(a,b,c){return{convert:function(a){var d;if(1E3===a)return 10497;if(1001===a)return 33071;if(1002===a)return 33648;if(1003===a)return 9728;if(1004===a)return 9984;if(1005===a)return 9986;if(1006===a)return 9729;if(1007===a)return 9985;if(1008===a)return 9987;if(1009===a)return 5121;if(1017===a)return 32819;if(1018===
a)return 32820;if(1019===a)return 33635;if(1010===a)return 5120;if(1011===a)return 5122;if(1012===a)return 5123;if(1013===a)return 5124;if(1014===a)return 5125;if(1015===a)return 5126;if(1016===a){if(c.isWebGL2)return 5131;if(null!==(d=b.get("OES_texture_half_float")))return d.HALF_FLOAT_OES}if(1021===a)return 6406;if(1022===a)return 6407;if(1023===a)return 6408;if(1024===a)return 6409;if(1025===a)return 6410;if(1026===a)return 6402;if(1027===a)return 34041;if(1028===a)return 6403;if(100===a)return 32774;
if(101===a)return 32778;if(102===a)return 32779;if(200===a)return 0;if(201===a)return 1;if(202===a)return 768;if(203===a)return 769;if(204===a)return 770;if(205===a)return 771;if(206===a)return 772;if(207===a)return 773;if(208===a)return 774;if(209===a)return 775;if(210===a)return 776;if((33776===a||33777===a||33778===a||33779===a)&&null!==(d=b.get("WEBGL_compressed_texture_s3tc"))){if(33776===a)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===a)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===a)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;
if(33779===a)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((35840===a||35841===a||35842===a||35843===a)&&null!==(d=b.get("WEBGL_compressed_texture_pvrtc"))){if(35840===a)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===a)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===a)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===a)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===a&&null!==(d=b.get("WEBGL_compressed_texture_etc1")))return d.COMPRESSED_RGB_ETC1_WEBGL;if((37808===a||37809===a||37810===
a||37811===a||37812===a||37813===a||37814===a||37815===a||37816===a||37817===a||37818===a||37819===a||37820===a||37821===a)&&null!==b.get("WEBGL_compressed_texture_astc"))return a;if(103===a||104===a){if(c.isWebGL2){if(103===a)return 32775;if(104===a)return 32776}if(null!==(d=b.get("EXT_blend_minmax"))){if(103===a)return d.MIN_EXT;if(104===a)return d.MAX_EXT}}if(1020===a){if(c.isWebGL2)return 34042;if(null!==(d=b.get("WEBGL_depth_texture")))return d.UNSIGNED_INT_24_8_WEBGL}return 0}}}function pc(){E.call(this);
this.type="Group"}function Za(){E.call(this);this.type="Camera";this.matrixWorldInverse=new I;this.projectionMatrix=new I;this.projectionMatrixInverse=new I}function ja(a,b,c,d){Za.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:50;this.zoom=1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.focus=10;this.aspect=void 0!==b?b:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}function nd(a){ja.call(this);this.cameras=a||[]}function Zh(a,b,c){$h.setFromMatrixPosition(b.matrixWorld);
ai.setFromMatrixPosition(c.matrixWorld);var d=$h.distanceTo(ai),e=b.projectionMatrix.elements,f=c.projectionMatrix.elements,g=e[14]/(e[10]-1);c=e[14]/(e[10]+1);var h=(e[9]+1)/e[5],k=(e[9]-1)/e[5],m=(e[8]-1)/e[0],q=(f[8]+1)/f[0];e=g*m;f=g*q;q=d/(-m+q);m=q*-m;b.matrixWorld.decompose(a.position,a.quaternion,a.scale);a.translateX(m);a.translateZ(q);a.matrixWorld.compose(a.position,a.quaternion,a.scale);a.matrixWorldInverse.getInverse(a.matrixWorld);b=g+q;g=c+q;a.projectionMatrix.makePerspective(e-m,f+
(d-m),h*c/g*b,k*c/g*b,b,g)}function bi(a){function b(){return null!==e&&!0===e.isPresenting}function c(){if(b()){var c=e.getEyeParameters("left"),f=c.renderWidth*q;c=c.renderHeight*q;y=a.getPixelRatio();v=a.getSize();a.setDrawingBufferSize(2*f,c,1);r.start()}else d.enabled&&a.setDrawingBufferSize(v.width,v.height,y),r.stop()}var d=this,e=null,f=null,g=null,h=[],k=new I,m=new I,q=1,p="stage";"undefined"!=typeof window&&"VRFrameData"in window&&(f=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",
c,!1));var w=new I,l=new la,u=new n,t=new ja;t.bounds=new da(0,0,.5,1);t.layers.enable(1);var D=new ja;D.bounds=new da(.5,0,.5,1);D.layers.enable(2);var v,y,O=new nd([t,D]);O.layers.enable(1);O.layers.enable(2);var N=[];this.enabled=!1;this.getController=function(a){var b=h[a];return void 0===b&&((b=new pc).matrixAutoUpdate=!1,b.visible=!1,h[a]=b),b};this.getDevice=function(){return e};this.setDevice=function(a){void 0!==a&&(e=a);r.setContext(a)};this.setFramebufferScaleFactor=function(a){q=a};this.setFrameOfReferenceType=
function(a){p=a};this.setPoseTarget=function(a){void 0!==a&&(g=a)};this.getCamera=function(a){var b="stage"===p?1.6:0;if(null===e)return a.position.set(0,b,0),a;if(e.depthNear=a.near,e.depthFar=a.far,e.getFrameData(f),"stage"===p){var c=e.stageParameters;c?k.fromArray(c.sittingToStandingTransform):k.makeTranslation(0,b,0)}b=f.pose;c=null!==g?g:a;if(c.matrix.copy(k),c.matrix.decompose(c.position,c.quaternion,c.scale),null!==b.orientation&&(l.fromArray(b.orientation),c.quaternion.multiply(l)),null!==
b.position&&(l.setFromRotationMatrix(k),u.fromArray(b.position),u.applyQuaternion(l),c.position.add(u)),c.updateMatrixWorld(),!1===e.isPresenting)return a;t.near=a.near;D.near=a.near;t.far=a.far;D.far=a.far;t.matrixWorldInverse.fromArray(f.leftViewMatrix);D.matrixWorldInverse.fromArray(f.rightViewMatrix);m.getInverse(k);"stage"===p&&(t.matrixWorldInverse.multiply(m),D.matrixWorldInverse.multiply(m));a=c.parent;null!==a&&(w.getInverse(a.matrixWorld),t.matrixWorldInverse.multiply(w),D.matrixWorldInverse.multiply(w));
t.matrixWorld.getInverse(t.matrixWorldInverse);D.matrixWorld.getInverse(D.matrixWorldInverse);t.projectionMatrix.fromArray(f.leftProjectionMatrix);D.projectionMatrix.fromArray(f.rightProjectionMatrix);Zh(O,t,D);a=e.getLayers();a.length&&(a=a[0],null!==a.leftBounds&&4===a.leftBounds.length&&t.bounds.fromArray(a.leftBounds),null!==a.rightBounds&&4===a.rightBounds.length&&D.bounds.fromArray(a.rightBounds));a:for(a=0;a<h.length;a++){b=h[a];b:{c=a;for(var d=navigator.getGamepads&&navigator.getGamepads(),
q=0,T=0,n=d.length;q<n;q++){var y=d[q];if(y&&("Daydream Controller"===y.id||"Gear VR Controller"===y.id||"Oculus Go Controller"===y.id||"OpenVR Gamepad"===y.id||y.id.startsWith("Oculus Touch")||y.id.startsWith("Spatial Controller"))){if(T===c){c=y;break b}T++}}c=void 0}if(void 0!==c&&void 0!==c.pose){if(null===c.pose)break a;d=c.pose;!1===d.hasPosition&&b.position.set(.2,-.6,-.05);null!==d.position&&b.position.fromArray(d.position);null!==d.orientation&&b.quaternion.fromArray(d.orientation);b.matrix.compose(b.position,
b.quaternion,b.scale);b.matrix.premultiply(k);b.matrix.decompose(b.position,b.quaternion,b.scale);b.matrixWorldNeedsUpdate=!0;b.visible=!0;d="Daydream Controller"===c.id?0:1;N[a]!==c.buttons[d].pressed&&(N[a]=c.buttons[d].pressed,!0===N[a]?b.dispatchEvent({type:"selectstart"}):(b.dispatchEvent({type:"selectend"}),b.dispatchEvent({type:"select"})))}else b.visible=!1}return O};this.getStandingMatrix=function(){return k};this.isPresenting=b;var r=new Cf;this.setAnimationLoop=function(a){r.setAnimationLoop(a)};
this.submitFrame=function(){b()&&e.submitFrame()};this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",c)}}function Kk(a){function b(){return null!==h&&null!==m}function c(a){var b=w[l.indexOf(a.inputSource)];b&&b.dispatchEvent({type:a.type})}function d(){a.setFramebuffer(null);y.stop()}function e(a,b){null===b?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(b.matrixWorld,a.matrix);a.matrixWorldInverse.getInverse(a.matrixWorld)}var f=
a.context,g=null,h=null,k=1,m=null,q="stage",p=null,w=[],l=[],u=new ja;u.layers.enable(1);u.viewport=new da;var t=new ja;t.layers.enable(2);t.viewport=new da;var n=new nd([u,t]);n.layers.enable(1);n.layers.enable(2);this.enabled=!1;this.getController=function(a){var b=w[a];return void 0===b&&((b=new pc).matrixAutoUpdate=!1,b.visible=!1,w[a]=b),b};this.getDevice=function(){return g};this.setDevice=function(a){void 0!==a&&(g=a);a instanceof XRDevice&&f.setCompatibleXRDevice(a)};this.setFramebufferScaleFactor=
function(a){k=a};this.setFrameOfReferenceType=function(a){q=a};this.setSession=function(b){null!==(h=b)&&(h.addEventListener("select",c),h.addEventListener("selectstart",c),h.addEventListener("selectend",c),h.addEventListener("end",d),h.baseLayer=new XRWebGLLayer(h,f,{framebufferScaleFactor:k}),h.requestFrameOfReference(q).then(function(b){m=b;a.setFramebuffer(h.baseLayer.framebuffer);y.setContext(h);y.start()}),l=h.getInputSources(),h.addEventListener("inputsourceschange",function(){l=h.getInputSources();
for(var a=0;a<w.length;a++)w[a].userData.inputSource=l[a]}))};this.getCamera=function(a){if(b()){var c=a.parent,d=n.cameras;e(n,c);for(var f=0;f<d.length;f++)e(d[f],c);a.matrixWorld.copy(n.matrixWorld);a=a.children;for(c=(f=0,a.length);f<c;f++)a[f].updateMatrixWorld(!0);return Zh(n,u,t),n}return a};this.isPresenting=b;var v=null,y=new Cf;y.setAnimationLoop(function(a,b){if(null!==(p=b.getDevicePose(m)))for(var c=h.baseLayer,d=b.views,e=0;e<d.length;e++){var f=d[e],g=c.getViewport(f),k=p.getViewMatrix(f),
q=n.cameras[e];q.matrix.fromArray(k).getInverse(q.matrix);q.projectionMatrix.fromArray(f.projectionMatrix);q.viewport.set(g.x,g.y,g.width,g.height);0===e&&n.matrix.copy(q.matrix)}for(e=0;e<w.length;e++){c=w[e];if(d=l[e])if(d=b.getInputPose(d,m),null!==d){"targetRay"in d?c.matrix.elements=d.targetRay.transformMatrix:"pointerMatrix"in d&&(c.matrix.elements=d.pointerMatrix);c.matrix.decompose(c.position,c.rotation,c.scale);c.visible=!0;continue}c.visible=!1}v&&v(a)});this.setAnimationLoop=function(a){v=
a};this.dispose=function(){};this.getStandingMatrix=function(){return new THREE.Matrix4};this.submitFrame=function(){}}function Jf(a){var b;function c(){z=new Nj(x);(A=new Lj(x,z,a)).isWebGL2||(z.get("WEBGL_depth_texture"),z.get("OES_texture_float"),z.get("OES_texture_half_float"),z.get("OES_texture_half_float_linear"),z.get("OES_standard_derivatives"),z.get("OES_element_index_uint"),z.get("ANGLE_instanced_arrays"));z.get("OES_texture_float_linear");aa=new Yh(x,z,A);(B=new Ik(x,z,aa,A)).scissor(md.copy(oa).multiplyScalar(Ba));
B.viewport(ub.copy(na).multiplyScalar(Ba));E=new Qj(x);C=new Ak;F=new Jk(x,z,B,C,A,aa,E);S=new Ej(x);G=new Oj(x,S,E);L=new Tj(G,E);X=new Sj(x);J=new zk(K,z,A);U=new Dk;W=new Hk;P=new Jj(K,B,L,N);Y=new Kj(x,z,E,A);Z=new Pj(x,z,E,A);E.programs=J.programs;K.context=x;K.capabilities=A;K.extensions=z;K.properties=C;K.renderLists=U;K.state=B;K.info=E}function d(a){a.preventDefault();ea=!0}function e(){ea=!1;c()}function f(a){a=a.target;a.removeEventListener("dispose",f);g(a);C.remove(a)}function g(a){var b=
C.get(a).program;(a.program=void 0)!==b&&J.releaseProgram(b)}function h(a,b,c,d){for(var e=0,f=a.length;e<f;e++){var g=a[e],h=g.object,m=g.geometry,q=void 0===d?g.material:d;g=g.group;if(c.isArrayCamera)for(var p=(la=c).cameras,w=0,l=p.length;w<l;w++){var t=p[w];if(h.layers.test(t.layers)){if("viewport"in t)B.viewport(ub.copy(t.viewport));else{var u=t.bounds;B.viewport(ub.set(u.x*hb,u.y*Ia,u.z*hb,u.w*Ia).multiplyScalar(Ba))}M.setupLights(t);k(h,b,t,m,q,g)}}else la=null,k(h,b,c,m,q,g)}}function k(a,
c,d,e,f,g){if(a.onBeforeRender(K,c,d,e,f,g),M=W.get(c,la||d),a.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,a.matrixWorld),a.normalMatrix.getNormalMatrix(a.modelViewMatrix),a.isImmediateRenderObject){B.setMaterial(f);var h=q(d,c.fog,f,a);Ee=b=null;Fe=!1;var k=h;a.render(function(a){K.renderBufferImmediate(a,k)})}else K.renderBufferDirect(d,c.fog,e,f,a,g);a.onAfterRender(K,c,d,e,f,g);M=W.get(c,la||d)}function m(a,b,c){var d=C.get(a),e=M.state.lights,h=d.lightsHash,k=e.state.hash;c=J.getParameters(a,
e.state,M.state.shadowsArray,b,ca.numPlanes,ca.numIntersection,c);var m=J.getProgramCode(a,c),q=d.program,p=!0;if(void 0===q)a.addEventListener("dispose",f);else if(q.code!==m)g(a);else{if(h.stateID!==k.stateID||h.directionalLength!==k.directionalLength||h.pointLength!==k.pointLength||h.spotLength!==k.spotLength||h.rectAreaLength!==k.rectAreaLength||h.hemiLength!==k.hemiLength||h.shadowsLength!==k.shadowsLength)h.stateID=k.stateID,h.directionalLength=k.directionalLength,h.pointLength=k.pointLength,
h.spotLength=k.spotLength,h.rectAreaLength=k.rectAreaLength,h.hemiLength=k.hemiLength,h.shadowsLength=k.shadowsLength;else if(void 0!==c.shaderID)return;p=!1}p&&(c.shaderID?(m=Ya[c.shaderID],d.shader={name:a.type,uniforms:kc(m.uniforms),vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}):d.shader={name:a.type,uniforms:a.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader},a.onBeforeCompile(d.shader,K),m=J.getProgramCode(a,c),q=J.acquireProgram(a,d.shader,c,m),d.program=
q,a.program=q);c=q.getAttributes();if(a.morphTargets)for(m=a.numSupportedMorphTargets=0;m<K.maxMorphTargets;m++)0<=c["morphTarget"+m]&&a.numSupportedMorphTargets++;if(a.morphNormals)for(m=a.numSupportedMorphNormals=0;m<K.maxMorphNormals;m++)0<=c["morphNormal"+m]&&a.numSupportedMorphNormals++;c=d.shader.uniforms;(a.isShaderMaterial||a.isRawShaderMaterial)&&!0!==a.clipping||(d.numClippingPlanes=ca.numPlanes,d.numIntersection=ca.numIntersection,c.clippingPlanes=ca.uniform);d.fog=b;void 0===h&&(d.lightsHash=
h={});h.stateID=k.stateID;h.directionalLength=k.directionalLength;h.pointLength=k.pointLength;h.spotLength=k.spotLength;h.rectAreaLength=k.rectAreaLength;h.hemiLength=k.hemiLength;h.shadowsLength=k.shadowsLength;a.lights&&(c.ambientLightColor.value=e.state.ambient,c.directionalLights.value=e.state.directional,c.spotLights.value=e.state.spot,c.rectAreaLights.value=e.state.rectArea,c.pointLights.value=e.state.point,c.hemisphereLights.value=e.state.hemi,c.directionalShadowMap.value=e.state.directionalShadowMap,
c.directionalShadowMatrix.value=e.state.directionalShadowMatrix,c.spotShadowMap.value=e.state.spotShadowMap,c.spotShadowMatrix.value=e.state.spotShadowMatrix,c.pointShadowMap.value=e.state.pointShadowMap,c.pointShadowMatrix.value=e.state.pointShadowMatrix);a=d.program.getUniforms();a=rb.seqWithValue(a.seq,c);d.uniformsList=a}function q(a,b,c,d){If=0;var e=C.get(c),f=e.lightsHash,g=M.state.lights.state.hash;ra&&(ta||a!==fa)&&ca.setState(c.clippingPlanes,c.clipIntersection,c.clipShadows,a,e,a===fa&&
c.id===ja);!1===c.needsUpdate&&(void 0===e.program?c.needsUpdate=!0:c.fog&&e.fog!==b?c.needsUpdate=!0:(!c.lights||f.stateID===g.stateID&&f.directionalLength===g.directionalLength&&f.pointLength===g.pointLength&&f.spotLength===g.spotLength&&f.rectAreaLength===g.rectAreaLength&&f.hemiLength===g.hemiLength&&f.shadowsLength===g.shadowsLength)&&(void 0===e.numClippingPlanes||e.numClippingPlanes===ca.numPlanes&&e.numIntersection===ca.numIntersection)||(c.needsUpdate=!0));c.needsUpdate&&(m(c,b,d),c.needsUpdate=
!1);var h,k=!1;g=f=!1;var q=e.program,t=q.getUniforms(),u=e.shader.uniforms;if(B.useProgram(q.program)&&(g=f=k=!0),c.id!==ja&&(ja=c.id,f=!0),k||fa!==a){if(t.setValue(x,"projectionMatrix",a.projectionMatrix),A.logarithmicDepthBuffer&&t.setValue(x,"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2)),fa!==a&&(fa=a,g=f=!0),c.isShaderMaterial||c.isMeshPhongMaterial||c.isMeshStandardMaterial||c.envMap)k=t.map.cameraPosition,void 0!==k&&k.setValue(x,ma.setFromMatrixPosition(a.matrixWorld));(c.isMeshPhongMaterial||
c.isMeshLambertMaterial||c.isMeshBasicMaterial||c.isMeshStandardMaterial||c.isShaderMaterial||c.skinning)&&t.setValue(x,"viewMatrix",a.matrixWorldInverse)}if(c.skinning&&(t.setOptional(x,d,"bindMatrix"),t.setOptional(x,d,"bindMatrixInverse"),a=d.skeleton))if(k=a.bones,A.floatVertexTextures){if(void 0===a.boneTexture){k=Math.sqrt(4*k.length);k=Q.ceilPowerOfTwo(k);k=Math.max(k,4);var n=new Float32Array(k*k*4);n.set(a.boneMatrices);var T=new Hb(n,k,k,1023,1015);T.needsUpdate=!0;a.boneMatrices=n;a.boneTexture=
T;a.boneTextureSize=k}t.setValue(x,"boneTexture",a.boneTexture);t.setValue(x,"boneTextureSize",a.boneTextureSize)}else t.setOptional(x,a,"boneMatrices");return f&&(t.setValue(x,"toneMappingExposure",K.toneMappingExposure),t.setValue(x,"toneMappingWhitePoint",K.toneMappingWhitePoint),c.lights&&(h=g,u.ambientLightColor.needsUpdate=h,u.directionalLights.needsUpdate=h,u.pointLights.needsUpdate=h,u.spotLights.needsUpdate=h,u.rectAreaLights.needsUpdate=h,u.hemisphereLights.needsUpdate=h),b&&c.fog&&(u.fogColor.value=
b.color,b.isFog?(u.fogNear.value=b.near,u.fogFar.value=b.far):b.isFogExp2&&(u.fogDensity.value=b.density)),c.isMeshBasicMaterial?p(u,c):c.isMeshLambertMaterial?(p(u,c),c.emissiveMap&&(u.emissiveMap.value=c.emissiveMap)):c.isMeshPhongMaterial?(p(u,c),c.isMeshToonMaterial?(w(u,c),c.gradientMap&&(u.gradientMap.value=c.gradientMap)):w(u,c)):c.isMeshStandardMaterial?(p(u,c),c.isMeshPhysicalMaterial?(l(u,c),u.reflectivity.value=c.reflectivity,u.clearCoat.value=c.clearCoat,u.clearCoatRoughness.value=c.clearCoatRoughness):
l(u,c)):c.isMeshMatcapMaterial?(p(u,c),function(a,b){b.matcap&&(a.matcap.value=b.matcap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias)}(u,c)):c.isMeshDepthMaterial?
(p(u,c),c.displacementMap&&(u.displacementMap.value=c.displacementMap,u.displacementScale.value=c.displacementScale,u.displacementBias.value=c.displacementBias)):c.isMeshDistanceMaterial?(p(u,c),function(a,b){b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);a.referencePosition.value.copy(b.referencePosition);a.nearDistance.value=b.nearDistance;a.farDistance.value=b.farDistance}(u,c)):c.isMeshNormalMaterial?
(p(u,c),function(a,b){b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias)}(u,c)):c.isLineBasicMaterial?(u.diffuse.value=c.color,u.opacity.value=c.opacity,c.isLineDashedMaterial&&
(u.dashSize.value=c.dashSize,u.totalSize.value=c.dashSize+c.gapSize,u.scale.value=c.scale)):c.isPointsMaterial?(u.diffuse.value=c.color,u.opacity.value=c.opacity,u.size.value=c.size*Ba,u.scale.value=.5*Ia,u.map.value=c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),u.uvTransform.value.copy(c.map.matrix))):c.isSpriteMaterial?(u.diffuse.value=c.color,u.opacity.value=c.opacity,u.rotation.value=c.rotation,u.map.value=c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),
u.uvTransform.value.copy(c.map.matrix))):c.isShadowMaterial&&(u.color.value=c.color,u.opacity.value=c.opacity),void 0!==u.ltc_1&&(u.ltc_1.value=H.LTC_1),void 0!==u.ltc_2&&(u.ltc_2.value=H.LTC_2),rb.upload(x,e.uniformsList,u,K)),c.isShaderMaterial&&!0===c.uniformsNeedUpdate&&(rb.upload(x,e.uniformsList,u,K),c.uniformsNeedUpdate=!1),c.isSpriteMaterial&&t.setValue(x,"center",d.center),t.setValue(x,"modelViewMatrix",d.modelViewMatrix),t.setValue(x,"normalMatrix",d.normalMatrix),t.setValue(x,"modelMatrix",
d.matrixWorld),q}function p(a,b){var c;a.opacity.value=b.opacity;b.color&&(a.diffuse.value=b.color);b.emissive&&a.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity);b.map&&(a.map.value=b.map);b.alphaMap&&(a.alphaMap.value=b.alphaMap);b.specularMap&&(a.specularMap.value=b.specularMap);b.envMap&&(a.envMap.value=b.envMap,a.flipEnvMap.value=b.envMap.isCubeTexture?-1:1,a.reflectivity.value=b.reflectivity,a.refractionRatio.value=b.refractionRatio,a.maxMipLevel.value=C.get(b.envMap).__maxMipLevel);
b.lightMap&&(a.lightMap.value=b.lightMap,a.lightMapIntensity.value=b.lightMapIntensity);b.aoMap&&(a.aoMap.value=b.aoMap,a.aoMapIntensity.value=b.aoMapIntensity);b.map?c=b.map:b.specularMap?c=b.specularMap:b.displacementMap?c=b.displacementMap:b.normalMap?c=b.normalMap:b.bumpMap?c=b.bumpMap:b.roughnessMap?c=b.roughnessMap:b.metalnessMap?c=b.metalnessMap:b.alphaMap?c=b.alphaMap:b.emissiveMap&&(c=b.emissiveMap);void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),
a.uvTransform.value.copy(c.matrix))}function w(a,b){a.specular.value=b.specular;a.shininess.value=Math.max(b.shininess,1E-4);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,
a.displacementBias.value=b.displacementBias)}function l(a,b){a.roughness.value=b.roughness;a.metalness.value=b.metalness;b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap);b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());
b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);b.envMap&&(a.envMapIntensity.value=b.envMapIntensity)}var u=void 0!==(a=a||{}).canvas?a.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=void 0!==a.context?a.context:null,D=void 0!==a.alpha&&a.alpha,v=void 0===a.depth||a.depth,y=void 0===a.stencil||a.stencil,O=void 0!==a.antialias&&a.antialias,N=void 0===a.premultipliedAlpha||
a.premultipliedAlpha,r=void 0!==a.preserveDrawingBuffer&&a.preserveDrawingBuffer,V=void 0!==a.powerPreference?a.powerPreference:"default",R=null,M=null;this.domElement=u;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this.gammaFactor=2;this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1;this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1;this.maxMorphTargets=
8;this.maxMorphNormals=4;var x,z,A,B,E,C,F,S,G,L,J,U,W,P,X,Y,Z,aa,K=this,ea=!1,ba=null,ha=null,ia=null,ja=-1;var Ee=b=null;var Fe=!1;var fa=null,la=null,ub=new da,md=new da,Hf=null,If=0,hb=u.width,Ia=u.height,Ba=1,na=new da(0,0,hb,Ia),oa=new da(0,0,hb,Ia),ua=!1,sa=new Ae,ca=new Mj,ra=!1,ta=!1,pa=new I,ma=new n;try{D={alpha:D,depth:v,stencil:y,antialias:O,premultipliedAlpha:N,preserveDrawingBuffer:r,powerPreference:V};if(u.addEventListener("webglcontextlost",d,!1),u.addEventListener("webglcontextrestored",
e,!1),null===(x=t||u.getContext("webgl",D)||u.getContext("experimental-webgl",D)))throw null!==u.getContext("webgl")?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");void 0===x.getShaderPrecisionFormat&&(x.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(tl){}c();var ka=null;"undefined"!=typeof navigator&&(ka="xr"in navigator?new Kk(K):new bi(K));this.vr=ka;var Aa=new Wh(K,L,A.maxTextureSize);this.shadowMap=
Aa;this.getContext=function(){return x};this.getContextAttributes=function(){return x.getContextAttributes()};this.forceContextLoss=function(){var a=z.get("WEBGL_lose_context");a&&a.loseContext()};this.forceContextRestore=function(){var a=z.get("WEBGL_lose_context");a&&a.restoreContext()};this.getPixelRatio=function(){return Ba};this.setPixelRatio=function(a){void 0!==a&&(Ba=a,this.setSize(hb,Ia,!1))};this.getSize=function(){return{width:hb,height:Ia}};this.setSize=function(a,b,c){ka.isPresenting()||
(hb=a,Ia=b,u.width=a*Ba,u.height=b*Ba,!1!==c&&(u.style.width=a+"px",u.style.height=b+"px"),this.setViewport(0,0,a,b))};this.getDrawingBufferSize=function(){return{width:hb*Ba,height:Ia*Ba}};this.setDrawingBufferSize=function(a,b,c){hb=a;Ia=b;Ba=c;u.width=a*c;u.height=b*c;this.setViewport(0,0,a,b)};this.getCurrentViewport=function(){return ub};this.setViewport=function(a,b,c,d){na.set(a,Ia-b-d,c,d);B.viewport(ub.copy(na).multiplyScalar(Ba))};this.setScissor=function(a,b,c,d){oa.set(a,Ia-b-d,c,d);B.scissor(md.copy(oa).multiplyScalar(Ba))};
this.setScissorTest=function(a){B.setScissorTest(ua=a)};this.getClearColor=function(){return P.getClearColor()};this.setClearColor=function(){P.setClearColor.apply(P,arguments)};this.getClearAlpha=function(){return P.getClearAlpha()};this.setClearAlpha=function(){P.setClearAlpha.apply(P,arguments)};this.clear=function(a,b,c){var d=0;(void 0===a||a)&&(d|=16384);(void 0===b||b)&&(d|=256);(void 0===c||c)&&(d|=1024);x.clear(d)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,
!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.dispose=function(){u.removeEventListener("webglcontextlost",d,!1);u.removeEventListener("webglcontextrestored",e,!1);U.dispose();W.dispose();C.dispose();L.dispose();ka.dispose();va.stop()};this.renderBufferImmediate=function(a,b){B.initAttributes();var c=C.get(a);a.hasPositions&&!c.position&&(c.position=x.createBuffer());a.hasNormals&&!c.normal&&(c.normal=x.createBuffer());a.hasUvs&&!c.uv&&(c.uv=x.createBuffer());a.hasColors&&!c.color&&
(c.color=x.createBuffer());b=b.getAttributes();a.hasPositions&&(x.bindBuffer(34962,c.position),x.bufferData(34962,a.positionArray,35048),B.enableAttribute(b.position),x.vertexAttribPointer(b.position,3,5126,!1,0,0));a.hasNormals&&(x.bindBuffer(34962,c.normal),x.bufferData(34962,a.normalArray,35048),B.enableAttribute(b.normal),x.vertexAttribPointer(b.normal,3,5126,!1,0,0));a.hasUvs&&(x.bindBuffer(34962,c.uv),x.bufferData(34962,a.uvArray,35048),B.enableAttribute(b.uv),x.vertexAttribPointer(b.uv,2,5126,
!1,0,0));a.hasColors&&(x.bindBuffer(34962,c.color),x.bufferData(34962,a.colorArray,35048),B.enableAttribute(b.color),x.vertexAttribPointer(b.color,3,5126,!1,0,0));B.disableUnusedAttributes();x.drawArrays(4,0,a.count);a.count=0};this.renderBufferDirect=function(a,c,d,e,f,g){var h=f.isMesh&&0>f.normalMatrix.determinant();B.setMaterial(e,h);var k=q(a,c,e,f),m=!1;b===d.id&&Ee===k.id&&Fe===(!0===e.wireframe)||(b=d.id,Ee=k.id,Fe=!0===e.wireframe,m=!0);f.morphTargetInfluences&&(X.update(f,d,e,k),m=!0);var p;
h=d.index;var w=d.attributes.position;c=1;!0===e.wireframe&&(h=G.getWireframeAttribute(d),c=2);a=Y;null!==h&&(p=S.get(h),(a=Z).setIndex(p));if(m){if(!(d&&d.isInstancedBufferGeometry&!A.isWebGL2&&null===z.get("ANGLE_instanced_arrays"))){B.initAttributes();m=d.attributes;k=k.getAttributes();var u=e.defaultAttributeValues;for(r in k){var l=k[r];if(0<=l){var t=m[r];if(void 0!==t){var n=t.normalized,T=t.itemSize,D=S.get(t);if(void 0!==D){var y=D.buffer,O=D.type;D=D.bytesPerElement;if(t.isInterleavedBufferAttribute){var v=
t.data,N=v.stride;t=t.offset;v&&v.isInstancedInterleavedBuffer?(B.enableAttributeAndDivisor(l,v.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=v.meshPerAttribute*v.count)):B.enableAttribute(l);x.bindBuffer(34962,y);x.vertexAttribPointer(l,T,O,n,N*D,t*D)}else t.isInstancedBufferAttribute?(B.enableAttributeAndDivisor(l,t.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=t.meshPerAttribute*t.count)):B.enableAttribute(l),x.bindBuffer(34962,y),x.vertexAttribPointer(l,
T,O,n,0,0)}}else if(void 0!==u&&(n=u[r],void 0!==n))switch(n.length){case 2:x.vertexAttrib2fv(l,n);break;case 3:x.vertexAttrib3fv(l,n);break;case 4:x.vertexAttrib4fv(l,n);break;default:x.vertexAttrib1fv(l,n)}}}B.disableUnusedAttributes()}!0;null!==h&&x.bindBuffer(34963,p.buffer)}p=1/0;null!==h?p=h.count:void 0!==w&&(p=w.count);h=d.drawRange.start*c;w=null!==g?g.start*c:0;var r=Math.max(h,w);g=Math.max(0,Math.min(p,h+d.drawRange.count*c,w+(null!==g?g.count*c:1/0))-1-r+1);if(0!==g){if(f.isMesh)if(!0===
e.wireframe)B.setLineWidth(e.wireframeLinewidth*(null===ha?Ba:1)),a.setMode(1);else switch(f.drawMode){case 0:a.setMode(4);break;case 1:a.setMode(5);break;case 2:a.setMode(6)}else f.isLine?(e=e.linewidth,void 0===e&&(e=1),B.setLineWidth(e*(null===ha?Ba:1)),f.isLineSegments?a.setMode(1):f.isLineLoop?a.setMode(2):a.setMode(3)):f.isPoints?a.setMode(0):f.isSprite&&a.setMode(4);d&&d.isInstancedBufferGeometry?0<d.maxInstancedCount&&a.renderInstances(d,r,g):a.render(r,g)}};this.compile=function(a,b){(M=
W.get(a,b)).init();a.traverse(function(a){a.isLight&&(M.pushLight(a),a.castShadow&&M.pushShadow(a))});M.setupLights(b);a.traverse(function(b){if(b.material)if(Array.isArray(b.material))for(var c=0;c<b.material.length;c++)m(b.material[c],a.fog,b);else m(b.material,a.fog,b)})};var wa=null,xa,ya,za,va=new Cf;va.setAnimationLoop(function(a){ka.isPresenting()||wa&&wa(a)});"undefined"!=typeof window&&va.setContext(window);this.setAnimationLoop=function(a){wa=a;ka.setAnimationLoop(a);va.start()};this.render=
function(a,c,d,e){if(c&&c.isCamera&&!ea){Ee=b=null;Fe=!1;ja=-1;!(fa=null)===a.autoUpdate&&a.updateMatrixWorld();null===c.parent&&c.updateMatrixWorld();ka.enabled&&(c=ka.getCamera(c));(M=W.get(a,c)).init();a.onBeforeRender(K,a,c,d);pa.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);sa.setFromMatrix(pa);ta=this.localClippingEnabled;ra=ca.init(this.clippingPlanes,ta,c);(R=U.get(a,c)).init();(function Lk(a,b,c){if(!1!==a.visible){if(a.layers.test(b.layers))if(a.isLight)M.pushLight(a),a.castShadow&&
M.pushShadow(a);else if(a.isSprite){if(!a.frustumCulled||sa.intersectsSprite(a)){c&&ma.setFromMatrixPosition(a.matrixWorld).applyMatrix4(pa);var d=L.update(a),e=a.material;R.push(a,d,e,ma.z,null)}}else if(a.isImmediateRenderObject)c&&ma.setFromMatrixPosition(a.matrixWorld).applyMatrix4(pa),R.push(a,null,a.material,ma.z,null);else if((a.isMesh||a.isLine||a.isPoints)&&(a.isSkinnedMesh&&a.skeleton.update(),!a.frustumCulled||sa.intersectsObject(a)))if(c&&ma.setFromMatrixPosition(a.matrixWorld).applyMatrix4(pa),
d=L.update(a),e=a.material,Array.isArray(e))for(var f=d.groups,g=0,h=f.length;g<h;g++){var k=f[g],m=e[k.materialIndex];m&&m.visible&&R.push(a,d,m,ma.z,k)}else e.visible&&R.push(a,d,e,ma.z,null);a=a.children;g=0;for(h=a.length;g<h;g++)Lk(a[g],b,c)}})(a,c,K.sortObjects);!0===K.sortObjects&&R.sort();ra&&ca.beginShadows();Aa.render(M.state.shadowsArray,a,c);M.setupLights(c);ra&&ca.endShadows();this.info.autoReset&&this.info.reset();void 0===d&&(d=null);this.setRenderTarget(d);P.render(R,a,c,e);e=R.opaque;
var f=R.transparent;if(a.overrideMaterial){var g=a.overrideMaterial;e.length&&h(e,a,c,g);f.length&&h(f,a,c,g)}else e.length&&h(e,a,c),f.length&&h(f,a,c);d&&F.updateRenderTargetMipmap(d);B.buffers.depth.setTest(!0);B.buffers.depth.setMask(!0);B.buffers.color.setMask(!0);B.setPolygonOffset(!1);a.onAfterRender(K,a,c);ka.enabled&&ka.submitFrame();M=R=null}};this.allocTextureUnit=function(){var a=If;return A.maxTextures,If+=1,a};this.setTexture2D=(xa=!1,function(a,b){a&&a.isWebGLRenderTarget&&(xa||(xa=
!0),a=a.texture);F.setTexture2D(a,b)});this.setTexture3D=function(a,b){F.setTexture3D(a,b)};this.setTexture=(ya=!1,function(a,b){ya||(ya=!0);F.setTexture2D(a,b)});this.setTextureCube=(za=!1,function(a,b){a&&a.isWebGLRenderTargetCube&&(za||(za=!0),a=a.texture);a&&a.isCubeTexture||Array.isArray(a.image)&&6===a.image.length?F.setTextureCube(a,b):F.setTextureCubeDynamic(a,b)});this.setFramebuffer=function(a){ba=a};this.getRenderTarget=function(){return ha};this.setRenderTarget=function(a){(ha=a)&&void 0===
C.get(a).__webglFramebuffer&&F.setupRenderTarget(a);var b=ba,c=!1;if(a){var d=C.get(a).__webglFramebuffer;a.isWebGLRenderTargetCube?(b=d[a.activeCubeFace],c=!0):b=d;ub.copy(a.viewport);md.copy(a.scissor);Hf=a.scissorTest}else ub.copy(na).multiplyScalar(Ba),md.copy(oa).multiplyScalar(Ba),Hf=ua;if(ia!==b&&(x.bindFramebuffer(36160,b),ia=b),B.viewport(ub),B.scissor(md),B.setScissorTest(Hf),c)b=C.get(a.texture),x.framebufferTexture2D(36160,36064,34069+a.activeCubeFace,b.__webglTexture,a.activeMipMapLevel)};
this.readRenderTargetPixels=function(a,b,c,d,e,f){if(a&&a.isWebGLRenderTarget){var g=C.get(a).__webglFramebuffer;if(g){var h=!1;g!==ia&&(x.bindFramebuffer(36160,g),h=!0);try{var k=a.texture,m=k.format,q=k.type;1023!==m&&aa.convert(m)!==x.getParameter(35739)||!(1009===q||aa.convert(q)===x.getParameter(35738)||1015===q&&(A.isWebGL2||z.get("OES_texture_float")||z.get("WEBGL_color_buffer_float"))||1016===q&&(A.isWebGL2?z.get("EXT_color_buffer_float"):z.get("EXT_color_buffer_half_float")))||36053===x.checkFramebufferStatus(36160)&&
0<=b&&b<=a.width-d&&0<=c&&c<=a.height-e&&x.readPixels(b,c,d,e,aa.convert(m),aa.convert(q),f)}finally{h&&x.bindFramebuffer(36160,ia)}}}};this.copyFramebufferToTexture=function(a,b,c){var d=b.image.width,e=b.image.height,f=aa.convert(b.format);this.setTexture2D(b,0);x.copyTexImage2D(3553,c||0,f,a.x,a.y,d,e,0)};this.copyTextureToTexture=function(a,b,c,d){var e=b.image.width,f=b.image.height,g=aa.convert(c.format),h=aa.convert(c.type);this.setTexture2D(c,0);b.isDataTexture?x.texSubImage2D(3553,d||0,a.x,
a.y,e,f,g,h,b.image.data):x.texSubImage2D(3553,d||0,a.x,a.y,g,h,b.image)}}function qc(a,b){this.name="";this.color=new L(a);this.density=void 0!==b?b:2.5E-4}function rc(a,b,c){this.name="";this.color=new L(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3}function Ge(){E.call(this);this.type="Scene";this.overrideMaterial=this.fog=this.background=null;this.autoUpdate=!0}function Ob(a,b){this.array=a;this.stride=b;this.count=void 0!==a?a.length/b:0;this.dynamic=!1;this.updateRange={offset:0,count:-1};
this.version=0}function od(a,b,c,d){this.data=a;this.itemSize=b;this.offset=c;this.normalized=!0===d}function ib(a){U.call(this);this.type="SpriteMaterial";this.color=new L(16777215);this.map=null;this.rotation=0;this.sizeAttenuation=!0;this.lights=!1;this.transparent=!0;this.setValues(a)}function vb(a){if(E.call(this),this.type="Sprite",void 0===sc){sc=new F;var b=new Ob(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);sc.setIndex([0,1,2,0,2,3]);sc.addAttribute("position",
new od(b,3,0,!1));sc.addAttribute("uv",new od(b,2,3,!1))}this.geometry=sc;this.material=void 0!==a?a:new ib;this.center=new x(.5,.5)}function pd(){E.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function qd(a,b){a&&a.isGeometry;wa.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new I;this.bindMatrixInverse=new I}function He(a,b){if(a=a||[],this.bones=a.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===
b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(this.boneInverses=[],a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new I)}function Kf(){E.call(this);this.type="Bone"}function aa(a){U.call(this);this.type="LineBasicMaterial";this.color=new L(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.lights=!1;this.setValues(a)}function xa(a,b,c){E.call(this);this.type="Line";this.geometry=void 0!==a?a:new F;this.material=void 0!==
b?b:new aa({color:16777215*Math.random()})}function ba(a,b){xa.call(this,a,b);this.type="LineSegments"}function Ie(a,b){xa.call(this,a,b);this.type="LineLoop"}function La(a){U.call(this);this.type="PointsMaterial";this.color=new L(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.lights=this.morphTargets=!1;this.setValues(a)}function tc(a,b){E.call(this);this.type="Points";this.geometry=void 0!==a?a:new F;this.material=void 0!==b?b:new La({color:16777215*Math.random()})}function Lf(a,
b,c,d,e,f,g,h,k){Z.call(this,a,b,c,d,e,f,g,h,k);this.format=void 0!==g?g:1022;this.minFilter=void 0!==f?f:1006;this.magFilter=void 0!==e?e:1006;this.generateMipmaps=!1}function uc(a,b,c,d,e,f,g,h,k,m,q,p){Z.call(this,null,f,g,h,k,m,d,e,q,p);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}function rd(a,b,c,d,e,f,g,h,k){Z.call(this,a,b,c,d,e,f,g,h,k);this.needsUpdate=!0}function sd(a,b,c,d,e,f,g,h,k,m){if(1026!==(m=void 0!==m?m:1026)&&1027!==m)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");
void 0===c&&1026===m&&(c=1012);void 0===c&&1027===m&&(c=1020);Z.call(this,null,d,e,f,g,h,m,c,k);this.image={width:a,height:b};this.magFilter=void 0!==g?g:1003;this.minFilter=void 0!==h?h:1003;this.generateMipmaps=this.flipY=!1}function vc(a){F.call(this);this.type="WireframeGeometry";var b,c,d,e,f=[],g=[0,0],h={};var k=["a","b","c"];if(a&&a.isGeometry){var m=a.faces;var q=0;for(c=m.length;q<c;q++){var p=m[q];for(b=0;3>b;b++){var w=p[k[b]];var l=p[k[(b+1)%3]];g[0]=Math.min(w,l);g[1]=Math.max(w,l);
void 0===h[e=g[0]+","+g[1]]&&(h[e]={index1:g[0],index2:g[1]})}}for(e in h)q=h[e],k=a.vertices[q.index1],f.push(k.x,k.y,k.z),k=a.vertices[q.index2],f.push(k.x,k.y,k.z)}else if(a&&a.isBufferGeometry){var u;if(k=new n,null!==a.index){m=a.attributes.position;var t=a.index;0===(u=a.groups).length&&(u=[{start:0,count:t.count,materialIndex:0}]);a=0;for(d=u.length;a<d;++a)for(c=(q=(p=u[a]).start)+p.count;q<c;q+=3)for(b=0;3>b;b++)w=t.getX(q+b),l=t.getX(q+(b+1)%3),g[0]=Math.min(w,l),g[1]=Math.max(w,l),void 0===
h[e=g[0]+","+g[1]]&&(h[e]={index1:g[0],index2:g[1]});for(e in h)q=h[e],k.fromBufferAttribute(m,q.index1),f.push(k.x,k.y,k.z),k.fromBufferAttribute(m,q.index2),f.push(k.x,k.y,k.z)}else for(q=0,c=(m=a.attributes.position).count/3;q<c;q++)for(b=0;3>b;b++)e=3*q+b,k.fromBufferAttribute(m,e),f.push(k.x,k.y,k.z),e=3*q+(b+1)%3,k.fromBufferAttribute(m,e),f.push(k.x,k.y,k.z)}this.addAttribute("position",new B(f,3))}function td(a,b,c){J.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,
stacks:c};this.fromBufferGeometry(new wc(a,b,c));this.mergeVertices()}function wc(a,b,c){F.call(this);this.type="ParametricBufferGeometry";this.parameters={func:a,slices:b,stacks:c};var d,e,f=[],g=[],h=[],k=[],m=new n,q=new n,p=new n,w=new n,l=new n;a.length;var u=b+1;for(d=0;d<=c;d++){var t=d/c;for(e=0;e<=b;e++){var D=e/b;a(D,t,q);g.push(q.x,q.y,q.z);0<=D-1E-5?(a(D-1E-5,t,p),w.subVectors(q,p)):(a(D+1E-5,t,p),w.subVectors(p,q));0<=t-1E-5?(a(D,t-1E-5,p),l.subVectors(q,p)):(a(D,t+1E-5,p),l.subVectors(p,
q));m.crossVectors(w,l).normalize();h.push(m.x,m.y,m.z);k.push(D,t)}}for(d=0;d<c;d++)for(e=0;e<b;e++)a=d*u+e+1,m=(d+1)*u+e+1,q=(d+1)*u+e,f.push(d*u+e,a,q),f.push(a,m,q);this.setIndex(f);this.addAttribute("position",new B(g,3));this.addAttribute("normal",new B(h,3));this.addAttribute("uv",new B(k,2))}function ud(a,b,c,d){J.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};this.fromBufferGeometry(new ya(a,b,c,d));this.mergeVertices()}function ya(a,b,
c,d){function e(a){h.push(a.x,a.y,a.z)}function f(b,c){b*=3;c.x=a[b+0];c.y=a[b+1];c.z=a[b+2]}function g(a,b,c,d){0>d&&1===a.x&&(k[b]=a.x-1);0===c.x&&0===c.z&&(k[b]=d/2/Math.PI+.5)}F.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};c=c||1;var h=[],k=[];!function(a){for(var c=new n,d=new n,g=new n,h=0;h<b.length;h+=3){f(b[h+0],c);f(b[h+1],d);f(b[h+2],g);var k,m,l=c,v=d,y=g,O=Math.pow(2,a),r=[];for(m=0;m<=O;m++){r[m]=[];var x=l.clone().lerp(y,m/
O),V=v.clone().lerp(y,m/O),R=O-m;for(k=0;k<=R;k++)r[m][k]=0===k&&m===O?x:x.clone().lerp(V,k/R)}for(m=0;m<O;m++)for(k=0;k<2*(O-m)-1;k++)l=Math.floor(k/2),0==k%2?(e(r[m][l+1]),e(r[m+1][l]),e(r[m][l])):(e(r[m][l+1]),e(r[m+1][l+1]),e(r[m+1][l]))}}(d=d||0);(function(a){for(var b=new n,c=0;c<h.length;c+=3)b.x=h[c+0],b.y=h[c+1],b.z=h[c+2],b.normalize().multiplyScalar(a),h[c+0]=b.x,h[c+1]=b.y,h[c+2]=b.z})(c);(function(){for(var a=new n,b=0;b<h.length;b+=3){a.x=h[b+0];a.y=h[b+1];a.z=h[b+2];var c=Math.atan2(a.z,
-a.x)/2/Math.PI+.5,d=(e=a,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);k.push(c,1-d)}var e;(function(){for(var a=new n,b=new n,c=new n,d=new n,e=new x,f=new x,m=new x,q=0,p=0;q<h.length;q+=9,p+=6){a.set(h[q+0],h[q+1],h[q+2]);b.set(h[q+3],h[q+4],h[q+5]);c.set(h[q+6],h[q+7],h[q+8]);e.set(k[p+0],k[p+1]);f.set(k[p+2],k[p+3]);m.set(k[p+4],k[p+5]);d.copy(a).add(b).add(c).divideScalar(3);var w=Math.atan2(d.z,-d.x);g(e,p+0,a,w);g(f,p+2,b,w);g(m,p+4,c,w)}})();(function(){for(var a=0;a<k.length;a+=
6){var b=k[a+0],c=k[a+2],d=k[a+4],e=Math.min(b,c,d);.9<Math.max(b,c,d)&&.1>e&&(.2>b&&(k[a+0]+=1),.2>c&&(k[a+2]+=1),.2>d&&(k[a+4]+=1))}})()})();this.addAttribute("position",new B(h,3));this.addAttribute("normal",new B(h.slice(),3));this.addAttribute("uv",new B(k,2));0===d?this.computeVertexNormals():this.normalizeNormals()}function vd(a,b){J.call(this);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new xc(a,b));this.mergeVertices()}function xc(a,b){ya.call(this,
[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronBufferGeometry";this.parameters={radius:a,detail:b}}function wd(a,b){J.call(this);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Pb(a,b));this.mergeVertices()}function Pb(a,b){ya.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronBufferGeometry";this.parameters={radius:a,detail:b}}function xd(a,
b){J.call(this);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new yc(a,b));this.mergeVertices()}function yc(a,b){var c=(1+Math.sqrt(5))/2;ya.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronBufferGeometry";this.parameters={radius:a,detail:b}}function yd(a,
b){J.call(this);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new zc(a,b));this.mergeVertices()}function zc(a,b){var c=(1+Math.sqrt(5))/2,d=1/c;ya.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,
13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronBufferGeometry";this.parameters={radius:a,detail:b}}function zd(a,b,c,d,e,f){J.call(this);this.type="TubeGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};a=new Ac(a,b,c,d,e);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;this.fromBufferGeometry(a);this.mergeVertices()}function Ac(a,b,c,d,e){function f(e){w=
a.getPointAt(e/b,w);var f=g.normals[e];e=g.binormals[e];for(k=0;k<=d;k++){var h=k/d*Math.PI*2,p=Math.sin(h);h=-Math.cos(h);q.x=h*f.x+p*e.x;q.y=h*f.y+p*e.y;q.z=h*f.z+p*e.z;q.normalize();u.push(q.x,q.y,q.z);m.x=w.x+c*q.x;m.y=w.y+c*q.y;m.z=w.z+c*q.z;l.push(m.x,m.y,m.z)}}F.call(this);this.type="TubeBufferGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};b=b||64;c=c||1;d=d||8;e=e||!1;var g=a.computeFrenetFrames(b,e);this.tangents=g.tangents;this.normals=g.normals;
this.binormals=g.binormals;var h,k,m=new n,q=new n,p=new x,w=new n,l=[],u=[],t=[],D=[];!function(){for(h=0;h<b;h++)f(h);f(!1===e?b:0);for(h=0;h<=b;h++)for(k=0;k<=d;k++)p.x=h/b,p.y=k/d,t.push(p.x,p.y);for(k=1;k<=b;k++)for(h=1;h<=d;h++){var a=(d+1)*k+(h-1),c=(d+1)*k+h,g=(d+1)*(k-1)+h;D.push((d+1)*(k-1)+(h-1),a,g);D.push(a,c,g)}}();this.setIndex(D);this.addAttribute("position",new B(l,3));this.addAttribute("normal",new B(u,3));this.addAttribute("uv",new B(t,2))}function Ad(a,b,c,d,e,f,g){J.call(this);
this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};this.fromBufferGeometry(new Bc(a,b,c,d,e,f));this.mergeVertices()}function Bc(a,b,c,d,e,f){function g(a,b,c,d,e){var f=Math.sin(a);b=c/b*a;c=Math.cos(b);e.x=d*(2+c)*.5*Math.cos(a);e.y=d*(2+c)*f*.5;e.z=d*Math.sin(b)*.5}F.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};a=a||1;b=b||.4;c=Math.floor(c)||64;d=Math.floor(d)||
8;e=e||2;f=f||3;var h,k=[],m=[],q=[],p=[],w=new n,l=new n,u=new n,t=new n,D=new n,v=new n,y=new n;for(h=0;h<=c;++h){var r=h/c*e*Math.PI*2;g(r,e,f,a,u);g(r+.01,e,f,a,t);v.subVectors(t,u);y.addVectors(t,u);D.crossVectors(v,y);y.crossVectors(D,v);D.normalize();y.normalize();for(r=0;r<=d;++r){var x=r/d*Math.PI*2,z=-b*Math.cos(x);x=b*Math.sin(x);w.x=u.x+(z*y.x+x*D.x);w.y=u.y+(z*y.y+x*D.y);w.z=u.z+(z*y.z+x*D.z);m.push(w.x,w.y,w.z);l.subVectors(w,u).normalize();q.push(l.x,l.y,l.z);p.push(h/c);p.push(r/d)}}for(r=
1;r<=c;r++)for(h=1;h<=d;h++)a=(d+1)*r+(h-1),b=(d+1)*r+h,e=(d+1)*(r-1)+h,k.push((d+1)*(r-1)+(h-1),a,e),k.push(a,b,e);this.setIndex(k);this.addAttribute("position",new B(m,3));this.addAttribute("normal",new B(q,3));this.addAttribute("uv",new B(p,2))}function Bd(a,b,c,d,e){J.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};this.fromBufferGeometry(new Cc(a,b,c,d,e));this.mergeVertices()}function Cc(a,b,c,d,e){F.call(this);this.type="TorusBufferGeometry";
this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};a=a||1;b=b||.4;c=Math.floor(c)||8;d=Math.floor(d)||6;e=e||2*Math.PI;var f,g,h=[],k=[],m=[],q=[],p=new n,w=new n,l=new n;for(f=0;f<=c;f++)for(g=0;g<=d;g++){var u=g/d*e,t=f/c*Math.PI*2;w.x=(a+b*Math.cos(t))*Math.cos(u);w.y=(a+b*Math.cos(t))*Math.sin(u);w.z=b*Math.sin(t);k.push(w.x,w.y,w.z);p.x=a*Math.cos(u);p.y=a*Math.sin(u);l.subVectors(w,p).normalize();m.push(l.x,l.y,l.z);q.push(g/d);q.push(f/c)}for(f=1;f<=c;f++)for(g=1;g<=
d;g++)a=(d+1)*(f-1)+g-1,b=(d+1)*(f-1)+g,e=(d+1)*f+g,h.push((d+1)*f+g-1,a,e),h.push(a,b,e);this.setIndex(h);this.addAttribute("position",new B(k,3));this.addAttribute("normal",new B(m,3));this.addAttribute("uv",new B(q,2))}function ci(a,b,c,d,e){for(var f,g=0,h=b,k=c-d;h<c;h+=d)g+=(a[k]-a[h])*(a[h+1]+a[k+1]),k=h;if(e===0<g)for(e=b;e<c;e+=d)f=di(e,a[e],a[e+1],f);else for(e=c-d;b<=e;e-=d)f=di(e,a[e],a[e+1],f);return f&&Qb(f,f.next)&&(Cd(f),f=f.next),f}function Dd(a,b){if(!a)return a;b||(b=a);var c=a;
do if(a=!1,c.steiner||!Qb(c,c.next)&&0!==ma(c.prev,c,c.next))c=c.next;else{if(Cd(c),(c=b=c.prev)===c.next)break;a=!0}while(a||c!==b);return b}function Ed(a,b,c,d,e,f,g){if(a){if(!g&&f){for(var h=a,k=h;null===k.z&&(k.z=Mf(k.x,k.y,d,e,f)),k.prevZ=k.prev,k.nextZ=k.next,(k=k.next)!==h;);k.prevZ.nextZ=null;k.prevZ=null;h=k;var m,q,p,w,l=1;do{k=h;var u=h=null;for(p=0;k;){p++;var t=k;for(m=w=0;m<l&&(w++,t=t.nextZ);m++);for(m=l;0<w||0<m&&t;)0!==w&&(0===m||!t||k.z<=t.z)?(k=(q=k).nextZ,w--):(t=(q=t).nextZ,
m--),u?u.nextZ=q:h=q,q.prevZ=u,u=q;k=t}u.nextZ=null;l*=2}while(1<p)}for(k=a;a.prev!==a.next;){q=a.prev;h=a.next;if(f)a:{t=a;m=d;var n=e,r=f;u=t.prev;p=t;w=t.next;if(0<=ma(u,p,w))t=!1;else{var y=u.x>p.x?u.x>w.x?u.x:w.x:p.x>w.x?p.x:w.x,v=u.y>p.y?u.y>w.y?u.y:w.y:p.y>w.y?p.y:w.y;l=Mf(u.x<p.x?u.x<w.x?u.x:w.x:p.x<w.x?p.x:w.x,u.y<p.y?u.y<w.y?u.y:w.y:p.y<w.y?p.y:w.y,m,n,r);m=Mf(y,v,m,n,r);for(n=t.nextZ;n&&n.z<=m;){if(n!==t.prev&&n!==t.next&&Je(u.x,u.y,p.x,p.y,w.x,w.y,n.x,n.y)&&0<=ma(n.prev,n,n.next)){t=!1;
break a}n=n.nextZ}for(n=t.prevZ;n&&n.z>=l;){if(n!==t.prev&&n!==t.next&&Je(u.x,u.y,p.x,p.y,w.x,w.y,n.x,n.y)&&0<=ma(n.prev,n,n.next)){t=!1;break a}n=n.prevZ}t=!0}}else a:if(t=a,u=t.prev,p=t,w=t.next,0<=ma(u,p,w))t=!1;else{for(l=t.next.next;l!==t.prev;){if(Je(u.x,u.y,p.x,p.y,w.x,w.y,l.x,l.y)&&0<=ma(l.prev,l,l.next)){t=!1;break a}l=l.next}t=!0}if(t)b.push(q.i/c),b.push(a.i/c),b.push(h.i/c),Cd(a),k=a=h.next;else if((a=h)===k){if(g)if(1===g){g=b;q=c;h=a;do k=h.prev,t=h.next.next,!Qb(k,t)&&ei(k,h,h.next,
t)&&Fd(k,t)&&Fd(t,k)&&(g.push(k.i/q),g.push(h.i/q),g.push(t.i/q),Cd(h),Cd(h.next),h=a=t),h=h.next;while(h!==a);Ed(h,b,c,d,e,f,2)}else{if(2===g)a:{g=a;do{for(q=g.next.next;q!==g.prev;){if(h=g.i!==q.i){h=g;k=q;if(t=h.next.i!==k.i&&h.prev.i!==k.i){b:{t=h;do{if(t.i!==h.i&&t.next.i!==h.i&&t.i!==k.i&&t.next.i!==k.i&&ei(t,t.next,h,k)){t=!0;break b}t=t.next}while(t!==h);t=!1}t=!t}if(t=t&&Fd(h,k)&&Fd(k,h)){t=h;u=!1;p=(h.x+k.x)/2;for(k=(h.y+k.y)/2;t.y>k!=t.next.y>k&&t.next.y!==t.y&&p<(t.next.x-t.x)*(k-t.y)/
(t.next.y-t.y)+t.x&&(u=!u),(t=t.next)!==h;);t=u}h=t}if(h){a=fi(g,q);g=Dd(g,g.next);a=Dd(a,a.next);Ed(g,b,c,d,e,f);Ed(a,b,c,d,e,f);break a}q=q.next}g=g.next}while(g!==a)}}else Ed(Dd(a),b,c,d,e,f,1);break}}}}function Mk(a,b){return a.x-b.x}function Nk(a,b){var c=b,d=a.x,e=a.y,f=-1/0;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var g=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(g<=d&&f<g){if((f=g)===d){if(e===c.y)return c;if(e===c.next.y)return c.next}var h=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);
if(!h)return null;if(d===f)return h.prev;var k;b=h;g=h.x;var m=h.y,q=1/0;for(c=h.next;c!==b;)d>=c.x&&c.x>=g&&d!==c.x&&Je(e<m?d:f,e,g,m,e<m?f:d,e,c.x,c.y)&&((k=Math.abs(e-c.y)/(d-c.x))<q||k===q&&c.x>h.x)&&Fd(c,a)&&(h=c,q=k),c=c.next;return h}function Mf(a,b,c,d,e){return 1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-c)*e)|a<<8))|a<<4))|a<<2))|a<<1)|(1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-d)*e)|b<<8))|b<<4))|b<<2))|b<<1))<<1}function Ok(a){for(var b=a,c=
a;b.x<c.x&&(c=b),(b=b.next)!==a;);return c}function Je(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function ma(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function Qb(a,b){return a.x===b.x&&a.y===b.y}function ei(a,b,c,d){return!!(Qb(a,b)&&Qb(c,d)||Qb(a,d)&&Qb(c,b))||0<ma(a,b,c)!=0<ma(a,b,d)&&0<ma(c,d,a)!=0<ma(c,d,b)}function Fd(a,b){return 0>ma(a.prev,a,a.next)?0<=ma(a,b,a.next)&&0<=ma(a,a.prev,b):0>ma(a,b,a.prev)||0>ma(a,a.next,
b)}function fi(a,b){var c=new Nf(a.i,a.x,a.y),d=new Nf(b.i,b.x,b.y),e=a.next,f=b.prev;return(a.next=b).prev=a,(c.next=e).prev=c,(d.next=c).prev=d,(f.next=d).prev=f,d}function di(a,b,c,d){a=new Nf(a,b,c);return d?(a.next=d.next,(a.prev=d).next.prev=a,d.next=a):(a.prev=a).next=a,a}function Cd(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Nf(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=
!1}function gi(a){var b=a.length;2<b&&a[b-1].equals(a[0])&&a.pop()}function hi(a,b){for(var c=0;c<b.length;c++)a.push(b[c].x),a.push(b[c].y)}function Rb(a,b){J.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:a,options:b};this.fromBufferGeometry(new $a(a,b));this.mergeVertices()}function $a(a,b){function c(a){function c(a,b,c){return b.clone().multiplyScalar(c).add(a)}function g(a,b,c){var d,e;var f=a.x-b.x;var g=a.y-b.y,h=c.x-a.x,k=c.y-a.y,m=f*f+g*g;if(Math.abs(f*k-g*h)>Number.EPSILON){var q=
Math.sqrt(m),p=Math.sqrt(h*h+k*k);m=b.x-g/q;b=b.y+f/q;h=((c.x-k/p-m)*k-(c.y+h/p-b)*h)/(f*k-g*h);f=(d=m+f*h-a.x)*d+(e=b+g*h-a.y)*e;if(2>=f)return new x(d,e);f=Math.sqrt(f/2)}else a=!1,f>Number.EPSILON?h>Number.EPSILON&&(a=!0):f<-Number.EPSILON?h<-Number.EPSILON&&(a=!0):Math.sign(g)===Math.sign(k)&&(a=!0),f=a?(d=-g,e=f,Math.sqrt(m)):(d=f,e=g,Math.sqrt(m/2));return new x(d/f,e/f)}function h(a,b){var c,f;for(K=a.length;0<=--K;){0>(f=(c=K)-1)&&(f=a.length-1);var g,h=y+2*R;for(g=0;g<h;g++){var k=Y*g,m=
Y*(g+1),q=b+f+k,p=b+f+m;m=b+c+m;u(b+c+k);u(q);u(m);u(q);u(p);u(m);k=e.length/3;k=B.generateSideWallUV(d,e,k-6,k-3,k-2,k-1);t(k[0]);t(k[1]);t(k[3]);t(k[1]);t(k[2]);t(k[3])}}}function k(a,b,c){D.push(a);D.push(b);D.push(c)}function l(a,b,c){u(a);u(b);u(c);a=e.length/3;a=B.generateTopUV(d,e,a-3,a-2,a-1);t(a[0]);t(a[1]);t(a[2])}function u(a){e.push(D[3*a]);e.push(D[3*a+1]);e.push(D[3*a+2])}function t(a){f.push(a.x);f.push(a.y)}var D=[],r=void 0!==b.curveSegments?b.curveSegments:12,y=void 0!==b.steps?
b.steps:1,v=void 0!==b.depth?b.depth:100,N=void 0===b.bevelEnabled||b.bevelEnabled,z=void 0!==b.bevelThickness?b.bevelThickness:6,V=void 0!==b.bevelSize?b.bevelSize:z-2,R=void 0!==b.bevelSegments?b.bevelSegments:3,M=b.extrudePath,B=void 0!==b.UVGenerator?b.UVGenerator:Pk;void 0!==b.amount&&(v=b.amount);var A,E,C,F,L,H,S=!1;M&&(A=M.getSpacedPoints(y),N=!(S=!0),E=M.computeFrenetFrames(y,!1),C=new n,F=new n,L=new n);N||(V=z=R=0);r=a.extractPoints(r);a=r.shape;var J=r.holes;if(!jb.isClockWise(a)){a=a.reverse();
var G=0;for(H=J.length;G<H;G++){var I=J[G];jb.isClockWise(I)&&(J[G]=I.reverse())}}var W=jb.triangulateShape(a,J),U=a;G=0;for(H=J.length;G<H;G++)I=J[G],a=a.concat(I);var P,Q,X,Y=a.length,aa=W.length;r=[];var K=0;var ea=U.length;var Z=ea-1;for(P=K+1;K<ea;K++,Z++,P++)Z===ea&&(Z=0),P===ea&&(P=0),r[K]=g(U[K],U[Z],U[P]);M=[];var da=r.concat();G=0;for(H=J.length;G<H;G++){I=J[G];var ba=[];K=0;Z=(ea=I.length)-1;for(P=K+1;K<ea;K++,Z++,P++)Z===ea&&(Z=0),P===ea&&(P=0),ba[K]=g(I[K],I[Z],I[P]);M.push(ba);da=da.concat(ba)}for(Z=
0;Z<R;Z++){ea=Z/R;var ca=z*Math.cos(ea*Math.PI/2);P=V*Math.sin(ea*Math.PI/2);K=0;for(ea=U.length;K<ea;K++)k((Q=c(U[K],r[K],P)).x,Q.y,-ca);G=0;for(H=J.length;G<H;G++)for(I=J[G],ba=M[G],K=0,ea=I.length;K<ea;K++)k((Q=c(I[K],ba[K],P)).x,Q.y,-ca)}P=V;for(K=0;K<Y;K++)Q=N?c(a[K],da[K],P):a[K],S?(F.copy(E.normals[0]).multiplyScalar(Q.x),C.copy(E.binormals[0]).multiplyScalar(Q.y),L.copy(A[0]).add(F).add(C),k(L.x,L.y,L.z)):k(Q.x,Q.y,0);for(ea=1;ea<=y;ea++)for(K=0;K<Y;K++)Q=N?c(a[K],da[K],P):a[K],S?(F.copy(E.normals[ea]).multiplyScalar(Q.x),
C.copy(E.binormals[ea]).multiplyScalar(Q.y),L.copy(A[ea]).add(F).add(C),k(L.x,L.y,L.z)):k(Q.x,Q.y,v/y*ea);for(Z=R-1;0<=Z;Z--){ea=Z/R;ca=z*Math.cos(ea*Math.PI/2);P=V*Math.sin(ea*Math.PI/2);K=0;for(ea=U.length;K<ea;K++)k((Q=c(U[K],r[K],P)).x,Q.y,v+ca);G=0;for(H=J.length;G<H;G++)for(I=J[G],ba=M[G],K=0,ea=I.length;K<ea;K++)Q=c(I[K],ba[K],P),S?k(Q.x,Q.y+A[y-1].y,A[y-1].x+ca):k(Q.x,Q.y,v+ca)}!function(){var a=e.length/3;if(N){var b=0*Y;for(K=0;K<aa;K++)l((X=W[K])[2]+b,X[1]+b,X[0]+b);b=Y*(y+2*R);for(K=0;K<
aa;K++)l((X=W[K])[0]+b,X[1]+b,X[2]+b)}else{for(K=0;K<aa;K++)l((X=W[K])[2],X[1],X[0]);for(K=0;K<aa;K++)l((X=W[K])[0]+Y*y,X[1]+Y*y,X[2]+Y*y)}d.addGroup(a,e.length/3-a,0)}();(function(){var a=e.length/3,b=0;h(U,b);b+=U.length;G=0;for(H=J.length;G<H;G++)h(I=J[G],b),b+=I.length;d.addGroup(a,e.length/3-a,1)})()}F.call(this);this.type="ExtrudeBufferGeometry";this.parameters={shapes:a,options:b};a=Array.isArray(a)?a:[a];for(var d=this,e=[],f=[],g=0,h=a.length;g<h;g++)c(a[g]);this.addAttribute("position",
new B(e,3));this.addAttribute("uv",new B(f,2));this.computeVertexNormals()}function ii(a,b,c){if(c.shapes=[],Array.isArray(a))for(var d=0,e=a.length;d<e;d++)c.shapes.push(a[d].uuid);else c.shapes.push(a.uuid);return void 0!==b.extrudePath&&(c.options.extrudePath=b.extrudePath.toJSON()),c}function Gd(a,b){J.call(this);this.type="TextGeometry";this.parameters={text:a,parameters:b};this.fromBufferGeometry(new Dc(a,b));this.mergeVertices()}function Dc(a,b){var c=(b=b||{}).font;if(!c||!c.isFont)return new J;
a=c.generateShapes(a,b.size);b.depth=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);$a.call(this,a,b);this.type="TextBufferGeometry"}function Hd(a,b,c,d,e,f,g){J.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};this.fromBufferGeometry(new Sb(a,b,c,d,e,f,g));this.mergeVertices()}function Sb(a,
b,c,d,e,f,g){F.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};a=a||1;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;var h,k,m=(f=void 0!==f?f:0)+(g=void 0!==g?g:Math.PI),q=0,p=[],w=new n,l=new n,u=[],t=[],D=[],r=[];for(k=0;k<=c;k++){var y=[],v=k/c;for(h=0;h<=b;h++){var x=h/b;w.x=-a*Math.cos(d+x*e)*Math.sin(f+v*g);w.y=a*Math.cos(f+v*g);
w.z=a*Math.sin(d+x*e)*Math.sin(f+v*g);t.push(w.x,w.y,w.z);l.set(w.x,w.y,w.z).normalize();D.push(l.x,l.y,l.z);r.push(x,1-v);y.push(q++)}p.push(y)}for(k=0;k<c;k++)for(h=0;h<b;h++)a=p[k][h+1],d=p[k][h],e=p[k+1][h],g=p[k+1][h+1],(0!==k||0<f)&&u.push(a,d,g),(k!==c-1||m<Math.PI)&&u.push(d,e,g);this.setIndex(u);this.addAttribute("position",new B(t,3));this.addAttribute("normal",new B(D,3));this.addAttribute("uv",new B(r,2))}function Id(a,b,c,d,e,f){J.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,
outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};this.fromBufferGeometry(new Ec(a,b,c,d,e,f));this.mergeVertices()}function Ec(a,b,c,d,e,f){F.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};a=a||.5;b=b||1;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;var g,h=[],k=[],m=[],q=[],p=a,l=(b-a)/(d=void 0!==d?Math.max(1,d):1),T=new n,u=new x;for(a=0;a<=d;a++){for(g=
0;g<=c;g++){var t=e+g/c*f;T.x=p*Math.cos(t);T.y=p*Math.sin(t);k.push(T.x,T.y,T.z);m.push(0,0,1);u.x=(T.x/b+1)/2;u.y=(T.y/b+1)/2;q.push(u.x,u.y)}p+=l}for(a=0;a<d;a++)for(b=a*(c+1),g=0;g<c;g++)e=t=g+b,f=t+c+1,p=t+c+2,t+=1,h.push(e,f,t),h.push(f,p,t);this.setIndex(h);this.addAttribute("position",new B(k,3));this.addAttribute("normal",new B(m,3));this.addAttribute("uv",new B(q,2))}function Jd(a,b,c,d){J.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};
this.fromBufferGeometry(new Fc(a,b,c,d));this.mergeVertices()}function Fc(a,b,c,d){F.call(this);this.type="LatheBufferGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=Math.floor(b)||12;c=c||0;d=d||2*Math.PI;d=Q.clamp(d,0,2*Math.PI);var e,f=[],g=[],h=[],k=1/b,m=new n,q=new x;for(e=0;e<=b;e++){var p=c+e*k*d;var l=Math.sin(p),T=Math.cos(p);for(p=0;p<=a.length-1;p++)m.x=a[p].x*l,m.y=a[p].y,m.z=a[p].x*T,g.push(m.x,m.y,m.z),q.x=e/b,q.y=p/(a.length-1),h.push(q.x,q.y)}for(e=0;e<b;e++)for(p=
0;p<a.length-1;p++)k=c=p+e*a.length,m=c+a.length,q=c+a.length+1,c+=1,f.push(k,m,c),f.push(m,q,c);if(this.setIndex(f),this.addAttribute("position",new B(g,3)),this.addAttribute("uv",new B(h,2)),this.computeVertexNormals(),d===2*Math.PI)for(d=this.attributes.normal.array,f=new n,g=new n,h=new n,c=b*a.length*3,p=e=0;e<a.length;e++,p+=3)f.x=d[p+0],f.y=d[p+1],f.z=d[p+2],g.x=d[c+p+0],g.y=d[c+p+1],g.z=d[c+p+2],h.addVectors(f,g).normalize(),d[p+0]=d[c+p+0]=h.x,d[p+1]=d[c+p+1]=h.y,d[p+2]=d[c+p+2]=h.z}function Tb(a,
b){J.call(this);this.type="ShapeGeometry";"object"===l(b)&&(b=b.curveSegments);this.parameters={shapes:a,curveSegments:b};this.fromBufferGeometry(new Ub(a,b));this.mergeVertices()}function Ub(a,b){function c(a){var c,h=e.length/3;a=a.extractPoints(b);var m=a.shape,q=a.holes;if(!1===jb.isClockWise(m))for(m=m.reverse(),a=0,c=q.length;a<c;a++){var l=q[a];!0===jb.isClockWise(l)&&(q[a]=l.reverse())}var n=jb.triangulateShape(m,q);a=0;for(c=q.length;a<c;a++)l=q[a],m=m.concat(l);a=0;for(c=m.length;a<c;a++)l=
m[a],e.push(l.x,l.y,0),f.push(0,0,1),g.push(l.x,l.y);a=0;for(c=n.length;a<c;a++)m=n[a],d.push(m[0]+h,m[1]+h,m[2]+h),k+=3}F.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:a,curveSegments:b};b=b||12;var d=[],e=[],f=[],g=[],h=0,k=0;if(!1===Array.isArray(a))c(a);else for(var m=0;m<a.length;m++)c(a[m]),this.addGroup(h,k,m),h+=k,k=0;this.setIndex(d);this.addAttribute("position",new B(e,3));this.addAttribute("normal",new B(f,3));this.addAttribute("uv",new B(g,2))}function ji(a,b){if(b.shapes=
[],Array.isArray(a))for(var c=0,d=a.length;c<d;c++)b.shapes.push(a[c].uuid);else b.shapes.push(a.uuid);return b}function Gc(a,b){F.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:b};var c,d,e=[];b=Math.cos(Q.DEG2RAD*(void 0!==b?b:1));var f=[0,0],g={},h=["a","b","c"];a.isBufferGeometry?(d=new J).fromBufferGeometry(a):d=a.clone();d.mergeVertices();d.computeFaceNormals();a=d.vertices;d=d.faces;for(var k=0,m=d.length;k<m;k++)for(var q=d[k],p=0;3>p;p++){var l=q[h[p]];var n=q[h[(p+
1)%3]];f[0]=Math.min(l,n);f[1]=Math.max(l,n);void 0===g[c=f[0]+","+f[1]]?g[c]={index1:f[0],index2:f[1],face1:k,face2:void 0}:g[c].face2=k}for(c in g)if(f=g[c],void 0===f.face2||d[f.face1].normal.dot(d[f.face2].normal)<=b)h=a[f.index1],e.push(h.x,h.y,h.z),h=a[f.index2],e.push(h.x,h.y,h.z);this.addAttribute("position",new B(e,3))}function Vb(a,b,c,d,e,f,g,h){J.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,
thetaLength:h};this.fromBufferGeometry(new kb(a,b,c,d,e,f,g,h));this.mergeVertices()}function kb(a,b,c,d,e,f,g,h){function k(c){var e,f=new x,k=new n,w=0,t=!0===c?a:b,y=!0===c?1:-1;var v=u;for(e=1;e<=d;e++)p.push(0,D*y,0),l.push(0,y,0),T.push(.5,.5),u++;var z=u;for(e=0;e<=d;e++){var qa=e/d*h+g,A=Math.cos(qa);qa=Math.sin(qa);k.x=t*qa;k.y=D*y;k.z=t*A;p.push(k.x,k.y,k.z);l.push(0,y,0);f.x=.5*A+.5;f.y=.5*qa*y+.5;T.push(f.x,f.y);u++}for(e=0;e<d;e++)f=v+e,k=z+e,!0===c?q.push(k,k+1,f):q.push(k+1,k,f),w+=
3;m.addGroup(r,w,!0===c?1:2);r+=w}F.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};var m=this;a=void 0!==a?a:1;b=void 0!==b?b:1;c=c||1;d=Math.floor(d)||8;e=Math.floor(e)||1;f=void 0!==f&&f;g=void 0!==g?g:0;h=void 0!==h?h:2*Math.PI;var q=[],p=[],l=[],T=[],u=0,t=[],D=c/2,r=0;!function(){var f,k,w=new n,v=new n,x=0,z=(b-a)/c;for(k=0;k<=e;k++){var qa=[],A=k/e,B=A*(b-a)+a;for(f=
0;f<=d;f++){var E=f/d,C=E*h+g,G=Math.sin(C);C=Math.cos(C);v.x=B*G;v.y=-A*c+D;v.z=B*C;p.push(v.x,v.y,v.z);w.set(G,z,C).normalize();l.push(w.x,w.y,w.z);T.push(E,1-A);qa.push(u++)}t.push(qa)}for(f=0;f<d;f++)for(k=0;k<e;k++)w=t[k+1][f],v=t[k+1][f+1],z=t[k][f+1],q.push(t[k][f],w,z),q.push(w,v,z),x+=6;m.addGroup(r,x,0);r+=x}();!1===f&&(0<a&&k(!0),0<b&&k(!1));this.setIndex(q);this.addAttribute("position",new B(p,3));this.addAttribute("normal",new B(l,3));this.addAttribute("uv",new B(T,2))}function Kd(a,
b,c,d,e,f,g){Vb.call(this,0,a,b,c,d,e,f,g);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function Ld(a,b,c,d,e,f,g){kb.call(this,0,a,b,c,d,e,f,g);this.type="ConeBufferGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function Md(a,b,c,d){J.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};this.fromBufferGeometry(new Hc(a,
b,c,d));this.mergeVertices()}function Hc(a,b,c,d){F.call(this);this.type="CircleBufferGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||1;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;var e,f=[],g=[],h=[],k=[],m=new n,q=new x;g.push(0,0,0);h.push(0,0,1);k.push(.5,.5);var p=0;for(e=3;p<=b;p++,e+=3){var l=c+p/b*d;m.x=a*Math.cos(l);m.y=a*Math.sin(l);g.push(m.x,m.y,m.z);h.push(0,0,1);q.x=(g[e]/a+1)/2;q.y=(g[e+1]/a+1)/2;k.push(q.x,q.y)}for(e=1;e<=
b;e++)f.push(e,e+1,0);this.setIndex(f);this.addAttribute("position",new B(g,3));this.addAttribute("normal",new B(h,3));this.addAttribute("uv",new B(k,2))}function Wb(a){U.call(this);this.type="ShadowMaterial";this.color=new L(0);this.transparent=!0;this.setValues(a)}function Ic(a){Ea.call(this,a);this.type="RawShaderMaterial"}function ab(a){U.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new L(16777215);this.metalness=this.roughness=.5;this.lightMap=this.map=null;
this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new L(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new x(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Xb(a){ab.call(this);this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.clearCoatRoughness=this.clearCoat=0;this.setValues(a)}function Ma(a){U.call(this);this.type="MeshPhongMaterial";this.color=new L(16777215);this.specular=new L(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new L(0);this.emissiveIntensity=
1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new x(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Yb(a){Ma.call(this);
this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(a)}function Zb(a){U.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new x(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1;this.setValues(a)}function $b(a){U.call(this);this.type=
"MeshLambertMaterial";this.color=new L(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new L(0);this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function ac(a){U.call(this);
this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new L(16777215);this.bumpMap=this.map=this.matcap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new x(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.lights=this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function bc(a){aa.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}
function Fa(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==d?d:new b.constructor(c);this.sampleValues=b;this.valueSize=c}function Ke(a,b,c,d){Fa.call(this,a,b,c,d);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Nd(a,b,c,d){Fa.call(this,a,b,c,d)}function Le(a,b,c,d){Fa.call(this,a,b,c,d)}function oa(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+
a);this.name=a;this.times=ca.convertArray(b,this.TimeBufferType);this.values=ca.convertArray(c,this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation)}function Me(a,b,c){oa.call(this,a,b,c)}function Ne(a,b,c,d){oa.call(this,a,b,c,d)}function Jc(a,b,c,d){oa.call(this,a,b,c,d)}function Oe(a,b,c,d){Fa.call(this,a,b,c,d)}function Od(a,b,c,d){oa.call(this,a,b,c,d)}function Pe(a,b,c,d){oa.call(this,a,b,c,d)}function Kc(a,b,c,d){oa.call(this,a,b,c,d)}function Na(a,b,c){this.name=a;this.tracks=
c;this.duration=void 0!==b?b:-1;this.uuid=Q.generateUUID();0>this.duration&&this.resetDuration()}function Qk(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return Jc;case "vector":case "vector2":case "vector3":case "vector4":return Kc;case "color":return Ne;case "quaternion":return Od;case "bool":case "boolean":return Me;case "string":return Pe}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function Rk(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");
var b=Qk(a.type);if(void 0===a.times){var c=[],d=[];ca.flattenJSON(a.keys,c,d,"value");a.times=c;a.values=d}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)}function Of(a,b,c){var d=this,e=!1,f=0,g=0,h=void 0;this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){g++;!1===e&&void 0!==d.onStart&&d.onStart(a,f,g);e=!0};this.itemEnd=function(a){f++;void 0!==d.onProgress&&d.onProgress(a,f,g);f===g&&(e=!1,void 0!==d.onLoad&&d.onLoad())};
this.itemError=function(a){void 0!==d.onError&&d.onError(a)};this.resolveURL=function(a){return h?h(a):a};this.setURLModifier=function(a){return h=a,this}}function Oa(a){this.manager=void 0!==a?a:za}function ki(a){this.manager=void 0!==a?a:za}function li(a){this.manager=void 0!==a?a:za;this._parser=null}function Pf(a){this.manager=void 0!==a?a:za;this._parser=null}function Pd(a){this.manager=void 0!==a?a:za}function Qf(a){this.manager=void 0!==a?a:za}function Qe(a){this.manager=void 0!==a?a:za}function S(){this.type=
"Curve";this.arcLengthDivisions=200}function Ga(a,b,c,d,e,f,g,h){S.call(this);this.type="EllipseCurve";this.aX=a||0;this.aY=b||0;this.xRadius=c||1;this.yRadius=d||1;this.aStartAngle=e||0;this.aEndAngle=f||2*Math.PI;this.aClockwise=g||!1;this.aRotation=h||0}function Lc(a,b,c,d,e,f){Ga.call(this,a,b,c,c,d,e,f);this.type="ArcCurve"}function Rf(){var a=0,b=0,c=0,d=0;return{initCatmullRom:function(e,f,g,h,k){e=k*(g-e);h=k*(h-f);c=-3*(a=f)+3*g-2*(b=e)-h;d=2*f-2*g+e+h},initNonuniformCatmullRom:function(e,
f,g,h,k,m,q){e=((f-e)/k-(g-e)/(k+m)+(g-f)/m)*m;h=((g-f)/m-(h-f)/(m+q)+(h-g)/q)*m;c=-3*(a=f)+3*g-2*(b=e)-h;d=2*f-2*g+e+h},calc:function(e){var f=e*e;return a+b*e+c*f+d*f*e}}}function ra(a,b,c,d){S.call(this);this.type="CatmullRomCurve3";this.points=a||[];this.closed=b||!1;this.curveType=c||"centripetal";this.tension=d||.5}function mi(a,b,c,d,e){b=.5*(d-b);e=.5*(e-c);var f=a*a;return(2*c-2*d+b+e)*a*f+(-3*c+3*d-2*b-e)*f+b*a+c}function Qd(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}function Rd(a,
b,c,d,e){var f=1-a,g=1-a;return f*f*f*b+3*g*g*a*c+3*(1-a)*a*a*d+a*a*a*e}function Pa(a,b,c,d){S.call(this);this.type="CubicBezierCurve";this.v0=a||new x;this.v1=b||new x;this.v2=c||new x;this.v3=d||new x}function bb(a,b,c,d){S.call(this);this.type="CubicBezierCurve3";this.v0=a||new n;this.v1=b||new n;this.v2=c||new n;this.v3=d||new n}function va(a,b){S.call(this);this.type="LineCurve";this.v1=a||new x;this.v2=b||new x}function Qa(a,b){S.call(this);this.type="LineCurve3";this.v1=a||new n;this.v2=b||
new n}function Ra(a,b,c){S.call(this);this.type="QuadraticBezierCurve";this.v0=a||new x;this.v1=b||new x;this.v2=c||new x}function cb(a,b,c){S.call(this);this.type="QuadraticBezierCurve3";this.v0=a||new n;this.v1=b||new n;this.v2=c||new n}function Sa(a){S.call(this);this.type="SplineCurve";this.points=a||[]}function lb(){S.call(this);this.type="CurvePath";this.curves=[];this.autoClose=!1}function Ta(a){lb.call(this);this.type="Path";this.currentPoint=new x;a&&this.setFromPoints(a)}function wb(a){Ta.call(this,
a);this.uuid=Q.generateUUID();this.type="Shape";this.holes=[]}function ia(a,b){E.call(this);this.type="Light";this.color=new L(a);this.intensity=void 0!==b?b:1;this.receiveShadow=void 0}function Re(a,b,c){ia.call(this,a,c);this.type="HemisphereLight";this.castShadow=void 0;this.position.copy(E.DefaultUp);this.updateMatrix();this.groundColor=new L(b)}function cc(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=new x(512,512);this.map=null;this.matrix=new I}function Se(){cc.call(this,new ja(50,
1,.5,500))}function Te(a,b,c,d,e,f){ia.call(this,a,b);this.type="SpotLight";this.position.copy(E.DefaultUp);this.updateMatrix();this.target=new E;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}});this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.penumbra=void 0!==e?e:0;this.decay=void 0!==f?f:1;this.shadow=new Se}function Ue(a,b,c,d){ia.call(this,a,b);this.type="PointLight";Object.defineProperty(this,"power",
{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}});this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1;this.shadow=new cc(new ja(90,1,.5,500))}function Sd(a,b,c,d,e,f){Za.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=void 0!==a?a:-1;this.right=void 0!==b?b:1;this.top=void 0!==c?c:1;this.bottom=void 0!==d?d:-1;this.near=void 0!==e?e:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()}function Ve(){cc.call(this,
new Sd(-5,5,5,-5,.5,500))}function We(a,b){ia.call(this,a,b);this.type="DirectionalLight";this.position.copy(E.DefaultUp);this.updateMatrix();this.target=new E;this.shadow=new Ve}function Xe(a,b){ia.call(this,a,b);this.type="AmbientLight";this.castShadow=void 0}function Ye(a,b,c,d){ia.call(this,a,b);this.type="RectAreaLight";this.width=void 0!==c?c:10;this.height=void 0!==d?d:10}function Ze(a){this.manager=void 0!==a?a:za;this.textures={}}function Sf(a){this.manager=void 0!==a?a:za}function Tf(a){this.manager=
void 0!==a?a:za;this.resourcePath=""}function Uf(a){this.manager=void 0!==a?a:za;this.options=void 0}function Vf(){this.type="ShapePath";this.color=new L;this.subPaths=[];this.currentPath=null}function Wf(a){this.type="Font";this.data=a}function ni(a){this.manager=void 0!==a?a:za}function Td(){}function Xf(a){this.manager=void 0!==a?a:za}function oi(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new ja;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=
new ja;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1}function Ud(a,b,c,d){E.call(this);this.type="CubeCamera";var e=new ja(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new n(1,0,0));this.add(e);var f=new ja(90,1,a,b);f.up.set(0,-1,0);f.lookAt(new n(-1,0,0));this.add(f);var g=new ja(90,1,a,b);g.up.set(0,0,1);g.lookAt(new n(0,1,0));this.add(g);var h=new ja(90,1,a,b);h.up.set(0,0,-1);h.lookAt(new n(0,-1,0));this.add(h);var k=new ja(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new n(0,0,1));this.add(k);
var m=new ja(90,1,a,b);m.up.set(0,-1,0);m.lookAt(new n(0,0,-1));this.add(m);d=d||{format:1022,magFilter:1006,minFilter:1006};this.renderTarget=new jc(c,c,d);this.renderTarget.texture.name="CubeCamera";this.update=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=this.renderTarget,d=c.texture.generateMipmaps;c.texture.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,e,c);c.activeCubeFace=1;a.render(b,f,c);c.activeCubeFace=2;a.render(b,g,c);c.activeCubeFace=3;a.render(b,h,c);c.activeCubeFace=
4;a.render(b,k,c);c.texture.generateMipmaps=d;c.activeCubeFace=5;a.render(b,m,c);a.setRenderTarget(null)};this.clear=function(a,b,c,d){for(var e=this.renderTarget,f=0;6>f;f++)e.activeCubeFace=f,a.setRenderTarget(e),a.clear(b,c,d);a.setRenderTarget(null)}}function Yf(a){this.autoStart=void 0===a||a;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}function Zf(){E.call(this);this.type="AudioListener";this.context=$f.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);
this.filter=null;this.timeDelta=0}function Mc(a){E.call(this);this.type="Audio";this.listener=a;this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=!1;this.buffer=null;this.loop=!1;this.offset=this.startTime=0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.sourceType="empty";this.filters=[]}function ag(a){Mc.call(this,a);this.panner=this.context.createPanner();this.panner.connect(this.gain)}function bg(a,b){this.analyser=
a.context.createAnalyser();this.analyser.fftSize=void 0!==b?b:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}function cg(a,b,c){this.binding=a;this.valueSize=c;a=Float64Array;switch(b){case "quaternion":b=this._slerp;break;case "string":case "bool":a=Array;b=this._select;break;default:b=this._lerp}this.buffer=new a(4*c);this._mixBufferRegion=b;this.referenceCount=this.useCount=this.cumulativeWeight=0}function pi(a,b,c){c=c||ta.parseTrackName(b);
this._targetGroup=a;this._bindings=a.subscribe_(b,c)}function ta(a,b,c){this.path=b;this.parsedPath=c||ta.parseTrackName(b);this.node=ta.findNode(a,this.parsedPath.nodeName)||a;this.rootNode=a}function qi(){this.uuid=Q.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=b;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var d=this;this.stats=
{objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}}function ri(a,b,c){this._mixer=a;this._clip=b;this._localRoot=c||null;a=b.tracks;b=a.length;c=Array(b);for(var d={endingStart:2400,endingEnd:2400},e=0;e!==b;++e){var f=a[e].createInterpolant(null);(c[e]=f).settings=d}this._interpolantSettings=d;this._interpolants=c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=
this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=1/0;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function dg(a){this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}function $e(a,b){"string"==typeof a&&(a=b);this.value=a}function eg(){F.call(this);this.type="InstancedBufferGeometry";
this.maxInstancedCount=void 0}function fg(a,b,c){Ob.call(this,a,b);this.meshPerAttribute=c||1}function gg(a,b,c,d){"number"==typeof c&&(d=c,c=!1);X.call(this,a,b,c);this.meshPerAttribute=d||1}function hg(a,b,c,d){this.ray=new Nb(a,b);this.near=c||0;this.far=d||1/0;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){return this.Points}}})}function si(a,b){return a.distance-b.distance}function ig(a,b,c,d){if(!1!==a.visible&&
(a.raycast(b,c),!0===d)){a=a.children;d=0;for(var e=a.length;d<e;d++)ig(a[d],b,c,!0)}}function ti(a,b,c){return this.radius=void 0!==a?a:1,this.phi=void 0!==b?b:0,this.theta=void 0!==c?c:0,this}function ui(a,b,c){return this.radius=void 0!==a?a:1,this.theta=void 0!==b?b:0,this.y=void 0!==c?c:0,this}function af(a,b){this.min=void 0!==a?a:new x(1/0,1/0);this.max=void 0!==b?b:new x(-1/0,-1/0)}function jg(a,b){this.start=void 0!==a?a:new n;this.end=void 0!==b?b:new n}function Vd(a){E.call(this);this.material=
a;this.render=function(){}}function Wd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16711680;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=3*c.faces.length:c&&c.isBufferGeometry&&(b=c.attributes.normal.count);c=new F;b=new B(6*b,3);c.addAttribute("position",b);ba.call(this,c,new aa({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function Nc(a,b){E.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=
!1;this.color=b;a=new F;b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var c=0,d=1;32>c;c++,d++){var e=c/32*Math.PI*2,f=d/32*Math.PI*2;b.push(Math.cos(e),Math.sin(e),1,Math.cos(f),Math.sin(f),1)}a.addAttribute("position",new B(b,3));b=new aa({fog:!1});this.cone=new ba(a,b);this.add(this.cone);this.update()}function vi(a){var b=[];a&&a.isBone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,vi(a.children[c]));return b}function Oc(a){for(var b=vi(a),c=new F,d=[],
e=[],f=new L(0,0,1),g=new L(0,1,0),h=0;h<b.length;h++){var k=b[h];k.parent&&k.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(f.r,f.g,f.b),e.push(g.r,g.g,g.b))}c.addAttribute("position",new B(d,3));c.addAttribute("color",new B(e,3));d=new aa({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});ba.call(this,c,d);this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}function Pc(a,b,c){this.light=a;this.light.updateMatrixWorld();this.color=c;a=new Sb(b,4,2);b=new Ha({wireframe:!0,
fog:!1});wa.call(this,a,b);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}function Qc(a,b){E.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new aa({fog:!1});b=new F;b.addAttribute("position",new X(new Float32Array(15),3));this.line=new xa(b,a);this.add(this.line);this.update()}function Rc(a,b,c){E.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=
!1;this.color=c;a=new Pb(b);a.rotateY(.5*Math.PI);this.material=new Ha({wireframe:!0,fog:!1});void 0===this.color&&(this.material.vertexColors=2);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.addAttribute("color",new X(b,3));this.add(new wa(a,this.material));this.update()}function Xd(a,b,c,d){a=a||10;b=b||10;c=new L(void 0!==c?c:4473924);d=new L(void 0!==d?d:8947848);var e=b/2,f=a/b,g=a/2;a=[];for(var h=[],k=0,m=0,q=-g;k<=b;k++,q+=f){a.push(-g,0,q,g,0,q);a.push(q,0,-g,q,0,g);var p=
k===e?c:d;p.toArray(h,m);m+=3;p.toArray(h,m);m+=3;p.toArray(h,m);m+=3;p.toArray(h,m);m+=3}b=new F;b.addAttribute("position",new B(a,3));b.addAttribute("color",new B(h,3));c=new aa({vertexColors:2});ba.call(this,b,c)}function bf(a,b,c,d,e,f){a=a||10;b=b||16;c=c||8;d=d||64;e=new L(void 0!==e?e:4473924);f=new L(void 0!==f?f:8947848);var g,h=[],k=[];for(g=0;g<=b;g++){var m=g/b*2*Math.PI;var q=Math.sin(m)*a;m=Math.cos(m)*a;h.push(0,0,0);h.push(q,0,m);var p=1&g?e:f;k.push(p.r,p.g,p.b);k.push(p.r,p.g,p.b)}for(g=
0;g<=c;g++){p=1&g?e:f;var l=a-a/c*g;for(b=0;b<d;b++)m=b/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,h.push(q,0,m),k.push(p.r,p.g,p.b),m=(b+1)/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,h.push(q,0,m),k.push(p.r,p.g,p.b)}a=new F;a.addAttribute("position",new B(h,3));a.addAttribute("color",new B(k,3));h=new aa({vertexColors:2});ba.call(this,a,h)}function Yd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry&&(b=c.faces.length);
c=new F;b=new B(6*b,3);c.addAttribute("position",b);ba.call(this,c,new aa({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function Sc(a,b,c){E.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;void 0===b&&(b=1);a=new F;a.addAttribute("position",new B([-b,b,0,b,b,0,b,-b,0,-b,-b,0,-b,b,0],3));b=new aa({fog:!1});this.lightPlane=new xa(a,b);this.add(this.lightPlane);(a=new F).addAttribute("position",new B([0,0,0,0,0,1],
3));this.targetLine=new xa(a,b);this.add(this.targetLine);this.update()}function Zd(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){f.push(0,0,0);g.push(b.r,b.g,b.b);void 0===h[a]&&(h[a]=[]);h[a].push(f.length/3-1)}var d=new F,e=new aa({color:16777215,vertexColors:1}),f=[],g=[],h={},k=new L(16755200),m=new L(16711680),q=new L(43775),p=new L(16777215),l=new L(3355443);b("n1","n2",k);b("n2","n4",k);b("n4","n3",k);b("n3","n1",k);b("f1","f2",k);b("f2","f4",k);b("f4","f3",k);b("f3","f1",k);b("n1","f1",
k);b("n2","f2",k);b("n3","f3",k);b("n4","f4",k);b("p","n1",m);b("p","n2",m);b("p","n3",m);b("p","n4",m);b("u1","u2",q);b("u2","u3",q);b("u3","u1",q);b("c","t",p);b("p","c",l);b("cn1","cn2",l);b("cn3","cn4",l);b("cf1","cf2",l);b("cf3","cf4",l);d.addAttribute("position",new B(f,3));d.addAttribute("color",new B(g,3));ba.call(this,d,e);this.camera=a;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=h;this.update()}
function mb(a,b){this.object=a;void 0===b&&(b=16776960);a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new Float32Array(24),d=new F;d.setIndex(new X(a,1));d.addAttribute("position",new X(c,3));ba.call(this,d,new aa({color:b}));this.matrixAutoUpdate=!1;this.update()}function $d(a,b){this.type="Box3Helper";this.box=a;a=void 0!==b?b:16776960;b=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new F;c.setIndex(new X(b,1));c.addAttribute("position",new B([1,
1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));ba.call(this,c,new aa({color:a}));this.geometry.computeBoundingSphere()}function ae(a,b,c){this.type="PlaneHelper";this.plane=a;this.size=void 0===b?1:b;a=void 0!==c?c:16776960;b=new F;b.addAttribute("position",new B([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));b.computeBoundingSphere();xa.call(this,b,new aa({color:a}));b=new F;b.addAttribute("position",new B([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));
b.computeBoundingSphere();this.add(new wa(b,new Ha({color:a,opacity:.2,transparent:!0,depthWrite:!1})))}function nb(a,b,c,d,e,f){E.call(this);void 0===a&&(a=new THREE.Vector3(0,0,1));void 0===b&&(b=new THREE.Vector3(0,0,0));void 0===c&&(c=1);void 0===d&&(d=16776960);void 0===e&&(e=.2*c);void 0===f&&(f=.2*e);void 0===kg&&((kg=new F).addAttribute("position",new B([0,0,0,0,1,0],3)),(wi=new kb(0,.5,1,5,1)).translate(0,-.5,0));this.position.copy(b);this.line=new xa(kg,new aa({color:d}));this.line.matrixAutoUpdate=
!1;this.add(this.line);this.cone=new wa(wi,new Ha({color:d}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,e,f)}function be(a){var b=[0,0,0,a=a||1,0,0,0,0,0,0,a,0,0,0,0,0,0,a];a=new F;a.addAttribute("position",new B(b,3));a.addAttribute("color",new B([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));b=new aa({vertexColors:2});ba.call(this,a,b)}function xi(a){ra.call(this,a);this.type="catmullrom";this.closed=!0}function yi(a){ra.call(this,a);this.type="catmullrom"}
function lg(a){ra.call(this,a);this.type="catmullrom"}function zi(a){var b=new Map;Object.assign(a.prototype,{on:function(a,d){var c=b.get(this);c||(c=new Map,b.set(this,c));var f=function(a){return d(a.message)};c.set(d,f);this.addEventListener(a,f)},off:function(a,d){var c=b.get(this);if(c){var f=c.get(d);f&&(c.delete(d),this.removeEventListener(a,f))}}})}function Sk(a,b){a.control.changeViewMode(b);(function e(a){a.onViewModeChange&&a.onViewModeChange(b);a.children&&0<a.children.length&&a.children.forEach(function(a){return e(a)})})(a.building.object3D)}
function Tk(a){a.$mapWrapper=document.createElement("div");a.$mapWrapper.style.overflow="hidden";a.$mapWrapper.style.width="100%";a.$mapWrapper.style.height="100%";a.$wrapper.appendChild(a.$mapWrapper);a.$overlayWrapper=document.createElement("div");a.$overlayWrapper.className="imap-overlays";a.$wrapper.appendChild(a.$overlayWrapper);a.$controlWrapper=document.createElement("div");a.$controlWrapper.className="imap-controls";a.$wrapper.appendChild(a.$controlWrapper)}function Uk(a){var b=a.$wrapper.clientWidth,
c=a.$wrapper.clientHeight;a._canvasScale=Math.round(c/Math.sin(20/180*Math.PI));a._scene=new A.Scene;a._camera=new A.PerspectiveCamera(20,b/c,140,1E5);var d=new A.AmbientLight(7631988);a._scene.add(d);(d=new A.DirectionalLight(11382189,1.2)).position.set(4E3,4E3,4E3).normalize();d.target.position.set(0,0,0);a._scene.add(d);(d=new A.DirectionalLight(3355443)).position.set(-4E3,2E3,-4E3).normalize();a._scene.add(d);a.renderer=new A.WebGLRenderer({antialias:!0});a.renderer.autoClear=!1;a.renderer.setClearColor("#ffffff");
a.renderer.setSize(b,c);d=a.renderer.domElement;a.$mapWrapper.appendChild(d);d.style.width="100%";d.style.height="100%";d.style.opacity=0;b/=2;c/=2;a.viewportMatrix.set(b,0,0,b,0,-c,0,c)}function Vk(a){Tk(a);Uk(a);Ai(window,"resize",function(){var b=a.$wrapper.clientWidth,c=a.$wrapper.clientHeight;a._canvasScale=Math.round(c/Math.sin(20/180*Math.PI));a._camera.aspect=b/c;a._camera.updateProjectionMatrix();a.renderer.setSize(b,c);b/=2;c/=2;a.viewportMatrix.set(b,0,0,b,0,-c,0,c);a.updateProjectionMatrix=
!0})}function cf(a){this.options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};var b=document.createElement("canvas"),c=new Z(b);c.minFilter=1006;this.texture=c;this.canvas=b;b=new ib({map:c,sizeAttenuation:!1,transparent:!0,alphaTest:.1});vb.call(this,b);this.type="Label";this.boundBox=new af;this.worldScale=new n;this.setText(a)}function Bi(a){a.building&&a.building.updateBound(a);Array.from(a._overlays).filter(function(a){return a.isHTMLOverlay}).map(function(b){return{overlay:b,position:a.locationToViewport(b.location)}}).sort(function(a,
c){return c.position.distance-a.position.distance}).forEach(function(a,c){a.overlay.render({x:a.position.x,y:a.position.y,zIndex:c+10})})}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Number.isInteger&&(Number.isInteger=function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a});void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});0=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});
void 0===Object.assign&&(Object.assign=function(a){if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(null!=d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])}return b});Object.assign(Ja.prototype,{addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,
b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&(!b||-1!==c[a].indexOf(b))},removeEventListener:function(a,b){void 0!==this._listeners&&(a=this._listeners[a],void 0!==a&&(b=a.indexOf(b),-1!==b&&a.splice(b,1)))},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;b=b.slice(0);for(var c=0,d=b.length;c<d;c++)b[c].call(this,a)}}}});var Q={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var a=
[],b=0;256>b;b++)a[b]=(16>b?"0":"")+b.toString(16);return function(){var b=4294967295*Math.random()|0,d=4294967295*Math.random()|0,e=4294967295*Math.random()|0,f=4294967295*Math.random()|0;return(a[255&b]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]+"-"+a[255&d]+a[d>>8&255]+"-"+a[d>>16&15|64]+a[d>>24&255]+"-"+a[63&e|128]+a[e>>8&255]+"-"+a[e>>16&255]+a[e>>24&255]+a[255&f]+a[f>>8&255]+a[f>>16&255]+a[f>>24&255]).toUpperCase()}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(a,
b){return(a%b+b)%b},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},lerp:function(a,b,c){return(1-c)*a+c*b},smoothstep:function(a,b,c){return a<=b?0:c<=a?1:(a=(a-b)/(c-b))*a*(3-2*a)},smootherstep:function(a,b,c){return a<=b?0:c<=a?1:(a=(a-b)/(c-b))*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(a){return a*Q.DEG2RAD},radToDeg:function(a){return a*
Q.RAD2DEG},isPowerOfTwo:function(a){return 0==(a&a-1)&&0!==a},ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}},mg,ng,df,fa,xb,ob,ce,pa,Ci,Di,ef,og,pb,Ei,pg,qg,rg,Fi,Gi,Hi,yb,Tc;Object.defineProperties(x.prototype,{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}});Object.assign(x.prototype,{isVector2:!0,set:function(a,
b){return this.x=a,this.y=b,this},setScalar:function(a){return this.x=a,this.y=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){return this.x=
a.x,this.y=a.y,this},add:function(a,b){return void 0!==b?this.addVectors(a,b):(this.x+=a.x,this.y+=a.y,this)},addScalar:function(a){return this.x+=a,this.y+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this},sub:function(a,b){return void 0!==b?this.subVectors(a,b):(this.x-=a.x,this.y-=a.y,this)},subScalar:function(a){return this.x-=a,this.y-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=
a.y-b.y,this},multiply:function(a){return this.x*=a.x,this.y*=a.y,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this},divide:function(a){return this.x/=a.x,this.y/=a.y,this},divideScalar:function(a){return this.multiplyScalar(1/a)},applyMatrix3:function(a){var b=this.x,c=this.y;a=a.elements;return this.x=a[0]*b+a[3]*c+a[6],this.y=a[1]*b+a[4]*c+a[7],this},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this},max:function(a){return this.x=Math.max(this.x,
a.x),this.y=Math.max(this.y,a.y),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this},clampScalar:(mg=new x,ng=new x,function(a,b){return mg.set(a,a),ng.set(b,b),this.clamp(mg,ng)}),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),
this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(a){return this.x*a.x+this.y*a.y},cross:function(a){return this.x*a.y-this.y*a.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var a=Math.atan2(this.y,this.x);return 0>a&&(a+=2*Math.PI),a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},setLength:function(a){return this.normalize().multiplyScalar(a)},
lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a},fromBufferAttribute:function(a,b,c){return this.x=a.getX(b),this.y=a.getY(b),this},rotateAround:function(a,b){var c=
Math.cos(b);b=Math.sin(b);var d=this.x-a.x,e=this.y-a.y;return this.x=d*c-e*b+a.x,this.y=d*b+e*c+a.y,this}});Object.assign(I.prototype,{isMatrix4:!0,set:function(a,b,c,d,e,f,g,h,k,m,q,p,l,n,u,t){var w=this.elements;return w[0]=a,w[4]=b,w[8]=c,w[12]=d,w[1]=e,w[5]=f,w[9]=g,w[13]=h,w[2]=k,w[6]=m,w[10]=q,w[14]=p,w[3]=l,w[7]=n,w[11]=u,w[15]=t,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new I).fromArray(this.elements)},copy:function(a){var b=
this.elements;a=a.elements;return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],this},copyPosition:function(a){var b=this.elements;a=a.elements;return b[12]=a[12],b[13]=a[13],b[14]=a[14],this},extractBasis:function(a,b,c){return a.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),c.setFromMatrixColumn(this,2),this},makeBasis:function(a,b,c){return this.set(a.x,b.x,
c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this},extractRotation:(ef=new n,function(a){var b=this.elements,c=a.elements,d=1/ef.setFromMatrixColumn(a,0).length(),e=1/ef.setFromMatrixColumn(a,1).length();a=1/ef.setFromMatrixColumn(a,2).length();return b[0]=c[0]*d,b[1]=c[1]*d,b[2]=c[2]*d,b[3]=0,b[4]=c[4]*e,b[5]=c[5]*e,b[6]=c[6]*e,b[7]=0,b[8]=c[8]*a,b[9]=c[9]*a,b[10]=c[10]*a,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}),makeRotationFromEuler:function(a){!a||a.isEuler;var b=this.elements,c=a.x,d=a.y,
e=a.z,f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);var h=Math.cos(e);e=Math.sin(e);if("XYZ"===a.order){a=f*h;var k=f*e,m=c*h,q=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=k+m*d;b[5]=a-q*d;b[9]=-c*g;b[2]=q-a*d;b[6]=m+k*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a+q*c,b[4]=m*c-k,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=k*c-m,b[6]=q+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a-q*c,b[4]=-f*e,b[8]=m+k*c,b[1]=k+m*c,b[5]=f*h,b[9]=q-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):
"ZYX"===a.order?(a=f*h,k=f*e,m=c*h,q=c*e,b[0]=g*h,b[4]=m*d-k,b[8]=a*d+q,b[1]=g*e,b[5]=q*d+a,b[9]=k*d-m,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===a.order?(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=q-a*e,b[8]=m*e+k,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=k*e+m,b[10]=a-q*e):"XZY"===a.order&&(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+q,b[5]=f*h,b[9]=k*e-m,b[2]=m*e-k,b[6]=c*h,b[10]=q*e+a);return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},makeRotationFromQuaternion:(Ci=new n(0,
0,0),Di=new n(1,1,1),function(a){return this.compose(Ci,a,Di)}),lookAt:(ob=new n,ce=new n,pa=new n,function(a,b,c){var d=this.elements;return pa.subVectors(a,b),0===pa.lengthSq()&&(pa.z=1),pa.normalize(),ob.crossVectors(c,pa),0===ob.lengthSq()&&(1===Math.abs(c.z)?pa.x+=1E-4:pa.z+=1E-4,pa.normalize(),ob.crossVectors(c,pa)),ob.normalize(),ce.crossVectors(pa,ob),d[0]=ob.x,d[4]=ce.x,d[8]=pa.x,d[1]=ob.y,d[5]=ce.y,d[9]=pa.y,d[2]=ob.z,d[6]=ce.z,d[10]=pa.z,this}),multiply:function(a,b){return void 0!==b?
this.multiplyMatrices(a,b):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[4],f=c[8],g=c[12],h=c[1],k=c[5],m=c[9],q=c[13],p=c[2],l=c[6],n=c[10],u=c[14],t=c[3],v=c[7],r=c[11];c=c[15];var y=d[0],x=d[4],N=d[8],z=d[12],V=d[1],A=d[5],B=d[9],C=d[13],E=d[2],G=d[6],F=d[10],J=d[14],H=d[3],I=d[7],L=d[11];d=d[15];return b[0]=a*y+e*V+f*E+g*H,b[4]=a*x+e*A+f*G+g*I,b[8]=a*N+e*
B+f*F+g*L,b[12]=a*z+e*C+f*J+g*d,b[1]=h*y+k*V+m*E+q*H,b[5]=h*x+k*A+m*G+q*I,b[9]=h*N+k*B+m*F+q*L,b[13]=h*z+k*C+m*J+q*d,b[2]=p*y+l*V+n*E+u*H,b[6]=p*x+l*A+n*G+u*I,b[10]=p*N+l*B+n*F+u*L,b[14]=p*z+l*C+n*J+u*d,b[3]=t*y+v*V+r*E+c*H,b[7]=t*x+v*A+r*G+c*I,b[11]=t*N+v*B+r*F+c*L,b[15]=t*z+v*C+r*J+c*d,this},multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},applyToBufferAttribute:(xb=
new n,function(a){for(var b=0,c=a.count;b<c;b++)xb.x=a.getX(b),xb.y=a.getY(b),xb.z=a.getZ(b),xb.applyMatrix4(this),a.setXYZ(b,xb.x,xb.y,xb.z);return a}),determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],m=a[2],q=a[6],p=a[10],l=a[14];return a[3]*(+e*h*q-d*k*q-e*g*p+c*k*p+d*g*l-c*h*l)+a[7]*(+b*h*l-b*k*p+e*f*p-d*f*l+d*k*m-e*h*m)+a[11]*(+b*k*q-b*g*l-e*f*q+c*f*l+e*g*m-c*k*m)+a[15]*(-d*g*m-b*h*q+b*g*p+d*f*q-c*f*p+c*h*m)},transpose:function(){var a,b=this.elements;
return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},getInverse:function(a,b){var c=this.elements,d=a.elements;a=d[0];var e=d[1],f=d[2],g=d[3],h=d[4],k=d[5],m=d[6],q=d[7],p=d[8],l=d[9],n=d[10],u=d[11],t=d[12],v=d[13],r=d[14];d=d[15];var y=l*r*q-v*n*q+v*m*u-k*r*u-l*m*d+k*n*d,x=t*n*q-p*r*q-t*m*u+h*r*u+p*
m*d-h*n*d,N=p*v*q-t*l*q+t*k*u-h*v*u-p*k*d+h*l*d,z=t*l*m-p*v*m-t*k*n+h*v*n+p*k*r-h*l*r,A=a*y+e*x+f*N+g*z;if(0===A){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/A;return c[0]=y*b,c[1]=(v*n*g-l*r*g-v*f*u+e*r*u+l*f*d-e*n*d)*b,c[2]=(k*r*g-v*m*g+v*f*q-e*r*q-k*f*d+e*m*d)*b,c[3]=(l*m*g-k*n*g-l*f*q+e*n*q+k*f*u-e*m*u)*b,c[4]=x*b,c[5]=(p*r*g-t*n*g+t*f*u-a*r*u-p*f*d+a*n*d)*b,c[6]=(t*m*g-h*r*g-t*f*q+a*r*q+h*f*d-a*m*d)*b,c[7]=(h*n*g-p*m*
g+p*f*q-a*n*q-h*f*u+a*m*u)*b,c[8]=N*b,c[9]=(t*l*g-p*v*g-t*e*u+a*v*u+p*e*d-a*l*d)*b,c[10]=(h*v*g-t*k*g+t*e*q-a*v*q-h*e*d+a*k*d)*b,c[11]=(p*k*g-h*l*g-p*e*q+a*l*q+h*e*u-a*k*u)*b,c[12]=z*b,c[13]=(p*v*f-t*l*f+t*e*n-a*v*n-p*e*r+a*l*r)*b,c[14]=(t*k*f-h*v*f-t*e*m+a*v*m+h*e*r-a*k*r)*b,c[15]=(h*l*f-p*k*f+p*e*m-a*l*m-h*e*n+a*k*n)*b,this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;return b[0]*=c,b[4]*=d,b[8]*=a,b[1]*=c,b[5]*=d,b[9]*=a,b[2]*=c,b[6]*=d,b[10]*=a,b[3]*=c,b[7]*=d,b[11]*=a,this},getMaxScaleOnAxis:function(){var a=
this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);return this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1),this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);return this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1),this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);
return this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=1-c,e=a.x,f=a.y;a=a.z;var g=d*e,h=d*f;return this.set(g*e+c,g*f-b*a,g*a+b*f,0,g*f+b*a,h*f+c,h*a-b*e,0,g*a-b*f,h*a+b*e,d*a*a+c,0,0,0,0,1),this},makeScale:function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},makeShear:function(a,b,c){return this.set(1,b,c,0,a,1,c,0,a,b,1,0,0,0,0,1),this},compose:function(a,b,c){var d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,
k=e+e,m=f+f,q=g+g;b=e*k;var l=e*m;e*=q;var w=f*m;f*=q;g*=q;k*=h;m*=h;h*=q;q=c.x;var n=c.y;c=c.z;return d[0]=(1-(w+g))*q,d[1]=(l+h)*q,d[2]=(e-m)*q,d[3]=0,d[4]=(l-h)*n,d[5]=(1-(b+g))*n,d[6]=(f+k)*n,d[7]=0,d[8]=(e+m)*c,d[9]=(f-k)*c,d[10]=(1-(b+w))*c,d[11]=0,d[12]=a.x,d[13]=a.y,d[14]=a.z,d[15]=1,this},decompose:(df=new n,fa=new I,function(a,b,c){var d=this.elements,e=df.set(d[0],d[1],d[2]).length(),f=df.set(d[4],d[5],d[6]).length(),g=df.set(d[8],d[9],d[10]).length();0>this.determinant()&&(e=-e);a.x=d[12];
a.y=d[13];a.z=d[14];fa.copy(this);a=1/e;d=1/f;var h=1/g;return fa.elements[0]*=a,fa.elements[1]*=a,fa.elements[2]*=a,fa.elements[4]*=d,fa.elements[5]*=d,fa.elements[6]*=d,fa.elements[8]*=h,fa.elements[9]*=h,fa.elements[10]*=h,b.setFromRotationMatrix(fa),c.x=e,c.y=f,c.z=g,this}),makePerspective:function(a,b,c,d,e,f){var g=this.elements;return g[0]=2*e/(b-a),g[4]=0,g[8]=(b+a)/(b-a),g[12]=0,g[1]=0,g[5]=2*e/(c-d),g[9]=(c+d)/(c-d),g[13]=0,g[2]=0,g[6]=0,g[10]=-(f+e)/(f-e),g[14]=-2*f*e/(f-e),g[3]=0,g[7]=
0,g[11]=-1,g[15]=0,this},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=1/(b-a),k=1/(c-d),m=1/(f-e);return g[0]=2*h,g[4]=0,g[8]=0,g[12]=-((b+a)*h),g[1]=0,g[5]=2*k,g[9]=0,g[13]=-((c+d)*k),g[2]=0,g[6]=0,g[10]=-2*m,g[14]=-((f+e)*m),g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,
b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a}});Object.assign(la,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],k=c[d+1],m=c[d+2];c=c[d+3];d=e[f+0];var q=e[f+1],l=e[f+2];e=e[f+3];if(c!==e||h!==d||k!==q||m!==l){f=1-g;var w=
h*d+k*q+m*l+c*e,n=0<=w?1:-1,u=1-w*w;u>Number.EPSILON&&(u=Math.sqrt(u),w=Math.atan2(u,w*n),f=Math.sin(f*w)/u,g=Math.sin(g*w)/u);n*=g;if(h=h*f+d*n,k=k*f+q*n,m=m*f+l*n,c=c*f+e*n,f===1-g)g=1/Math.sqrt(h*h+k*k+m*m+c*c),h*=g,k*=g,m*=g,c*=g}a[b]=h;a[b+1]=k;a[b+2]=m;a[b+3]=c}});Object.defineProperties(la.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},
set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a;this.onChangeCallback()}}});Object.assign(la.prototype,{isQuaternion:!0,set:function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this.onChangeCallback(),this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
var c=a._x,d=a._y,e=a._z;a=a.order;var f=Math.cos,g=Math.sin,h=f(c/2),k=f(d/2);f=f(e/2);c=g(c/2);d=g(d/2);e=g(e/2);return"XYZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"YXZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"ZXY"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"ZYX"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"YZX"===a?(this._x=
c*k*f+h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f-c*d*e):"XZY"===a&&(this._x=c*k*f-h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f+c*d*e),!1!==b&&this.onChangeCallback(),this},setFromAxisAngle:function(a,b){b/=2;var c=Math.sin(b);return this._x=a.x*c,this._y=a.y*c,this._z=a.z*c,this._w=Math.cos(b),this.onChangeCallback(),this},setFromRotationMatrix:function(a){var b,c=a.elements;a=c[0];var d=c[4],e=c[8],f=c[1],g=c[5],h=c[9],k=c[2],m=c[6];c=c[10];var q=a+g+c;return this._z=
0<q?(b=.5/Math.sqrt(q+1),this._w=.25/b,this._x=(m-h)*b,this._y=(e-k)*b,(f-d)*b):g<a&&c<a?(b=2*Math.sqrt(1+a-g-c),this._w=(m-h)/b,this._x=.25*b,this._y=(d+f)/b,(e+k)/b):c<g?(b=2*Math.sqrt(1+g-a-c),this._w=(e-k)/b,this._x=(d+f)/b,this._y=.25*b,(h+m)/b):(b=2*Math.sqrt(1+c-a-g),this._w=(f-d)/b,this._x=(e+k)/b,this._y=(h+m)/b,.25*b),this.onChangeCallback(),this},setFromUnitVectors:(pb=new n,function(a,b){return void 0===pb&&(pb=new n),1E-6>(og=a.dot(b)+1)?(og=0,Math.abs(a.x)>Math.abs(a.z)?pb.set(-a.y,
a.x,0):pb.set(0,-a.z,a.y)):pb.crossVectors(a,b),this._x=pb.x,this._y=pb.y,this._z=pb.z,this._w=og,this.normalize()}),angleTo:function(a){return 2*Math.acos(Math.abs(Q.clamp(this.dot(a),-1,1)))},rotateTowards:function(a,b){var c=this.angleTo(a);return 0===c?this:(this.slerp(a,Math.min(1,b/c)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*
a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();return this._w=0===a?(this._x=0,this._y=0,this._z=0,1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*a),this.onChangeCallback(),this},multiply:function(a,b){return void 0!==b?this.multiplyQuaternions(a,b):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,
this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z;a=a._w;var f=b._x,g=b._y,h=b._z;b=b._w;return this._x=c*b+a*f+d*h-e*g,this._y=d*b+a*g+e*f-c*h,this._z=e*b+a*h+c*g-d*f,this._w=a*b-c*f-d*g-e*h,this.onChangeCallback(),this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),1<=g)return this._w=f,this._x=c,this._y=
d,this._z=e,this;a=1-g*g;if(a<=Number.EPSILON)return g=1-b,this._w=g*f+b*this._w,this._x=g*c+b*this._x,this._y=g*d+b*this._y,this._z=g*e+b*this._z,this.normalize();a=Math.sqrt(a);var h=Math.atan2(a,g);g=Math.sin((1-b)*h)/a;b=Math.sin(b*h)/a;return this._w=f*g+this._w*b,this._x=c*g+this._x*b,this._y=d*g+this._y*b,this._z=e*g+this._z*b,this.onChangeCallback(),this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){return void 0===b&&(b=
0),this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this.onChangeCallback(),this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a},onChange:function(a){return this.onChangeCallback=a,this},onChangeCallback:function(){}});Object.assign(n.prototype,{isVector3:!0,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setScalar:function(a){return this.x=a,this.y=a,this.z=a,this},setX:function(a){return this.x=
a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){return this.x=
a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return void 0!==b?this.addVectors(a,b):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this},sub:function(a,b){return void 0!==b?this.subVectors(a,b):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},subScalar:function(a){return this.x-=
a,this.y-=a,this.z-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a,b){return void 0!==b?this.multiplyVectors(a,b):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},applyEuler:(Hi=new la,function(a){return!a||a.isEuler,this.applyQuaternion(Hi.setFromEuler(a))}),applyAxisAngle:(Gi=new la,
function(a,b){return this.applyQuaternion(Gi.setFromAxisAngle(a,b))}),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;return this.x=a[0]*b+a[3]*c+a[6]*d,this.y=a[1]*b+a[4]*c+a[7]*d,this.z=a[2]*b+a[5]*c+a[8]*d,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);return this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e,this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e,this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e,this},applyQuaternion:function(a){var b=
this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,m=a*d+e*c-f*b;b=-e*b-f*c-g*d;return this.x=h*a+b*-e+k*-g-m*-f,this.y=k*a+b*-f+m*-e-h*-g,this.z=m*a+b*-g+h*-f-k*-e,this},project:function(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)},unproject:(Fi=new I,function(a){return this.applyMatrix4(Fi.getInverse(a.projectionMatrix)).applyMatrix4(a.matrixWorld)}),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;return this.x=
a[0]*b+a[4]*c+a[8]*d,this.y=a[1]*b+a[5]*c+a[9]*d,this.z=a[2]*b+a[6]*c+a[10]*d,this.normalize()},divide:function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,
this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this},clampScalar:(qg=new n,rg=new n,function(a,b){return qg.set(a,a,a),rg.set(b,b,b),this.clamp(qg,rg)}),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=
Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+
this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},
cross:function(a,b){return void 0!==b?this.crossVectors(a,b):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y;a=a.z;var e=b.x,f=b.y;b=b.z;return this.x=d*b-a*f,this.y=a*e-c*b,this.z=c*f-d*e,this},projectOnVector:function(a){var b=a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:(pg=new n,function(a){return pg.copy(this).projectOnVector(a),this.sub(pg)}),reflect:(Ei=new n,function(a){return this.sub(Ei.copy(a).multiplyScalar(2*this.dot(a)))}),angleTo:function(a){a=
this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(Q.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)},setFromSphericalCoords:function(a,b,c){var d=Math.sin(b)*a;return this.x=
d*Math.sin(c),this.y=Math.cos(b)*a,this.z=d*Math.cos(c),this},setFromCylindrical:function(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)},setFromCylindricalCoords:function(a,b,c){return this.x=a*Math.sin(b),this.y=c,this.z=a*Math.cos(b),this},setFromMatrixPosition:function(a){a=a.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,
2).length();return this.x=b,this.y=c,this.z=a,this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a},fromBufferAttribute:function(a,b,c){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this}});Object.assign(ua.prototype,
{isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,k){var m=this.elements;return m[0]=a,m[1]=d,m[2]=g,m[3]=b,m[4]=e,m[5]=h,m[6]=c,m[7]=f,m[8]=k,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],this},setFromMatrix4:function(a){a=a.elements;return this.set(a[0],a[4],a[8],a[1],
a[5],a[9],a[2],a[6],a[10]),this},applyToBufferAttribute:(yb=new n,function(a){for(var b=0,c=a.count;b<c;b++)yb.x=a.getX(b),yb.y=a.getY(b),yb.z=a.getZ(b),yb.applyMatrix3(this),a.setXYZ(b,yb.x,yb.y,yb.z);return a}),multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[3],f=c[6],g=c[1],h=c[4],k=c[7],m=c[2],q=c[5];c=c[8];var l=d[0],w=d[3],n=d[6],
u=d[1],t=d[4],v=d[7],r=d[2],y=d[5];d=d[8];return b[0]=a*l+e*u+f*r,b[3]=a*w+e*t+f*y,b[6]=a*n+e*v+f*d,b[1]=g*l+h*u+k*r,b[4]=g*w+h*t+k*y,b[7]=g*n+h*v+k*d,b[2]=m*l+q*u+c*r,b[5]=m*w+q*t+c*y,b[8]=m*n+q*v+c*d,this},multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7];a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-d*f*h},getInverse:function(a,
b){a&&a.isMatrix4;var c=a.elements;a=this.elements;var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],m=c[6],q=c[7];c=c[8];var l=c*h-k*q,n=k*m-c*g,v=q*g-h*m,u=d*l+e*n+f*v;if(0===u){if(!0===b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/u;return a[0]=l*b,a[1]=(f*q-c*e)*b,a[2]=(k*e-f*h)*b,a[3]=n*b,a[4]=(c*d-f*m)*b,a[5]=(f*g-k*d)*b,a[6]=v*b,a[7]=(e*m-q*d)*b,a[8]=(h*d-e*g)*b,this},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=
b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this},setUvTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e);e=Math.sin(e);this.set(c*h,c*e,-c*(h*f+e*g)+f+a,-d*e,d*h,-d*(-e*f+h*g)+g+b,0,0,1)},scale:function(a,b){var c=this.elements;return c[0]*=
a,c[3]*=a,c[6]*=a,c[1]*=b,c[4]*=b,c[7]*=b,this},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],k=c[7];return c[0]=b*d+a*g,c[3]=b*e+a*h,c[6]=b*f+a*k,c[1]=-a*d+b*g,c[4]=-a*e+b*h,c[7]=-a*f+b*k,this},translate:function(a,b){var c=this.elements;return c[0]+=a*c[2],c[3]+=a*c[5],c[6]+=a*c[8],c[1]+=b*c[2],c[4]+=b*c[5],c[7]+=b*c[8],this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,
b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a}});var zb={getDataURL:function(a){if("undefined"==typeof HTMLCanvasElement)return a.src;if(!(a instanceof HTMLCanvasElement)){void 0===Tc&&(Tc=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"));Tc.width=a.width;Tc.height=
a.height;var b=Tc.getContext("2d");a instanceof ImageData?b.putImageData(a,0,0):b.drawImage(a,0,0,a.width,a.height);a=Tc}return 2048<a.width||2048<a.height?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png")}},Dj=0,ff,sg,db,Ii,Ji,tg,Ki,Li,Mi,Ni,Oi,Pi,Qi,de,ee,ug;Z.DEFAULT_IMAGE=void 0;Z.DEFAULT_MAPPING=300;Z.prototype=Object.assign(Object.create(Ja.prototype),{constructor:Z,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,
this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.name=a.name,this.image=a.image,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,
this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.encoding=a.encoding,this},toJSON:function(a){var b=void 0===a||"string"==typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];var c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,
this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var d=this.image;if(void 0===d.uuid&&(d.uuid=Q.generateUUID()),!b&&void 0===a.images[d.uuid]){if(Array.isArray(d)){var e=[];for(var f=0,g=d.length;f<g;f++)e.push(zb.getDataURL(d[f]))}else e=zb.getDataURL(d);a.images[d.uuid]={uuid:d.uuid,url:e}}c.image=d.uuid}return b||
(a.textures[this.uuid]=c),c},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(300!==this.mapping)return a;if(a.applyMatrix3(this.matrix),0>a.x||1<a.x)switch(this.wrapS){case 1E3:a.x-=Math.floor(a.x);break;case 1001:a.x=0>a.x?0:1;break;case 1002:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x-=Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);break;case 1001:a.y=0>a.y?0:1;break;case 1002:1===Math.abs(Math.floor(a.y)%2)?a.y=
Math.ceil(a.y)-a.y:a.y-=Math.floor(a.y)}return this.flipY&&(a.y=1-a.y),a}});Object.defineProperty(Z.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(da.prototype,{isVector4:!0,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},setScalar:function(a){return this.x=a,this.y=a,this.z=a,this.w=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setW:function(a){return this.w=a,this},
setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==
a.w?a.w:1,this},add:function(a,b){return void 0!==b?this.addVectors(a,b):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this},sub:function(a,b){return void 0!==b?this.subVectors(a,b):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=
a.w,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;return this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e,this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e,this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e,this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e,this},
divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);return this.z=1E-4>b?(this.x=1,this.y=0):(this.x=a.x/b,this.y=a.y/b,a.z/b),this},setAxisAngleFromRotationMatrix:function(a){var b,c,d;var e=a.elements;var f=e[0],g=e[4],h=e[8],k=e[1],m=e[5];a=e[9];var q=e[2],l=e[6],n=e[10];if(.01>Math.abs(g-k)&&.01>Math.abs(h-q)&&.01>Math.abs(a-l)){if(.1>Math.abs(g+k)&&.1>Math.abs(h+q)&&.1>Math.abs(a+l)&&.1>Math.abs(f+
m+n-3))return this.set(1,0,0,0),this;e=Math.PI;f=(f+1)/2;m=(m+1)/2;n=(n+1)/2;g=(g+k)/4;h=(h+q)/4;a=(a+l)/4;return m<f&&n<f?d=.01>f?(b=0,c=.707106781):(c=g/(b=Math.sqrt(f)),h/b):n<m?d=.01>m?(c=0,b=.707106781):(b=g/(c=Math.sqrt(m)),a/c):.01>n?(c=b=.707106781,d=0):(b=h/(d=Math.sqrt(n)),c=a/d),this.set(b,c,d,e),this}b=Math.sqrt((l-a)*(l-a)+(h-q)*(h-q)+(k-g)*(k-g));return.001>Math.abs(b)&&(b=1),this.x=(l-a)/b,this.y=(h-q)/b,this.z=(k-g)/b,this.w=Math.acos((f+m+n-1)/2),this},min:function(a){return this.x=
Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this.w=Math.max(a.w,Math.min(b.w,this.w)),this},clampScalar:function(a,b){return void 0===ff&&(ff=
new da,sg=new da),ff.set(a,a,a,a),sg.set(b,b,b,b),this.clamp(ff,sg)},clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),
this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},lerpVectors:function(a,
b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this.w=a[b+3],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a},fromBufferAttribute:function(a,b,c){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this.w=a.getW(b),this}});Gb.prototype=
Object.assign(Object.create(Ja.prototype),{constructor:Gb,isWebGLRenderTarget:!0,setSize:function(a,b){this.width===a&&this.height===b||(this.width=a,this.height=b,this.dispose());this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.width=a.width,this.height=a.height,this.viewport.copy(a.viewport),this.texture=a.texture.clone(),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.depthTexture=
a.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});jc.prototype=Object.create(Gb.prototype);jc.prototype.constructor=jc;jc.prototype.isWebGLRenderTargetCube=!0;Hb.prototype=Object.create(Z.prototype);Hb.prototype.constructor=Hb;Hb.prototype.isDataTexture=!0;Object.assign(fb.prototype,{isBox3:!0,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromArray:function(a){for(var b=1/0,c=1/0,d=1/0,e=-1/0,f=-1/0,g=-1/0,h=0,k=a.length;h<k;h+=3){var m=a[h],q=a[h+
1],l=a[h+2];m<b&&(b=m);q<c&&(c=q);l<d&&(d=l);e<m&&(e=m);f<q&&(f=q);g<l&&(g=l)}return this.min.set(b,c,d),this.max.set(e,f,g),this},setFromBufferAttribute:function(a){for(var b=1/0,c=1/0,d=1/0,e=-1/0,f=-1/0,g=-1/0,h=0,k=a.count;h<k;h++){var m=a.getX(h),q=a.getY(h),l=a.getZ(h);m<b&&(b=m);q<c&&(c=q);l<d&&(d=l);e<m&&(e=m);f<q&&(f=q);g<l&&(g=l)}return this.min.set(b,c,d),this.max.set(e,f,g),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},
setFromCenterAndSize:(Ki=new n,function(a,b){b=Ki.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this}),setFromObject:function(a){return this.makeEmpty(),this.expandByObject(a)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||
this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(a){return void 0===a&&(a=new n),this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){return void 0===a&&(a=new n),this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),
this},expandByObject:function(){function a(a){var f=a.geometry;if(void 0!==f)if(f.isGeometry)for(f=f.vertices,c=0,d=f.length;c<d;c++)e.copy(f[c]),e.applyMatrix4(a.matrixWorld),b.expandByPoint(e);else if(f.isBufferGeometry&&(f=f.attributes.position,void 0!==f))for(c=0,d=f.count;c<d;c++)e.fromBufferAttribute(f,c).applyMatrix4(a.matrixWorld),b.expandByPoint(e)}var b,c,d,e=new n;return function(c){return b=this,c.updateMatrixWorld(!0),c.traverse(a),this}}(),containsPoint:function(a){return!(a.x<this.min.x||
a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){return void 0===b&&(b=new n),b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<
this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)},intersectsSphere:(tg=new n,function(a){return this.clampPoint(a.center,tg),tg.distanceToSquared(a.center)<=a.radius*a.radius}),intersectsPlane:function(a){var b,c;return c=0<a.normal.x?(b=a.normal.x*this.min.x,a.normal.x*this.max.x):(b=a.normal.x*this.max.x,a.normal.x*this.min.x),0<a.normal.y?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),0<a.normal.z?(b+=a.normal.z*this.min.z,
c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=-a.constant&&c>=-a.constant},intersectsTriangle:function(){function a(a){var e;var f=0;for(e=a.length-3;f<=e;f+=3){h.fromArray(a,f);var g=m.x*Math.abs(h.x)+m.y*Math.abs(h.y)+m.z*Math.abs(h.z),k=b.dot(h),l=c.dot(h),q=d.dot(h);if(Math.max(-Math.max(k,l,q),Math.min(k,l,q))>g)return!1}return!0}var b=new n,c=new n,d=new n,e=new n,f=new n,g=new n,h=new n,k=new n,m=new n,l=new n;return function(h){if(this.isEmpty())return!1;
this.getCenter(k);m.subVectors(this.max,k);b.subVectors(h.a,k);c.subVectors(h.b,k);d.subVectors(h.c,k);e.subVectors(c,b);f.subVectors(d,c);g.subVectors(b,d);return!!a([0,-e.z,e.y,0,-f.z,f.y,0,-g.z,g.y,e.z,0,-e.x,f.z,0,-f.x,g.z,0,-g.x,-e.y,e.x,0,-f.y,f.x,0,-g.y,g.x,0])&&!!a([1,0,0,0,1,0,0,0,1])&&(l.crossVectors(e,f),a([l.x,l.y,l.z]))}}(),clampPoint:function(a,b){return void 0===b&&(b=new n),b.copy(a).clamp(this.min,this.max)},distanceToPoint:(Ji=new n,function(a){return Ji.copy(a).clamp(this.min,this.max).sub(a).length()}),
getBoundingSphere:(Ii=new n,function(a){return void 0===a&&(a=new Ka),this.getCenter(a.center),a.radius=.5*this.getSize(Ii).length(),a}),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},applyMatrix4:(db=[new n,new n,new n,new n,new n,new n,new n,new n],function(a){return this.isEmpty()||(db[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),db[1].set(this.min.x,this.min.y,
this.max.z).applyMatrix4(a),db[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),db[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),db[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),db[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),db[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),db[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(db)),this}),translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&
a.max.equals(this.max)}});Object.assign(Ka.prototype,{set:function(a,b){return this.center.copy(a),this.radius=b,this},setFromPoints:(Li=new fb,function(a,b){var c=this.center;void 0!==b?c.copy(b):Li.setFromPoints(a).getCenter(c);for(var d=b=0,e=a.length;d<e;d++)b=Math.max(b,c.distanceToSquared(a[d]));return this.radius=Math.sqrt(b),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.center.copy(a.center),this.radius=a.radius,this},empty:function(){return 0>=
this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,b){var c=this.center.distanceToSquared(a);
return void 0===b&&(b=new n),b.copy(a),c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b},getBoundingBox:function(a){return void 0===a&&(a=new fb),a.set(this.center,this.center),a.expandByScalar(this.radius),a},applyMatrix4:function(a){return this.center.applyMatrix4(a),this.radius*=a.getMaxScaleOnAxis(),this},translate:function(a){return this.center.add(a),this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}});
Object.assign(Xa.prototype,{set:function(a,b){return this.normal.copy(a),this.constant=b,this},setComponents:function(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this},setFromNormalAndCoplanarPoint:function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this},setFromCoplanarPoints:(Pi=new n,Qi=new n,function(a,b,c){b=Pi.subVectors(c,b).cross(Qi.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(b,a),this}),clone:function(){return(new this.constructor).copy(this)},
copy:function(a){return this.normal.copy(a.normal),this.constant=a.constant,this},normalize:function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return void 0===b&&(b=new n),b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},
intersectLine:(Oi=new n,function(a,b){void 0===b&&(b=new n);var c=a.delta(Oi),d=this.normal.dot(c);if(0===d)return 0===this.distanceToPoint(a.start)?b.copy(a.start):void 0;d=-(a.start.dot(this.normal)+this.constant)/d;return 0>d||1<d?void 0:b.copy(c).multiplyScalar(d).add(a.start)}),intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},
coplanarPoint:function(a){return void 0===a&&(a=new n),a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(Mi=new n,Ni=new ua,function(a,b){b=b||Ni.getNormalMatrix(a);a=this.coplanarPoint(Mi).applyMatrix4(a);b=this.normal.applyMatrix3(b).normalize();return this.constant=-a.dot(b),this}),translate:function(a){return this.constant-=a.dot(this.normal),this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});Object.assign(Ae.prototype,{set:function(a,b,
c,d,e,f){var g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],m=c[7],l=c[8],p=c[9],n=c[10],v=c[11],u=c[12],t=c[13],r=c[14];c=c[15];return b[0].setComponents(f-a,m-g,v-l,c-u).normalize(),b[1].setComponents(f+
a,m+g,v+l,c+u).normalize(),b[2].setComponents(f+d,m+h,v+p,c+t).normalize(),b[3].setComponents(f-d,m-h,v-p,c-t).normalize(),b[4].setComponents(f-e,m-k,v-n,c-r).normalize(),b[5].setComponents(f+e,m+k,v+n,c+r).normalize(),this},intersectsObject:(ug=new Ka,function(a){var b=a.geometry;return null===b.boundingSphere&&b.computeBoundingSphere(),ug.copy(b.boundingSphere).applyMatrix4(a.matrixWorld),this.intersectsSphere(ug)}),intersectsSprite:(ee=new Ka,function(a){return ee.center.set(0,0,0),ee.radius=.7071067811865476,
ee.applyMatrix4(a.matrixWorld),this.intersectsSphere(ee)}),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:(de=new n,function(a){for(var b=this.planes,c=0;6>c;c++){var d=b[c];if(de.x=0<d.normal.x?a.max.x:a.min.x,de.y=0<d.normal.y?a.max.y:a.min.y,de.z=0<d.normal.z?a.max.z:a.min.z,0>d.distanceToPoint(de))return!1}return!0}),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;
return!0}});var Y={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",
color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",
defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",
emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",
lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",
logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",
map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",
metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",
normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",
packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",
roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",
shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",
uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",
uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",
cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",
depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",
depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",
equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",
meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",
normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},
Wk={clone:kc,merge:Aa},Xk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,
teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fe,ge,Ua;Object.assign(L.prototype,{isColor:!0,r:1,g:1,b:1,set:function(a){return a&&a.isColor?this.copy(a):"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a),this},setScalar:function(a){return this.r=a,this.g=a,this.b=a,this},setHex:function(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=
(255&a)/255,this},setRGB:function(a,b,c){return this.r=a,this.g=b,this.b=c,this},setHSL:function(){function a(a,c,d){return 0>d&&(d+=1),1<d&&--d,d<1/6?a+6*(c-a)*d:.5>d?c:d<2/3?a+6*(c-a)*(2/3-d):a}return function(b,c,d){(b=Q.euclideanModulo(b,1),c=Q.clamp(c,0,1),d=Q.clamp(d,0,1),0===c)?this.r=this.g=this.b=d:(c=.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=a(d,c,b+1/3),this.g=a(d,c,b),this.b=a(d,c,b-1/3));return this}}(),setStyle:function(a){function b(a){void 0!==a&&parseFloat(a)}var c;if(c=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var d=
c[2];switch(c[1]){case "rgb":case "rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,b(c[5]),this;if(c=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,b(c[5]),this;break;
case "hsl":case "hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){a=parseFloat(c[1])/360;var e=parseInt(c[2],10)/100;d=parseInt(c[3],10)/100;return b(c[5]),this.setHSL(a,e,d)}}}else if(c=/^#([A-Fa-f0-9]+)$/.exec(a)){c=(e=c[1]).length;if(3===c)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(e.charAt(0)+e.charAt(1),
16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}a&&0<a.length&&void 0!==(e=Xk[a])&&this.setHex(e);return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){return this.r=a.r,this.g=a.g,this.b=a.b,this},copyGammaToLinear:function(a,b){return void 0===b&&(b=2),this.r=Math.pow(a.r,b),this.g=Math.pow(a.g,b),this.b=Math.pow(a.b,b),this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);b=0<b?1/b:1;return this.r=
Math.pow(a.r,b),this.g=Math.pow(a.g,b),this.b=Math.pow(a.b,b),this},convertGammaToLinear:function(a){return this.copyGammaToLinear(this,a),this},convertLinearToGamma:function(a){return this.copyLinearToGamma(this,a),this},copySRGBToLinear:function(){function a(a){return.04045>a?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}return function(b){return this.r=a(b.r),this.g=a(b.g),this.b=a(b.b),this}}(),copyLinearToSRGB:function(){function a(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-
.055}return function(b){return this.r=a(b.r),this.g=a(b.g),this.b=a(b.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){void 0===a&&(a={h:0,s:0,l:0});var b,c=this.r,d=this.g,e=this.b,f=Math.max(c,d,e);var g=Math.min(c,d,e);var h=
(g+f)/2;if(g===f)g=b=0;else{var k=f-g;switch(g=.5>=h?k/(f+g):k/(2-f-g),f){case c:b=(d-e)/k+(d<e?6:0);break;case d:b=(e-c)/k+2;break;case e:b=(c-d)/k+4}b/=6}return a.h=b,a.s=g,a.l=h,a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(Ua={},function(a,b,c){return this.getHSL(Ua),Ua.h+=a,Ua.s+=b,Ua.l+=c,this.setHSL(Ua.h,Ua.s,Ua.l),this}),add:function(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this},addColors:function(a,b){return this.r=a.r+b.r,
this.g=a.g+b.g,this.b=a.b+b.b,this},addScalar:function(a){return this.r+=a,this.g+=a,this.b+=a,this},sub:function(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this},multiply:function(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this},multiplyScalar:function(a){return this.r*=a,this.g*=a,this.b*=a,this},lerp:function(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this},lerpHSL:(fe={h:0,s:0,l:0},ge={h:0,s:0,l:0},
function(a,b){this.getHSL(fe);a.getHSL(ge);a=Q.lerp(fe.h,ge.h,b);var c=Q.lerp(fe.s,ge.s,b);b=Q.lerp(fe.l,ge.l,b);return this.setHSL(a,c,b),this}),equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){return void 0===b&&(b=0),this.r=a[b],this.g=a[b+1],this.b=a[b+2],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a},toJSON:function(){return this.getHex()}});var H={common:{diffuse:{value:new L(15658734)},
opacity:{value:1},map:{value:null},uvTransform:{value:new ua},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new x(1,
1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new L(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},
directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],
properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new L(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new ua}},sprite:{diffuse:{value:new L(15658734)},opacity:{value:1},center:{value:new x(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new ua}}},Ya={basic:{uniforms:Aa([H.common,H.specularmap,H.envmap,H.aomap,H.lightmap,H.fog]),
vertexShader:Y.meshbasic_vert,fragmentShader:Y.meshbasic_frag},lambert:{uniforms:Aa([H.common,H.specularmap,H.envmap,H.aomap,H.lightmap,H.emissivemap,H.fog,H.lights,{emissive:{value:new L(0)}}]),vertexShader:Y.meshlambert_vert,fragmentShader:Y.meshlambert_frag},phong:{uniforms:Aa([H.common,H.specularmap,H.envmap,H.aomap,H.lightmap,H.emissivemap,H.bumpmap,H.normalmap,H.displacementmap,H.gradientmap,H.fog,H.lights,{emissive:{value:new L(0)},specular:{value:new L(1118481)},shininess:{value:30}}]),vertexShader:Y.meshphong_vert,
fragmentShader:Y.meshphong_frag},standard:{uniforms:Aa([H.common,H.envmap,H.aomap,H.lightmap,H.emissivemap,H.bumpmap,H.normalmap,H.displacementmap,H.roughnessmap,H.metalnessmap,H.fog,H.lights,{emissive:{value:new L(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Y.meshphysical_vert,fragmentShader:Y.meshphysical_frag},matcap:{uniforms:Aa([H.common,H.bumpmap,H.normalmap,H.displacementmap,H.fog,{matcap:{value:null}}]),vertexShader:Y.meshmatcap_vert,fragmentShader:Y.meshmatcap_frag},
points:{uniforms:Aa([H.points,H.fog]),vertexShader:Y.points_vert,fragmentShader:Y.points_frag},dashed:{uniforms:Aa([H.common,H.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Y.linedashed_vert,fragmentShader:Y.linedashed_frag},depth:{uniforms:Aa([H.common,H.displacementmap]),vertexShader:Y.depth_vert,fragmentShader:Y.depth_frag},normal:{uniforms:Aa([H.common,H.bumpmap,H.normalmap,H.displacementmap,{opacity:{value:1}}]),vertexShader:Y.normal_vert,fragmentShader:Y.normal_frag},
sprite:{uniforms:Aa([H.sprite,H.fog]),vertexShader:Y.sprite_vert,fragmentShader:Y.sprite_frag},background:{uniforms:{uvTransform:{value:new ua},t2D:{value:null}},vertexShader:Y.background_vert,fragmentShader:Y.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Y.cube_vert,fragmentShader:Y.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Y.equirect_vert,fragmentShader:Y.equirect_frag},distanceRGBA:{uniforms:Aa([H.common,H.displacementmap,
{referencePosition:{value:new n},nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:Y.distanceRGBA_vert,fragmentShader:Y.distanceRGBA_frag},shadow:{uniforms:Aa([H.lights,H.fog,{color:{value:new L(0)},opacity:{value:1}}]),vertexShader:Y.shadow_vert,fragmentShader:Y.shadow_frag}},vg,wg;Ya.physical={uniforms:Aa([Ya.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Y.meshphysical_vert,fragmentShader:Y.meshphysical_frag};Object.assign(lc.prototype,{clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}});Ib.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");Ib.DefaultOrder="XYZ";Object.defineProperties(Ib.prototype,{x:{get:function(){return this._x},set:function(a){this._x=
a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=a;this.onChangeCallback()}}});Object.assign(Ib.prototype,{isEuler:!0,set:function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._order=d||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,
this._y,this._z,this._order)},copy:function(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this.onChangeCallback(),this},setFromRotationMatrix:function(a,b,c){var d=Q.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],m=e[9],l=e[2],p=e[6];e=e[10];return"XYZ"===(b=b||this._order)?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-m,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(p,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?
(this._y=Math.atan2(g,e),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-l,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(p,-1,1)),.99999>Math.abs(p)?(this._y=Math.atan2(-l,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(l,-1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(p,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-m,k),this._y=Math.atan2(-l,a)):(this._x=
0,this._y=Math.atan2(g,e))):"XZY"===b&&(this._z=Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(p,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,e),this._y=0)),this._order=b,!1!==c&&this.onChangeCallback(),this},setFromQuaternion:(wg=new I,function(a,b,c){return wg.makeRotationFromQuaternion(a),this.setFromRotationMatrix(wg,b,c)}),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:(vg=new la,function(a){return vg.setFromEuler(this),this.setFromQuaternion(vg,
a)}),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){return this._x=a[0],this._y=a[1],this._z=a[2],void 0!==a[3]&&(this._order=a[3]),this.onChangeCallback(),this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new n(this._x,this._y,this._z)},onChange:function(a){return this.onChangeCallback=
a,this},onChangeCallback:function(){}});Object.assign(Df.prototype,{set:function(a){this.mask=1<<a|0},enable:function(a){this.mask=this.mask|1<<a|0},toggle:function(a){this.mask^=1<<a|0},disable:function(a){this.mask&=~(1<<a|0)},test:function(a){return 0!=(this.mask&a.mask)}});var Fj=0,Ri,Si,Ti,Ui,xg,Uc,he,gf,Vi,Wi,Xi,Yi,yg,Zi,$i,aj,zg,Ag;E.DefaultUp=new n(0,1,0);E.DefaultMatrixAutoUpdate=!0;E.prototype=Object.assign(Object.create(Ja.prototype),{constructor:E,isObject3D:!0,onBeforeRender:function(){},
onAfterRender:function(){},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){return this.quaternion.premultiply(a),this},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},
rotateOnAxis:(Ag=new la,function(a,b){return Ag.setFromAxisAngle(a,b),this.quaternion.multiply(Ag),this}),rotateOnWorldAxis:(zg=new la,function(a,b){return zg.setFromAxisAngle(a,b),this.quaternion.premultiply(zg),this}),rotateX:(aj=new n(1,0,0),function(a){return this.rotateOnAxis(aj,a)}),rotateY:($i=new n(0,1,0),function(a){return this.rotateOnAxis($i,a)}),rotateZ:(Zi=new n(0,0,1),function(a){return this.rotateOnAxis(Zi,a)}),translateOnAxis:(yg=new n,function(a,b){return yg.copy(a).applyQuaternion(this.quaternion),
this.position.add(yg.multiplyScalar(b)),this}),translateX:(Yi=new n(1,0,0),function(a){return this.translateOnAxis(Yi,a)}),translateY:(Xi=new n(0,1,0),function(a){return this.translateOnAxis(Xi,a)}),translateZ:(Wi=new n(0,0,1),function(a){return this.translateOnAxis(Wi,a)}),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:(Vi=new I,function(a){return a.applyMatrix4(Vi.getInverse(this.matrixWorld))}),lookAt:(xg=new la,Uc=new I,he=new n,gf=new n,function(a,b,c){a.isVector3?
he.copy(a):he.set(a,b,c);a=this.parent;this.updateWorldMatrix(!0,!1);gf.setFromMatrixPosition(this.matrixWorld);this.isCamera?Uc.lookAt(gf,he,this.up):Uc.lookAt(he,gf,this.up);this.quaternion.setFromRotationMatrix(Uc);a&&(Uc.extractRotation(a.matrixWorld),xg.setFromRotationMatrix(Uc),this.quaternion.premultiply(xg.inverse()))}),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}return a===this||a&&a.isObject3D&&(null!==a.parent&&a.parent.remove(a),
a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)),this},remove:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);return this}b=this.children.indexOf(a);return-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1)),this},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;
for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){return void 0===a&&(a=new n),this.updateMatrixWorld(!0),a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Ti=new n,Ui=new n,function(a){return void 0===a&&(a=new la),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ti,a,Ui),a}),getWorldScale:(Ri=new n,Si=new la,function(a){return void 0===a&&(a=new n),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ri,
Si,a),a}),getWorldDirection:function(a){void 0===a&&(a=new n);this.updateMatrixWorld(!0);var b=this.matrixWorld.elements;return a.set(b[8],b[9],b[10]).normalize()},raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,
this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix();(this.matrixWorldNeedsUpdate||a)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),a=!(this.matrixWorldNeedsUpdate=!1));for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)},updateWorldMatrix:function(a,b){var c=this.parent;if(!0===a&&null!==c&&c.updateWorldMatrix(!0,!1),
this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===b)for(a=this.children,b=0,c=a.length;b<c;b++)a[b].updateWorldMatrix(!1,!0)},toJSON:function(a){function b(b,c){return void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a)),c.uuid}function c(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var d=void 0===a||"string"==typeof a,e={};d&&(a={geometries:{},materials:{},
textures:{},images:{},shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var f={};if(f.uuid=this.uuid,f.type=this.type,""!==this.name&&(f.name=this.name),!0===this.castShadow&&(f.castShadow=!0),!0===this.receiveShadow&&(f.receiveShadow=!0),!1===this.visible&&(f.visible=!1),!1===this.frustumCulled&&(f.frustumCulled=!1),0!==this.renderOrder&&(f.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(f.userData=this.userData),f.layers=this.layers.mask,f.matrix=
this.matrix.toArray(),!1===this.matrixAutoUpdate&&(f.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){f.geometry=b(a.geometries,this.geometry);var g=this.geometry.parameters;if(void 0!==g&&void 0!==g.shapes)if(g=g.shapes,Array.isArray(g))for(var h=0,k=g.length;h<k;h++)b(a.shapes,g[h]);else b(a.shapes,g)}if(void 0!==this.material)if(Array.isArray(this.material)){g=[];h=0;for(k=this.material.length;h<k;h++)g.push(b(a.materials,this.material[h]));f.material=g}else f.material=b(a.materials,
this.material);if(0<this.children.length)for(f.children=[],h=0;h<this.children.length;h++)f.children.push(this.children[h].toJSON(a).object);if(d){d=c(a.geometries);h=c(a.materials);k=c(a.textures);var m=c(a.images);g=c(a.shapes);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<k.length&&(e.textures=k);0<m.length&&(e.images=m);0<g.length&&(e.shapes=g)}return e.object=f,e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){if(void 0===b&&(b=!0),this.name=a.name,
this.up.copy(a.up),this.position.copy(a.position),this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.userData=JSON.parse(JSON.stringify(a.userData)),
!0===b)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());return this}});var Gj=0,ie,hf,Bg,Cg,Dg,Eg,Fg;J.prototype=Object.assign(Object.create(Ja.prototype),{constructor:J,isGeometry:!0,applyMatrix:function(a){for(var b=(new ua).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}return null!==
this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:(Fg=new I,function(a){return Fg.makeRotationX(a),this.applyMatrix(Fg),this}),rotateY:(Eg=new I,function(a){return Eg.makeRotationY(a),this.applyMatrix(Eg),this}),rotateZ:(Dg=new I,function(a){return Dg.makeRotationZ(a),this.applyMatrix(Dg),this}),translate:(Cg=new I,function(a,b,c){return Cg.makeTranslation(a,b,c),this.applyMatrix(Cg),
this}),scale:(Bg=new I,function(a,b,c){return Bg.makeScale(a,b,c),this.applyMatrix(Bg),this}),lookAt:(hf=new E,function(a){hf.lookAt(a);hf.updateMatrix();this.applyMatrix(hf.matrix)}),fromBufferGeometry:function(a){function b(a,b,d,e){var f=void 0===h?[]:[c.colors[a].clone(),c.colors[b].clone(),c.colors[d].clone()];e=new lc(a,b,d,void 0===g?[]:[(new n).fromArray(g,3*a),(new n).fromArray(g,3*b),(new n).fromArray(g,3*d)],f,e);c.faces.push(e);void 0!==k&&c.faceVertexUvs[0].push([(new x).fromArray(k,
2*a),(new x).fromArray(k,2*b),(new x).fromArray(k,2*d)]);void 0!==m&&c.faceVertexUvs[1].push([(new x).fromArray(m,2*a),(new x).fromArray(m,2*b),(new x).fromArray(m,2*d)])}var c=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,f=e.position.array,g=void 0!==e.normal?e.normal.array:void 0,h=void 0!==e.color?e.color.array:void 0,k=void 0!==e.uv?e.uv.array:void 0,m=void 0!==e.uv2?e.uv2.array:void 0;void 0!==m&&(this.faceVertexUvs[1]=[]);for(var l=e=0;e<f.length;e+=3,l+=2)c.vertices.push((new n).fromArray(f,
e)),void 0!==h&&c.colors.push((new L).fromArray(h,e));var p=a.groups;if(0<p.length)for(e=0;e<p.length;e++){f=p[e];var w=f.start;for(w=(l=w,w+f.count);l<w;l+=3)void 0!==d?b(d[l],d[l+1],d[l+2],f.materialIndex):b(l,l+1,l+2,f.materialIndex)}else if(void 0!==d)for(e=0;e<d.length;e+=3)b(d[e],d[e+1],d[e+2]);else for(e=0;e<f.length/3;e+=3)b(e,e+1,e+2);return this.computeFaceNormals(),null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),
this},center:(ie=new n,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ie).negate(),this.translate(ie.x,ie.y,ie.z),this}),normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius;b=0===b?1:1/b;var c=new I;return c.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1),this.applyMatrix(c),this},computeFaceNormals:function(){for(var a=new n,b=new n,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b];
a.subVectors(this.vertices[e.c],g);b.subVectors(f,g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){var b;void 0===a&&(a=!0);var c=Array(this.vertices.length);var d=0;for(b=this.vertices.length;d<b;d++)c[d]=new n;if(a){var e=new n,f=new n;a=0;for(d=this.faces.length;a<d;a++){var g=this.faces[a];b=this.vertices[g.a];var h=this.vertices[g.b];var k=this.vertices[g.c];e.subVectors(k,h);f.subVectors(b,h);e.cross(f);c[g.a].add(e);c[g.b].add(e);c[g.c].add(e)}}else for(this.computeFaceNormals(),
a=0,d=this.faces.length;a<d;a++)c[(g=this.faces[a]).a].add(g.normal),c[g.b].add(g.normal),c[g.c].add(g.normal);d=0;for(b=this.vertices.length;d<b;d++)c[d].normalize();a=0;for(d=this.faces.length;a<d;a++)b=(g=this.faces[a]).vertexNormals,3===b.length?(b[0].copy(c[g.a]),b[1].copy(c[g.b]),b[2].copy(c[g.c])):(b[0]=c[g.a].clone(),b[1]=c[g.b].clone(),b[2]=c[g.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var a,b;this.computeFaceNormals();var c=0;for(a=
this.faces.length;c<a;c++){var d=(b=this.faces[c]).vertexNormals;3===d.length?(d[0].copy(b.normal),d[1].copy(b.normal),d[2].copy(b.normal)):(d[0]=b.normal.clone(),d[1]=b.normal.clone(),d[2]=b.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var a,b,c;var d=0;for(b=this.faces.length;d<b;d++){(c=this.faces[d]).__originalFaceNormal?c.__originalFaceNormal.copy(c.normal):c.__originalFaceNormal=c.normal.clone();c.__originalVertexNormals||(c.__originalVertexNormals=
[]);var e=0;for(a=c.vertexNormals.length;e<a;e++)c.__originalVertexNormals[e]?c.__originalVertexNormals[e].copy(c.vertexNormals[e]):c.__originalVertexNormals[e]=c.vertexNormals[e].clone()}var f=new J;f.faces=this.faces;e=0;for(a=this.morphTargets.length;e<a;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];var g=this.morphNormals[e].faceNormals,h=this.morphNormals[e].vertexNormals;d=0;for(b=this.faces.length;d<b;d++){var k=
new n;var m={a:new n,b:new n,c:new n};g.push(k);h.push(m)}}g=this.morphNormals[e];f.vertices=this.morphTargets[e].vertices;f.computeFaceNormals();f.computeVertexNormals();d=0;for(b=this.faces.length;d<b;d++)c=this.faces[d],k=g.faceNormals[d],m=g.vertexNormals[d],k.copy(c.normal),m.a.copy(c.vertexNormals[0]),m.b.copy(c.vertexNormals[1]),m.c.copy(c.vertexNormals[2])}d=0;for(b=this.faces.length;d<b;d++)(c=this.faces[d]).normal=c.__originalFaceNormal,c.vertexNormals=c.__originalVertexNormals},computeBoundingBox:function(){null===
this.boundingBox&&(this.boundingBox=new fb);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ka);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,c){if(a&&a.isGeometry){var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,k=a.faces,m=this.faceVertexUvs[0],l=a.faceVertexUvs[0],p=this.colors,n=a.colors;void 0===c&&(c=0);void 0!==b&&(d=(new ua).getNormalMatrix(b));a=0;for(var v=g.length;a<
v;a++){var u=g[a].clone();void 0!==b&&u.applyMatrix4(b);f.push(u)}a=0;for(v=n.length;a<v;a++)p.push(n[a].clone());a=0;for(v=k.length;a<v;a++){p=k[a];var t=p.vertexNormals;n=p.vertexColors;(g=new lc(p.a+e,p.b+e,p.c+e)).normal.copy(p.normal);void 0!==d&&g.normal.applyMatrix3(d).normalize();b=0;for(f=t.length;b<f;b++)u=t[b].clone(),void 0!==d&&u.applyMatrix3(d).normalize(),g.vertexNormals.push(u);g.color.copy(p.color);b=0;for(f=n.length;b<f;b++)u=n[b],g.vertexColors.push(u.clone());g.materialIndex=p.materialIndex+
c;h.push(g)}a=0;for(v=l.length;a<v;a++)if(c=l[a],d=[],void 0!==c){b=0;for(f=c.length;b<f;b++)d.push(c[b].clone());m.push(d)}}},mergeMesh:function(a){a&&a.isMesh&&(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix))},mergeVertices:function(){var a,b,c,d={},e=[],f=[],g=Math.pow(10,4);var h=0;for(b=this.vertices.length;h<b;h++){var k=this.vertices[h];void 0===d[a=Math.round(k.x*g)+"_"+Math.round(k.y*g)+"_"+Math.round(k.z*g)]?(d[a]=h,e.push(this.vertices[h]),f[h]=e.length-1):f[h]=f[d[a]]}k=
[];h=0;for(b=this.faces.length;h<b;h++)for((c=this.faces[h]).a=f[c.a],c.b=f[c.b],c.c=f[c.c],a=[c.a,c.b,c.c],d=0;3>d;d++)if(a[d]===a[(d+1)%3]){k.push(h);break}for(h=k.length-1;0<=h;h--)for(f=k[h],this.faces.splice(f,1),b=0,c=this.faceVertexUvs.length;b<c;b++)this.faceVertexUvs[b].splice(f,1);h=this.vertices.length-e.length;return this.vertices=e,h},setFromPoints:function(a){this.vertices=[];for(var b=0,c=a.length;b<c;b++){var d=a[b];this.vertices.push(new n(d.x,d.y,d.z||0))}return this},sortFacesByMaterialIndex:function(){for(var a=
this.faces,b=a.length,c=0;c<b;c++)a[c]._id=c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d,e,f=this.faceVertexUvs[0],g=this.faceVertexUvs[1];f&&f.length===b&&(d=[]);g&&g.length===b&&(e=[]);for(c=0;c<b;c++){var h=a[c]._id;d&&d.push(f[h]);e&&e.push(g[h])}d&&(this.faceVertexUvs[0]=d);e&&(this.faceVertexUvs[1]=e)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();return void 0!==m[b]||(m[b]=k.length/3,k.push(a.x,
a.y,a.z)),m[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();return void 0!==p[b]||(p[b]=l.length,l.push(a.getHex())),p[b]}function d(a){var b=a.x.toString()+a.y.toString();return void 0!==v[b]||(v[b]=n.length/2,n.push(a.x,a.y)),v[b]}var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var f=this.parameters,g;for(g in f)void 0!==f[g]&&(e[g]=f[g]);return e}f=[];
for(g=0;g<this.vertices.length;g++){var h=this.vertices[g];f.push(h.x,h.y,h.z)}h=[];var k=[],m={},l=[],p={},n=[],v={};for(g=0;g<this.faces.length;g++){var u=this.faces[g],t=void 0!==this.faceVertexUvs[0][g],r=0<u.normal.length(),x=0<u.vertexNormals.length,y=1!==u.color.r||1!==u.color.g||1!==u.color.b,O=0<u.vertexColors.length,N=0;if(N=a(N=a(N=a(N=a(N=a(N=a(N=a(N=a(N,0,0),1,!0),2,!1),3,t),4,r),5,x),6,y),7,O),h.push(N),h.push(u.a,u.b,u.c),h.push(u.materialIndex),t)t=this.faceVertexUvs[0][g],h.push(d(t[0]),
d(t[1]),d(t[2]));if(r&&h.push(b(u.normal)),x)r=u.vertexNormals,h.push(b(r[0]),b(r[1]),b(r[2]));if(y&&h.push(c(u.color)),O)u=u.vertexColors,h.push(c(u[0]),c(u[1]),c(u[2]))}return e.data={},e.data.vertices=f,e.data.normals=k,0<l.length&&(e.data.colors=l),0<n.length&&(e.data.uvs=[n]),e.data.faces=h,e},clone:function(){return(new J).copy(this)},copy:function(a){var b,c,d;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];
this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var e=a.vertices;var f=0;for(b=e.length;f<b;f++)this.vertices.push(e[f].clone());e=a.colors;f=0;for(b=e.length;f<b;f++)this.colors.push(e[f].clone());e=a.faces;f=0;for(b=e.length;f<b;f++)this.faces.push(e[f].clone());f=0;for(b=a.faceVertexUvs.length;f<b;f++){var g=a.faceVertexUvs[f];void 0===this.faceVertexUvs[f]&&(this.faceVertexUvs[f]=[]);e=0;for(c=g.length;e<c;e++){var h=g[e],k=[];var m=0;for(d=
h.length;m<d;m++)k.push(h[m].clone());this.faceVertexUvs[f].push(k)}}m=a.morphTargets;f=0;for(b=m.length;f<b;f++){d={};if(d.name=m[f].name,void 0!==m[f].vertices)for(d.vertices=[],e=0,c=m[f].vertices.length;e<c;e++)d.vertices.push(m[f].vertices[e].clone());if(void 0!==m[f].normals)for(d.normals=[],e=0,c=m[f].normals.length;e<c;e++)d.normals.push(m[f].normals[e].clone());this.morphTargets.push(d)}m=a.morphNormals;f=0;for(b=m.length;f<b;f++){d={};if(void 0!==m[f].vertexNormals)for(d.vertexNormals=[],
e=0,c=m[f].vertexNormals.length;e<c;e++)g=m[f].vertexNormals[e],h={},h.a=g.a.clone(),h.b=g.b.clone(),h.c=g.c.clone(),d.vertexNormals.push(h);if(void 0!==m[f].faceNormals)for(d.faceNormals=[],e=0,c=m[f].faceNormals.length;e<c;e++)d.faceNormals.push(m[f].faceNormals[e].clone());this.morphNormals.push(d)}e=a.skinWeights;f=0;for(b=e.length;f<b;f++)this.skinWeights.push(e[f].clone());e=a.skinIndices;f=0;for(b=e.length;f<b;f++)this.skinIndices.push(e[f].clone());e=a.lineDistances;f=0;for(b=e.length;f<b;f++)this.lineDistances.push(e[f]);
f=a.boundingBox;null!==f&&(this.boundingBox=f.clone());f=a.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.elementsNeedUpdate=a.elementsNeedUpdate,this.verticesNeedUpdate=a.verticesNeedUpdate,this.uvsNeedUpdate=a.uvsNeedUpdate,this.normalsNeedUpdate=a.normalsNeedUpdate,this.colorsNeedUpdate=a.colorsNeedUpdate,this.lineDistancesNeedUpdate=a.lineDistancesNeedUpdate,this.groupsNeedUpdate=a.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(X.prototype,
"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(X.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==a?a.length/this.itemSize:0,this.array=a,this},setDynamic:function(a){return this.dynamic=a,this},copy:function(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,
this.normalized=a.normalized,this.dynamic=a.dynamic,this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){return this.array.set(a),this},copyColorsArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(f=new L);b[c++]=f.r;b[c++]=f.g;b[c++]=f.b}return this},copyVector2sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&
(f=new x);b[c++]=f.x;b[c++]=f.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(f=new n);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z}return this},copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(f=new da);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z;b[c++]=f.w}return this},set:function(a,b){return void 0===b&&(b=0),this.array.set(a,b),this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,
b){return this.array[a*this.itemSize]=b,this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){return this.array[a*this.itemSize+1]=b,this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){return this.array[a*this.itemSize+2]=b,this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){return this.array[a*this.itemSize+3]=b,this},setXY:function(a,b,c){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this},setXYZ:function(a,
b,c,d){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this},setXYZW:function(a,b,c,d,e){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this.array[a+3]=e,this},onUpload:function(a){return this.onUploadCallback=a,this},clone:function(){return(new this.constructor(this.array,this.itemSize)).copy(this)}});ed.prototype=Object.create(X.prototype);ed.prototype.constructor=ed;fd.prototype=Object.create(X.prototype);fd.prototype.constructor=fd;
gd.prototype=Object.create(X.prototype);gd.prototype.constructor=gd;hd.prototype=Object.create(X.prototype);hd.prototype.constructor=hd;Jb.prototype=Object.create(X.prototype);Jb.prototype.constructor=Jb;id.prototype=Object.create(X.prototype);id.prototype.constructor=id;Kb.prototype=Object.create(X.prototype);Kb.prototype.constructor=Kb;B.prototype=Object.create(X.prototype);B.prototype.constructor=B;jd.prototype=Object.create(X.prototype);jd.prototype.constructor=jd;Object.assign(Ah.prototype,{computeGroups:function(a){var b,
c=[],d=void 0;a=a.faces;for(var e=0;e<a.length;e++){var f=a[e];f.materialIndex!==d&&(d=f.materialIndex,void 0!==b&&(b.count=3*e-b.start,c.push(b)),b={start:3*e,materialIndex:d})}void 0!==b&&(b.count=3*e-b.start,c.push(b));this.groups=c},fromGeometry:function(a){var b=a.faces,c=a.vertices,d=a.faceVertexUvs,e=d[0]&&0<d[0].length,f=d[1]&&0<d[1].length,g=a.morphTargets,h=g.length;if(0<h){var k=[];for(var m=0;m<h;m++)k[m]={name:g[m].name,data:[]};this.morphTargets.position=k}var l=a.morphNormals,p=l.length;
if(0<p){var n=[];for(m=0;m<p;m++)n[m]={name:l[m].name,data:[]};this.morphTargets.normal=n}var v=a.skinIndices,u=a.skinWeights,t=v.length===c.length,r=u.length===c.length;0<c.length&&b.length;for(m=0;m<b.length;m++){var z=b[m];this.vertices.push(c[z.a],c[z.b],c[z.c]);var y=z.vertexNormals;3===y.length?this.normals.push(y[0],y[1],y[2]):(y=z.normal,this.normals.push(y,y,y));var O;y=z.vertexColors;3===y.length?this.colors.push(y[0],y[1],y[2]):(y=z.color,this.colors.push(y,y,y));!0===e&&(void 0!==(O=d[0][m])?
this.uvs.push(O[0],O[1],O[2]):this.uvs.push(new x,new x,new x));!0===f&&(void 0!==(O=d[1][m])?this.uvs2.push(O[0],O[1],O[2]):this.uvs2.push(new x,new x,new x));for(y=0;y<h;y++){var N=g[y].vertices;k[y].data.push(N[z.a],N[z.b],N[z.c])}for(y=0;y<p;y++)N=l[y].vertexNormals[m],n[y].data.push(N.a,N.b,N.c);t&&this.skinIndices.push(v[z.a],v[z.b],v[z.c]);r&&this.skinWeights.push(u[z.a],u[z.b],u[z.c])}return this.computeGroups(a),this.verticesNeedUpdate=a.verticesNeedUpdate,this.normalsNeedUpdate=a.normalsNeedUpdate,
this.colorsNeedUpdate=a.colorsNeedUpdate,this.uvsNeedUpdate=a.uvsNeedUpdate,this.groupsNeedUpdate=a.groupsNeedUpdate,this}});var Hj=1,Ab,Gg,je,ke,jf,Hg,Ig,Jg,Kg,Lg;F.prototype=Object.assign(Object.create(Ja.prototype),{constructor:F,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(a){Array.isArray(a)?this.index=new (65535<Bh(a)?Kb:Jb)(a,1):this.index=a},addAttribute:function(a,b,c){return b&&b.isBufferAttribute||b&&b.isInterleavedBufferAttribute?("index"===a?this.setIndex(b):
this.attributes[a]=b,this):this.addAttribute(a,new X(b,c))},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){return delete this.attributes[a],this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToBufferAttribute(b),b.needsUpdate=!0);b=this.attributes.normal;
void 0!==b&&((new ua).getNormalMatrix(a).applyToBufferAttribute(b),b.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(Lg=new I,function(a){return Lg.makeRotationX(a),this.applyMatrix(Lg),this}),rotateY:(Kg=new I,function(a){return Kg.makeRotationY(a),this.applyMatrix(Kg),this}),rotateZ:(Jg=new I,function(a){return Jg.makeRotationZ(a),this.applyMatrix(Jg),this}),translate:(Ig=new I,function(a,b,c){return Ig.makeTranslation(a,
b,c),this.applyMatrix(Ig),this}),scale:(Hg=new I,function(a,b,c){return Hg.makeScale(a,b,c),this.applyMatrix(Hg),this}),lookAt:(jf=new E,function(a){jf.lookAt(a);jf.updateMatrix();this.applyMatrix(jf.matrix)}),center:(ke=new n,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ke).negate(),this.translate(ke.x,ke.y,ke.z),this}),setFromObject:function(a){var b=a.geometry;if(a.isPoints||a.isLine){a=new B(3*b.vertices.length,3);var c=new B(3*b.colors.length,3);if(this.addAttribute("position",
a.copyVector3sArray(b.vertices)),this.addAttribute("color",c.copyColorsArray(b.colors)),b.lineDistances&&b.lineDistances.length===b.vertices.length)a=new B(b.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(b.lineDistances));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a.isMesh&&b&&b.isGeometry&&this.fromGeometry(b);return this},setFromPoints:function(a){for(var b=[],c=0,d=a.length;c<
d;c++){var e=a[c];b.push(e.x,e.y,e.z||0)}return this.addAttribute("position",new B(b,3)),this},updateFromObject:function(a){var b,c=a.geometry;if(a.isMesh){var d=c.__directGeometry;if(!0===c.elementsNeedUpdate&&(d=void 0,c.elementsNeedUpdate=!1),void 0===d)return this.fromGeometry(c);d.verticesNeedUpdate=c.verticesNeedUpdate;d.normalsNeedUpdate=c.normalsNeedUpdate;d.colorsNeedUpdate=c.colorsNeedUpdate;d.uvsNeedUpdate=c.uvsNeedUpdate;d.groupsNeedUpdate=c.groupsNeedUpdate;c.verticesNeedUpdate=!1;c.normalsNeedUpdate=
!1;c.colorsNeedUpdate=!1;c.uvsNeedUpdate=!1;c.groupsNeedUpdate=!1;c=d}return!0===c.verticesNeedUpdate&&(void 0!==(b=this.attributes.position)&&(b.copyVector3sArray(c.vertices),b.needsUpdate=!0),c.verticesNeedUpdate=!1),!0===c.normalsNeedUpdate&&(void 0!==(b=this.attributes.normal)&&(b.copyVector3sArray(c.normals),b.needsUpdate=!0),c.normalsNeedUpdate=!1),!0===c.colorsNeedUpdate&&(void 0!==(b=this.attributes.color)&&(b.copyColorsArray(c.colors),b.needsUpdate=!0),c.colorsNeedUpdate=!1),c.uvsNeedUpdate&&
(void 0!==(b=this.attributes.uv)&&(b.copyVector2sArray(c.uvs),b.needsUpdate=!0),c.uvsNeedUpdate=!1),c.lineDistancesNeedUpdate&&(void 0!==(b=this.attributes.lineDistance)&&(b.copyArray(c.lineDistances),b.needsUpdate=!0),c.lineDistancesNeedUpdate=!1),c.groupsNeedUpdate&&(c.computeGroups(a.geometry),this.groups=c.groups,c.groupsNeedUpdate=!1),this},fromGeometry:function(a){return a.__directGeometry=(new Ah).fromGeometry(a),this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=
new Float32Array(3*a.vertices.length);if(this.addAttribute("position",(new X(b,3)).copyVector3sArray(a.vertices)),0<a.normals.length)b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new X(b,3)).copyVector3sArray(a.normals));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new X(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new X(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=
new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new X(b,2)).copyVector2sArray(a.uvs2)));for(var c in this.groups=a.groups,a.morphTargets){b=[];for(var d=a.morphTargets[c],e=0,f=d.length;e<f;e++){var g=d[e],h=new B(3*g.data.length,3);h.name=g.name;b.push(h.copyVector3sArray(g.data))}this.morphAttributes[c]=b}0<a.skinIndices.length&&(c=new B(4*a.skinIndices.length,4),this.addAttribute("skinIndex",c.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(c=new B(4*a.skinWeights.length,
4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights)));return null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new fb);var a=this.attributes.position;void 0!==a?this.boundingBox.setFromBufferAttribute(a):this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)},
computeBoundingSphere:(Gg=new fb,je=new n,function(){null===this.boundingSphere&&(this.boundingSphere=new Ka);var a=this.attributes.position;if(a){var b=this.boundingSphere.center;Gg.setFromBufferAttribute(a);Gg.getCenter(b);for(var c=0,d=0,e=a.count;d<e;d++)je.x=a.getX(d),je.y=a.getY(d),je.z=a.getZ(d),c=Math.max(c,b.distanceToSquared(je));this.boundingSphere.radius=Math.sqrt(c);isNaN(this.boundingSphere.radius)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=
this.attributes;if(b.position){var c=b.position.array;if(void 0===b.normal)this.addAttribute("normal",new X(new Float32Array(c.length),3));else for(var d=b.normal.array,e=0,f=d.length;e<f;e++)d[e]=0;d=b.normal.array;var g=new n,h=new n,k=new n,m=new n,l=new n;if(a){var p=a.array;e=0;for(f=a.count;e<f;e+=3){a=3*p[e+0];var w=3*p[e+1];var v=3*p[e+2];g.fromArray(c,a);h.fromArray(c,w);k.fromArray(c,v);m.subVectors(k,h);l.subVectors(g,h);m.cross(l);d[a]+=m.x;d[a+1]+=m.y;d[a+2]+=m.z;d[w]+=m.x;d[w+1]+=m.y;
d[w+2]+=m.z;d[v]+=m.x;d[v+1]+=m.y;d[v+2]+=m.z}}else for(e=0,f=c.length;e<f;e+=9)g.fromArray(c,e),h.fromArray(c,e+3),k.fromArray(c,e+6),m.subVectors(k,h),l.subVectors(g,h),m.cross(l),d[e]=m.x,d[e+1]=m.y,d[e+2]=m.z,d[e+3]=m.x,d[e+4]=m.y,d[e+5]=m.z,d[e+6]=m.x,d[e+7]=m.y,d[e+8]=m.z;this.normalizeNormals();b.normal.needsUpdate=!0}},merge:function(a,b){if(a&&a.isBufferGeometry){void 0===b&&(b=0);var c=this.attributes,d;for(d in c)if(void 0!==a.attributes[d]){var e=c[d].array,f=a.attributes[d],g=f.array,
h=0;for(f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h]}return this}},normalizeNormals:(Ab=new n,function(){for(var a=this.attributes.normal,b=0,c=a.count;b<c;b++)Ab.x=a.getX(b),Ab.y=a.getY(b),Ab.z=a.getZ(b),Ab.normalize(),a.setXYZ(b,Ab.x,Ab.y,Ab.z)}),toNonIndexed:function(){if(null===this.index)return this;var a=new F,b=this.index.array,c=this.attributes,d;for(d in c){var e=c[d],f=e.array,g=e.itemSize,h=new f.constructor(b.length*g),k=0;e=0;for(var m=b.length;e<m;e++){var l=b[e]*g;for(var p=0;p<g;p++)h[k++]=
f[l++]}a.addAttribute(d,new X(h,g))}b=this.groups;e=0;for(m=b.length;e<m;e++)c=b[e],a.addGroup(c.start,c.count,c.materialIndex);return a},toJSON:function(){var a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),0<Object.keys(this.userData).length&&(a.userData=this.userData),void 0!==this.parameters){var b=this.parameters;for(e in b)void 0!==b[e]&&(a[e]=b[e]);return a}a.data={attributes:{}};var c=
this.index;null!==c&&(b=Array.prototype.slice.call(c.array),a.data.index={type:c.array.constructor.name,array:b});c=this.attributes;for(e in c){var d=c[e];b=Array.prototype.slice.call(d.array);a.data.attributes[e]={itemSize:d.itemSize,type:d.array.constructor.name,array:b,normalized:d.normalized}}var e=this.groups;0<e.length&&(a.data.groups=JSON.parse(JSON.stringify(e)));e=this.boundingSphere;return null!==e&&(a.data.boundingSphere={center:e.center.toArray(),radius:e.radius}),a},clone:function(){return(new F).copy(this)},
copy:function(a){var b;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var c=a.index;null!==c&&this.setIndex(c.clone());c=a.attributes;for(g in c)this.addAttribute(g,c[g].clone());var d=a.morphAttributes;for(g in d){var e=[],f=d[g];c=0;for(b=f.length;c<b;c++)e.push(f[c].clone());this.morphAttributes[g]=e}var g=a.groups;c=0;for(b=g.length;c<b;c++)d=g[c],this.addGroup(d.start,d.count,d.materialIndex);g=a.boundingBox;
null!==g&&(this.boundingBox=g.clone());g=a.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});mc.prototype=Object.create(J.prototype);mc.prototype.constructor=mc;Lb.prototype=Object.create(F.prototype);Lb.prototype.constructor=Lb;kd.prototype=Object.create(J.prototype);kd.prototype.constructor=kd;Mb.prototype=Object.create(F.prototype);
Mb.prototype.constructor=Mb;var Ij=0,le,kf,me,lf,bj,ne,mf,oe,pe,nf,cj,qe,Vc,Wc,Xc,of,Mg,dc,ec,Ng,pf,qf,rf,Og,Pg;U.prototype=Object.assign(Object.create(Ja.prototype),{constructor:U,isMaterial:!0,onBeforeCompile:function(){},setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0!==c)if("shading"!==b){var d=this[b];void 0!==d&&(d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]=c)}else this.flatShading=1===c}},toJSON:function(a){function b(a){var b=[],c;for(c in a){var d=
a[c];delete d.metadata;b.push(d)}return b}var c=void 0===a||"string"==typeof a;c&&(a={textures:{},images:{}});var d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),void 0!==this.roughness&&(d.roughness=this.roughness),void 0!==this.metalness&&(d.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),
1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),void 0!==this.clearCoat&&(d.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(d.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&
(d.lightMap=this.lightMap.toJSON(a).uuid),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(a).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(a).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,
d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&
(d.envMap=this.envMap.toJSON(a).uuid,d.reflectivity=this.reflectivity,void 0!==this.combine&&(d.combine=this.combine),void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.size&&(d.size=this.size),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(d.blending=this.blending),!0===this.flatShading&&(d.flatShading=this.flatShading),0!==
this.side&&(d.side=this.side),0!==this.vertexColors&&(d.vertexColors=this.vertexColors),1>this.opacity&&(d.opacity=this.opacity),!0===this.transparent&&(d.transparent=this.transparent),d.depthFunc=this.depthFunc,d.depthTest=this.depthTest,d.depthWrite=this.depthWrite,0!==this.rotation&&(d.rotation=this.rotation),!0===this.polygonOffset&&(d.polygonOffset=!0),0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits),
1!==this.linewidth&&(d.linewidth=this.linewidth),void 0!==this.dashSize&&(d.dashSize=this.dashSize),void 0!==this.gapSize&&(d.gapSize=this.gapSize),void 0!==this.scale&&(d.scale=this.scale),!0===this.dithering&&(d.dithering=!0),0<this.alphaTest&&(d.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(d.wireframe=this.wireframe),1<this.wireframeLinewidth&&(d.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&
(d.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(d.morphTargets=!0),!0===this.skinning&&(d.skinning=!0),!1===this.visible&&(d.visible=!1),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),c)c=b(a.textures),a=b(a.images),0<c.length&&(d.textures=c),0<a.length&&(d.images=a);return d},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.fog=a.fog;
this.lights=a.lights;this.blending=a.blending;this.side=a.side;this.flatShading=a.flatShading;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.colorWrite=a.colorWrite;this.precision=
a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.visible=a.visible;this.userData=JSON.parse(JSON.stringify(a.userData));this.clipShadows=a.clipShadows;this.clipIntersection=a.clipIntersection;var b=a.clippingPlanes,c=null;if(null!==b){var d=b.length;c=Array(d);for(var e=0;e!==d;++e)c[e]=b[e].clone()}return this.clippingPlanes=
c,this.shadowSide=a.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Ea.prototype=Object.create(U.prototype);Ea.prototype.constructor=Ea;Ea.prototype.isShaderMaterial=!0;Ea.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=kc(a.uniforms),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.lights=a.lights,this.clipping=
a.clipping,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.extensions=a.extensions,this};Ea.prototype.toJSON=function(a){var b=U.prototype.toJSON.call(this,a),c;for(c in b.uniforms={},this.uniforms){var d=this.uniforms[c].value;d.isTexture?b.uniforms[c]={type:"t",value:d.toJSON(a).uuid}:d.isColor?b.uniforms[c]={type:"c",value:d.getHex()}:d.isVector2?b.uniforms[c]={type:"v2",value:d.toArray()}:d.isVector3?b.uniforms[c]={type:"v3",value:d.toArray()}:d.isVector4?
b.uniforms[c]={type:"v4",value:d.toArray()}:d.isMatrix4?b.uniforms[c]={type:"m4",value:d.toArray()}:b.uniforms[c]={value:d}}return 0<Object.keys(this.defines).length&&(b.defines=this.defines),b.vertexShader=this.vertexShader,b.fragmentShader=this.fragmentShader,b};Object.assign(Nb.prototype,{set:function(a,b){return this.origin.copy(a),this.direction.copy(b),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),
this},at:function(a,b){return void 0===b&&(b=new n),b.copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){return this.direction.copy(a).sub(this.origin).normalize(),this},recast:(cj=new n,function(a){return this.origin.copy(this.at(a,cj)),this}),closestPointToPoint:function(a,b){void 0===b&&(b=new n);b.subVectors(a,this.origin);a=b.dot(this.direction);return 0>a?b.copy(this.origin):b.copy(this.direction).multiplyScalar(a).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},
distanceSqToPoint:(nf=new n,function(a){var b=nf.subVectors(a,this.origin).dot(this.direction);return 0>b?this.origin.distanceToSquared(a):(nf.copy(this.direction).multiplyScalar(b).add(this.origin),nf.distanceToSquared(a))}),distanceSqToSegment:(mf=new n,oe=new n,pe=new n,function(a,b,c,d){mf.copy(a).add(b).multiplyScalar(.5);oe.copy(b).sub(a).normalize();pe.copy(this.origin).sub(mf);var e,f,g=.5*a.distanceTo(b);b=-this.direction.dot(oe);var h=pe.dot(this.direction),k=-pe.dot(oe),m=pe.lengthSq(),
l=Math.abs(1-b*b);0<l?(a=b*h-k,f=g*l,0<=(e=b*k-h))?-f<=a?a<=f?(f=1/l,b=(e*=f)*(e+b*(a*=f)+2*h)+a*(b*e+a+2*k)+m):(a=g,b=-(e=Math.max(0,-(b*a+h)))*e+a*(a+2*k)+m):(a=-g,b=-(e=Math.max(0,-(b*a+h)))*e+a*(a+2*k)+m):b=a<=-f?-(e=Math.max(0,-(-b*g+h)))*e+(a=0<e?-g:Math.min(Math.max(-g,-k),g))*(a+2*k)+m:a<=f?(e=0,(a=Math.min(Math.max(-g,-k),g))*(a+2*k)+m):-(e=Math.max(0,-(b*g+h)))*e+(a=0<e?g:Math.min(Math.max(-g,-k),g))*(a+2*k)+m:(a=0<b?-g:g,b=-(e=Math.max(0,-(b*a+h)))*e+a*(a+2*k)+m);return c&&c.copy(this.direction).multiplyScalar(e).add(this.origin),
d&&d.copy(oe).multiplyScalar(a).add(mf),b}),intersectSphere:(ne=new n,function(a,b){ne.subVectors(a.center,this.origin);var c=ne.dot(this.direction),d=ne.dot(ne)-c*c;a=a.radius*a.radius;if(a<d)return null;a=Math.sqrt(a-d);d=c-a;c+=a;return 0>d&&0>c?null:0>d?this.at(c,b):this.at(d,b)}),intersectsSphere:function(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+
a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){a=this.distanceToPlane(a);return null===a?null:this.at(a,b)},intersectsPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b},intersectBox:function(a,b){var c,d,e,f,g,h,k=1/this.direction.x,m=1/this.direction.y,l=1/this.direction.z,p=this.origin;return d=0<=k?(c=(a.min.x-p.x)*k,(a.max.x-p.x)*k):(c=(a.max.x-p.x)*k,(a.min.x-p.x)*k),(f=0<=m?(e=(a.min.y-p.y)*m,(a.max.y-p.y)*m):(e=(a.max.y-p.y)*
m,(a.min.y-p.y)*m))<c||d<e?null:((c<e||c!=c)&&(c=e),(f<d||d!=d)&&(d=f),(h=0<=l?(g=(a.min.z-p.z)*l,(a.max.z-p.z)*l):(g=(a.max.z-p.z)*l,(a.min.z-p.z)*l))<c||d<g?null:((c<g||c!=c)&&(c=g),(h<d||d!=d)&&(d=h),0>d?null:this.at(0<=c?c:d,b)))},intersectsBox:(bj=new n,function(a){return null!==this.intersectBox(a,bj)}),intersectTriangle:(le=new n,kf=new n,me=new n,lf=new n,function(a,b,c,d,e){kf.subVectors(b,a);me.subVectors(c,a);lf.crossVectors(kf,me);b=this.direction.dot(lf);if(0<b){if(d)return null;d=1}else{if(!(0>
b))return null;d=-1;b=-b}le.subVectors(this.origin,a);a=d*this.direction.dot(me.crossVectors(le,me));if(0>a)return null;c=d*this.direction.dot(kf.cross(le));if(0>c||b<a+c)return null;a=-d*le.dot(lf);return 0>a?null:this.at(a/b,e)}),applyMatrix4:function(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}});Object.assign(sa,{getNormal:(Mg=new n,function(a,b,c,d){void 0===d&&(d=new n);
d.subVectors(c,b);Mg.subVectors(a,b);d.cross(Mg);a=d.lengthSq();return 0<a?d.multiplyScalar(1/Math.sqrt(a)):d.set(0,0,0)}),getBarycoord:(Wc=new n,Xc=new n,of=new n,function(a,b,c,d,e){Wc.subVectors(d,b);Xc.subVectors(c,b);of.subVectors(a,b);a=Wc.dot(Wc);b=Wc.dot(Xc);c=Wc.dot(of);var f=Xc.dot(Xc);d=Xc.dot(of);var g=a*f-b*b;if(void 0===e&&(e=new n),0===g)return e.set(-2,-1,-1);g=1/g;f=(f*c-b*d)*g;a=(a*d-b*c)*g;return e.set(1-f-a,a,f)}),containsPoint:(Vc=new n,function(a,b,c,d){return sa.getBarycoord(a,
b,c,d,Vc),0<=Vc.x&&0<=Vc.y&&1>=Vc.x+Vc.y}),getUV:(qe=new n,function(a,b,c,d,e,f,g,h){return this.getBarycoord(a,b,c,d,qe),h.set(0,0),h.addScaledVector(e,qe.x),h.addScaledVector(f,qe.y),h.addScaledVector(g,qe.z),h})});Object.assign(sa.prototype,{set:function(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this},setFromPointsAndIndices:function(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.a.copy(a.a),
this.b.copy(a.b),this.c.copy(a.c),this},getArea:(Og=new n,Pg=new n,function(){return Og.subVectors(this.c,this.b),Pg.subVectors(this.a,this.b),.5*Og.cross(Pg).length()}),getMidpoint:function(a){return void 0===a&&(a=new n),a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(a){return sa.getNormal(this.a,this.b,this.c,a)},getPlane:function(a){return void 0===a&&(a=new n),a.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(a,b){return sa.getBarycoord(a,this.a,
this.b,this.c,b)},containsPoint:function(a){return sa.containsPoint(a,this.a,this.b,this.c)},getUV:function(a,b,c,d,e){return sa.getUV(a,this.a,this.b,this.c,b,c,d,e)},intersectsBox:function(a){return a.intersectsTriangle(this)},closestPointToPoint:(dc=new n,ec=new n,Ng=new n,pf=new n,qf=new n,rf=new n,function(a,b){void 0===b&&(b=new n);var c,d,e=this.a,f=this.b,g=this.c;dc.subVectors(f,e);ec.subVectors(g,e);pf.subVectors(a,e);var h=dc.dot(pf),k=ec.dot(pf);if(0>=h&&0>=k)return b.copy(e);qf.subVectors(a,
f);var m=dc.dot(qf),l=ec.dot(qf);if(0<=m&&l<=m)return b.copy(f);var p=h*l-m*k;if(0>=p&&0<=h&&0>=m)return c=h/(h-m),b.copy(e).addScaledVector(dc,c);rf.subVectors(a,g);a=dc.dot(rf);var w=ec.dot(rf);if(0<=w&&a<=w)return b.copy(g);h=a*k-h*w;if(0>=h&&0<=k&&0>=w)return d=k/(k-w),b.copy(e).addScaledVector(ec,d);k=m*w-a*l;if(0>=k&&0<=l-m&&0<=a-w)return Ng.subVectors(g,f),d=(l-m)/(l-m+(a-w)),b.copy(f).addScaledVector(Ng,d);f=1/(k+h+p);return c=h*f,d=p*f,b.copy(e).addScaledVector(dc,c).addScaledVector(ec,d)}),
equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}});Ha.prototype=Object.create(U.prototype);Ha.prototype.constructor=Ha;Ha.prototype.isMeshBasicMaterial=!0;Ha.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=
a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this};wa.prototype=Object.assign(Object.create(E.prototype),{constructor:wa,isMesh:!0,setDrawMode:function(a){this.drawMode=a},copy:function(a){return E.prototype.copy.call(this,a),this.drawMode=a.drawMode,
void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this},updateMorphTargets:function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=Object.keys(a);if(0<b.length){var c=a[b[0]];if(void 0!==c)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++){var d=c[a].name||String(a);this.morphTargetInfluences.push(0);
this.morphTargetDictionary[d]=a}}}else if(c=a.morphTargets,void 0!==c&&0<c.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++)d=c[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=a},raycast:function(){function a(a,b,c,d,e,f,g,h){if(null===(1===b.side?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,2!==b.side,h)))return null;t.copy(h);t.applyMatrix4(a.matrixWorld);b=c.ray.origin.distanceTo(t);return b<c.near||b>
c.far?null:{distance:b,point:t.clone(),object:a}}function b(b,c,d,e,k,m,l,q,n){f.fromBufferAttribute(k,l);g.fromBufferAttribute(k,q);h.fromBufferAttribute(k,n);if(b=a(b,c,d,e,f,g,h,u))m&&(p.fromBufferAttribute(m,l),w.fromBufferAttribute(m,q),v.fromBufferAttribute(m,n),b.uv=sa.getUV(u,f,g,h,p,w,v,new x)),m=new lc(l,q,n),sa.getNormal(f,g,h,m.normal),b.face=m;return b}var c=new I,d=new Nb,e=new Ka,f=new n,g=new n,h=new n,k=new n,m=new n,l=new n,p=new x,w=new x,v=new x,u=new n,t=new n;return function(q,
n){var t,r=this.geometry,D=this.material,T=this.matrixWorld;if(void 0!==D&&(null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere),e.applyMatrix4(T),!1!==q.ray.intersectsSphere(e)&&(c.getInverse(T),d.copy(q.ray).applyMatrix4(c),null===r.boundingBox||!1!==d.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var z,A,B,C=r.index;T=r.attributes.position;var E=r.attributes.uv,G=r.groups,F=r.drawRange;if(null!==C)if(Array.isArray(D))for(r=0,A=G.length;r<A;r++){var J=D[(z=G[r]).materialIndex];
var H=Math.max(z.start,F.start);for(B=Math.min(z.start+z.count,F.start+F.count);H<B;H+=3){z=C.getX(H);var I=C.getX(H+1);var L=C.getX(H+2);(t=b(this,J,q,d,T,E,z,I,L))&&(t.faceIndex=Math.floor(H/3),n.push(t))}}else for(r=Math.max(0,F.start),A=Math.min(C.count,F.start+F.count);r<A;r+=3)z=C.getX(r),I=C.getX(r+1),L=C.getX(r+2),(t=b(this,D,q,d,T,E,z,I,L))&&(t.faceIndex=Math.floor(r/3),n.push(t));else if(void 0!==T)if(Array.isArray(D))for(r=0,A=G.length;r<A;r++)for(J=D[(z=G[r]).materialIndex],H=Math.max(z.start,
F.start),B=Math.min(z.start+z.count,F.start+F.count);H<B;H+=3)(t=b(this,J,q,d,T,E,H,H+1,H+2))&&(t.faceIndex=Math.floor(H/3),n.push(t));else for(r=Math.max(0,F.start),A=Math.min(T.count,F.start+F.count);r<A;r+=3)(t=b(this,D,q,d,T,E,r,r+1,r+2))&&(t.faceIndex=Math.floor(r/3),n.push(t))}else if(r.isGeometry)for(T=Array.isArray(D),E=r.vertices,G=r.faces,t=r.faceVertexUvs[0],0<t.length&&(C=t),F=0,z=G.length;F<z;F++)if(I=G[F],t=T?D[I.materialIndex]:D,void 0!==t){if(H=E[I.a],A=E[I.b],J=E[I.c],!0===t.morphTargets){L=
r.morphTargets;B=this.morphTargetInfluences;f.set(0,0,0);g.set(0,0,0);h.set(0,0,0);for(var P=0,S=L.length;P<S;P++){var Q=B[P];if(0!==Q){var U=L[P].vertices;f.addScaledVector(k.subVectors(U[I.a],H),Q);g.addScaledVector(m.subVectors(U[I.b],A),Q);h.addScaledVector(l.subVectors(U[I.c],J),Q)}}f.add(H);g.add(A);h.add(J);H=f;A=g;J=h}if(t=a(this,t,q,d,H,A,J,u))C&&C[F]&&(L=C[F],p.copy(L[0]),w.copy(L[1]),v.copy(L[2]),t.uv=sa.getUV(u,H,A,J,p,w,v,new x)),t.face=I,t.faceIndex=F,n.push(t)}}}(),clone:function(){return(new this.constructor(this.geometry,
this.material)).copy(this)}});gb.prototype=Object.create(Z.prototype);gb.prototype.constructor=gb;gb.prototype.isCubeTexture=!0;Object.defineProperty(gb.prototype,"images",{get:function(){return this.image},set:function(a){this.image=a}});nc.prototype=Object.create(Z.prototype);nc.prototype.constructor=nc;nc.prototype.isDataTexture3D=!0;var Ih=new Z,ek=new nc,Jh=new gb,Ch=[],Eh=[],Hh=new Float32Array(16),Gh=new Float32Array(9),Fh=new Float32Array(4);Nh.prototype.updateCache=function(a){var b=this.cache;
a instanceof Float32Array&&b.length!==a.length&&(this.cache=new Float32Array(a.length));na(b,a)};Oh.prototype.setValue=function(a,b,c){for(var d=this.seq,e=0,f=d.length;e!==f;++e){var g=d[e];g.setValue(a,b[g.id],c)}};var Ff=/([\w\d_]+)(\])?(\[|\.)?/g;rb.prototype.setValue=function(a,b,c){b=this.map[b];void 0!==b&&b.setValue(a,c,this.renderer)};rb.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};rb.upload=function(a,b,c,d){for(var e=0,f=b.length;e!==f;++e){var g=b[e],
h=c[g.id];!1!==h.needsUpdate&&g.setValue(a,h.value,d)}};rb.seqWithValue=function(a,b){for(var c=[],d=0,e=a.length;d!==e;++d){var f=a[d];f.id in b&&c.push(f)}return c};var yk=0,Gk=0;sb.prototype=Object.create(U.prototype);sb.prototype.constructor=sb;sb.prototype.isMeshDepthMaterial=!0;sb.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.depthPacking=a.depthPacking,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=
a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this};tb.prototype=Object.create(U.prototype);tb.prototype.constructor=tb;tb.prototype.isMeshDistanceMaterial=!0;tb.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.referencePosition.copy(a.referencePosition),this.nearDistance=a.nearDistance,this.farDistance=a.farDistance,this.skinning=a.skinning,this.morphTargets=
a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this};pc.prototype=Object.assign(Object.create(E.prototype),{constructor:pc,isGroup:!0});Za.prototype=Object.assign(Object.create(E.prototype),{constructor:Za,isCamera:!0,copy:function(a,b){return E.prototype.copy.call(this,a,b),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),
this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this},getWorldDirection:function(a){void 0===a&&(a=new n);this.updateMatrixWorld(!0);var b=this.matrixWorld.elements;return a.set(-b[8],-b[9],-b[10]).normalize()},updateMatrixWorld:function(a){E.prototype.updateMatrixWorld.call(this,a);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});ja.prototype=Object.assign(Object.create(Za.prototype),{constructor:ja,isPerspectiveCamera:!0,
copy:function(a,b){return Za.prototype.copy.call(this,a,b),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this},setFocalLength:function(a){a=.5*this.getFilmHeight()/a;this.fov=2*Q.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()},getFocalLength:function(){var a=Math.tan(.5*Q.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*
Q.RAD2DEG*Math.atan(Math.tan(.5*Q.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=
f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=this.near,b=a*Math.tan(.5*Q.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,f=this.view;if(null!==this.view&&this.view.enabled){var g=f.fullWidth,h=f.fullHeight;e+=f.offsetX*d/g;b-=f.offsetY*c/h;d*=f.width/g;c*=f.height/h}f=this.filmOffset;0!==f&&(e+=a*f/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,
b,b-c,a,this.far);this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(a){a=E.prototype.toJSON.call(this,a);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,null!==this.view&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}});nd.prototype=Object.assign(Object.create(ja.prototype),{constructor:nd,isArrayCamera:!0});
var $h=new n,ai=new n,sc,Qg,Rg,Sg,Tg,dj,Ug,re,Yc,Vg,Wg,se,te,Xg,sf,Zc;qc.prototype.isFogExp2=!0;qc.prototype.clone=function(){return new qc(this.color,this.density)};qc.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};rc.prototype.isFog=!0;rc.prototype.clone=function(){return new rc(this.color,this.near,this.far)};rc.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};Ge.prototype=Object.assign(Object.create(E.prototype),
{constructor:Ge,copy:function(a,b){return E.prototype.copy.call(this,a,b),null!==a.background&&(this.background=a.background.clone()),null!==a.fog&&(this.fog=a.fog.clone()),null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone()),this.autoUpdate=a.autoUpdate,this.matrixAutoUpdate=a.matrixAutoUpdate,this},toJSON:function(a){var b=E.prototype.toJSON.call(this,a);return null!==this.background&&(b.object.background=this.background.toJSON(a)),null!==this.fog&&(b.object.fog=this.fog.toJSON()),
b}});Object.defineProperty(Ob.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(Ob.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==a?a.length/this.stride:0,this.array=a,this},setDynamic:function(a){return this.dynamic=a,this},copy:function(a){return this.array=new a.array.constructor(a.array),this.count=a.count,
this.stride=a.stride,this.dynamic=a.dynamic,this},copyAt:function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){return void 0===b&&(b=0),this.array.set(a,b),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(a){return this.onUploadCallback=a,this}});Object.defineProperties(od.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(od.prototype,
{isInterleavedBufferAttribute:!0,setX:function(a,b){return this.data.array[a*this.data.stride+this.offset]=b,this},setY:function(a,b){return this.data.array[a*this.data.stride+this.offset+1]=b,this},setZ:function(a,b){return this.data.array[a*this.data.stride+this.offset+2]=b,this},setW:function(a,b){return this.data.array[a*this.data.stride+this.offset+3]=b,this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+
1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this},setXYZ:function(a,b,c,d){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this},setXYZW:function(a,b,c,d,e){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+
1]=c,this.data.array[a+2]=d,this.data.array[a+3]=e,this}});ib.prototype=Object.create(U.prototype);ib.prototype.constructor=ib;ib.prototype.isSpriteMaterial=!0;ib.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this};vb.prototype=Object.assign(Object.create(E.prototype),{constructor:vb,isSprite:!0,raycast:function(){function a(a,b,c,d,h,k){e.subVectors(a,c).addScalar(.5).multiply(d);
void 0!==h?(f.x=k*e.x-h*e.y,f.y=h*e.x+k*e.y):f.copy(e);a.copy(b);a.x+=f.x;a.y+=f.y;a.applyMatrix4(g)}var b=new n,c=new n,d=new n,e=new x,f=new x,g=new I,h=new n,k=new n,m=new n,l=new x,p=new x,w=new x;return function(e,f){c.setFromMatrixScale(this.matrixWorld);g.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld);d.setFromMatrixPosition(this.modelViewMatrix);this.material.sizeAttenuation||c.multiplyScalar(-d.z);var q,n,u=this.material.rotation;0!==u&&(n=Math.cos(u),q=Math.sin(u));u=this.center;
a(h.set(-.5,-.5,0),d,u,c,q,n);a(k.set(.5,-.5,0),d,u,c,q,n);a(m.set(.5,.5,0),d,u,c,q,n);l.set(0,0);p.set(1,0);w.set(1,1);if(null!==e.ray.intersectTriangle(h,k,m,!1,b)||(a(k.set(-.5,.5,0),d,u,c,q,n),p.set(0,1),null!==e.ray.intersectTriangle(h,m,k,!1,b)))q=e.ray.origin.distanceTo(b),q<e.near||q>e.far||f.push({distance:q,point:b.clone(),uv:sa.getUV(b,h,k,m,l,p,w,new x),face:null,object:this})}}(),clone:function(){return(new this.constructor(this.material)).copy(this)},copy:function(a){return E.prototype.copy.call(this,
a),void 0!==a.center&&this.center.copy(a.center),this}});pd.prototype=Object.assign(Object.create(E.prototype),{constructor:pd,copy:function(a){E.prototype.copy.call(this,a,!1);a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this},addLevel:function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a});this.add(a)},getObjectForDistance:function(a){for(var b=this.levels,
c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object},raycast:(Sg=new n,function(a,b){Sg.setFromMatrixPosition(this.matrixWorld);var c=a.ray.origin.distanceTo(Sg);this.getObjectForDistance(c).raycast(a,b)}),update:(Qg=new n,Rg=new n,function(a){var b=this.levels;if(1<b.length){Qg.setFromMatrixPosition(a.matrixWorld);Rg.setFromMatrixPosition(this.matrixWorld);a=Qg.distanceTo(Rg);b[0].object.visible=!0;for(var c=1,d=b.length;c<d&&a>=b[c].distance;c++)b[c-1].object.visible=!1,b[c].object.visible=
!0;for(;c<d;c++)b[c].object.visible=!1}}),toJSON:function(a){a=E.prototype.toJSON.call(this,a);a.object.levels=[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a}});qd.prototype=Object.assign(Object.create(wa.prototype),{constructor:qd,isSkinnedMesh:!0,bind:function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)},
pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var a=new da,b=this.geometry.attributes.skinWeight,c=0,d=b.count;c<d;c++){a.x=b.getX(c);a.y=b.getY(c);a.z=b.getZ(c);a.w=b.getW(c);var e=1/a.manhattanLength();e!==1/0?a.multiplyScalar(e):a.set(1,0,0,0);b.setXYZW(c,a.x,a.y,a.z,a.w)}},updateMatrixWorld:function(a){wa.prototype.updateMatrixWorld.call(this,a);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode&&this.bindMatrixInverse.getInverse(this.bindMatrix)},
clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});Object.assign(He.prototype,{calculateInverses:function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new I;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}},pose:function(){var a,b;var c=0;for(b=this.bones.length;c<b;c++)(a=this.bones[c])&&a.matrixWorld.getInverse(this.boneInverses[c]);c=0;for(b=this.bones.length;c<b;c++)(a=this.bones[c])&&(a.parent&&a.parent.isBone?
(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))},update:(Tg=new I,dj=new I,function(){for(var a=this.bones,b=this.boneInverses,c=this.boneMatrices,d=this.boneTexture,e=0,f=a.length;e<f;e++)Tg.multiplyMatrices(a[e]?a[e].matrixWorld:dj,b[e]),Tg.toArray(c,16*e);void 0!==d&&(d.needsUpdate=!0)}),clone:function(){return new He(this.bones,this.boneInverses)},getBoneByName:function(a){for(var b=
0,c=this.bones.length;b<c;b++){var d=this.bones[b];if(d.name===a)return d}}});Kf.prototype=Object.assign(Object.create(E.prototype),{constructor:Kf,isBone:!0});aa.prototype=Object.create(U.prototype);aa.prototype.constructor=aa;aa.prototype.isLineBasicMaterial=!0;aa.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this};xa.prototype=Object.assign(Object.create(E.prototype),{constructor:xa,
isLine:!0,computeLineDistances:(Vg=new n,Wg=new n,function(){var a=this.geometry;if(a.isBufferGeometry){if(null===a.index){for(var b=a.attributes.position,c=[0],d=1,e=b.count;d<e;d++)Vg.fromBufferAttribute(b,d-1),Wg.fromBufferAttribute(b,d),c[d]=c[d-1],c[d]+=Vg.distanceTo(Wg);a.addAttribute("lineDistance",new B(c,1))}}else if(a.isGeometry)for(b=a.vertices,(c=a.lineDistances)[0]=0,d=1,e=b.length;d<e;d++)c[d]=c[d-1],c[d]+=b[d-1].distanceTo(b[d]);return this}),raycast:(Ug=new I,re=new Nb,Yc=new Ka,function(a,
b){var c=a.linePrecision,d=this.geometry,e=this.matrixWorld;if(null===d.boundingSphere&&d.computeBoundingSphere(),Yc.copy(d.boundingSphere),Yc.applyMatrix4(e),Yc.radius+=c,!1!==a.ray.intersectsSphere(Yc)){Ug.getInverse(e);re.copy(a.ray).applyMatrix4(Ug);c/=(this.scale.x+this.scale.y+this.scale.z)/3;c*=c;var f=new n,g=new n;e=new n;var h=new n,k=this&&this.isLineSegments?2:1;if(d.isBufferGeometry){var m=d.index,l=d.attributes.position.array;if(null!==m){m=m.array;d=0;for(var p=m.length-1;d<p;d+=k){var w=
m[d+1];f.fromArray(l,3*m[d]);g.fromArray(l,3*w);c<re.distanceSqToSegment(f,g,h,e)||(h.applyMatrix4(this.matrixWorld),(r=a.ray.origin.distanceTo(h))<a.near||r>a.far||b.push({distance:r,point:e.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}}else for(d=0,p=l.length/3-1;d<p;d+=k)f.fromArray(l,3*d),g.fromArray(l,3*d+3),c<re.distanceSqToSegment(f,g,h,e)||(h.applyMatrix4(this.matrixWorld),(r=a.ray.origin.distanceTo(h))<a.near||r>a.far||b.push({distance:r,point:e.clone().applyMatrix4(this.matrixWorld),
index:d,face:null,faceIndex:null,object:this}))}else if(d.isGeometry)for(f=d.vertices,g=f.length,d=0;d<g-1;d+=k){var r;c<re.distanceSqToSegment(f[d],f[d+1],h,e)||(h.applyMatrix4(this.matrixWorld),(r=a.ray.origin.distanceTo(h))<a.near||r>a.far||b.push({distance:r,point:e.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}}}),copy:function(a){return E.prototype.copy.call(this,a),this.geometry.copy(a.geometry),this.material.copy(a.material),this},clone:function(){return(new this.constructor).copy(this)}});
ba.prototype=Object.assign(Object.create(xa.prototype),{constructor:ba,isLineSegments:!0,computeLineDistances:(se=new n,te=new n,function(){var a=this.geometry;if(a.isBufferGeometry){if(null===a.index){for(var b=a.attributes.position,c=[],d=0,e=b.count;d<e;d+=2)se.fromBufferAttribute(b,d),te.fromBufferAttribute(b,d+1),c[d]=0===d?0:c[d-1],c[d+1]=c[d]+se.distanceTo(te);a.addAttribute("lineDistance",new B(c,1))}}else if(a.isGeometry)for(b=a.vertices,c=a.lineDistances,d=0,e=b.length;d<e;d+=2)se.copy(b[d]),
te.copy(b[d+1]),c[d]=0===d?0:c[d-1],c[d+1]=c[d]+se.distanceTo(te);return this})});Ie.prototype=Object.assign(Object.create(xa.prototype),{constructor:Ie,isLineLoop:!0});La.prototype=Object.create(U.prototype);La.prototype.constructor=La;La.prototype.isPointsMaterial=!0;La.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.morphTargets=a.morphTargets,this};tc.prototype=Object.assign(Object.create(E.prototype),
{constructor:tc,isPoints:!0,raycast:(Xg=new I,sf=new Nb,Zc=new Ka,function(a,b){function c(c,e){var g=sf.distanceSqToPoint(c);g<h&&(sf.closestPointToPoint(c,k),k.applyMatrix4(f),c=a.ray.origin.distanceTo(k),c<a.near||c>a.far||b.push({distance:c,distanceToRay:Math.sqrt(g),point:k.clone(),index:e,face:null,object:d}))}var d=this,e=this.geometry,f=this.matrixWorld,g=a.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),Zc.copy(e.boundingSphere),Zc.applyMatrix4(f),Zc.radius+=
g,!1!==a.ray.intersectsSphere(Zc)){Xg.getInverse(f);sf.copy(a.ray).applyMatrix4(Xg);g/=(this.scale.x+this.scale.y+this.scale.z)/3;var h=g*g;g=new n;var k=new n;if(e.isBufferGeometry){var m=e.index;e=e.attributes.position.array;if(null!==m){var l=m.array;m=0;for(var p=l.length;m<p;m++){var w=l[m];g.fromArray(e,3*w);c(g,w)}}else for(m=0,l=e.length/3;m<l;m++)g.fromArray(e,3*m),c(g,m)}else for(g=e.vertices,m=0,l=g.length;m<l;m++)c(g[m],m)}}),clone:function(){return(new this.constructor(this.geometry,
this.material)).copy(this)}});Lf.prototype=Object.assign(Object.create(Z.prototype),{constructor:Lf,isVideoTexture:!0,update:function(){var a=this.image;a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});uc.prototype=Object.create(Z.prototype);uc.prototype.constructor=uc;uc.prototype.isCompressedTexture=!0;rd.prototype=Object.create(Z.prototype);rd.prototype.constructor=rd;rd.prototype.isCanvasTexture=!0;sd.prototype=Object.create(Z.prototype);sd.prototype.constructor=sd;sd.prototype.isDepthTexture=
!0;vc.prototype=Object.create(F.prototype);vc.prototype.constructor=vc;td.prototype=Object.create(J.prototype);td.prototype.constructor=td;wc.prototype=Object.create(F.prototype);wc.prototype.constructor=wc;ud.prototype=Object.create(J.prototype);ud.prototype.constructor=ud;ya.prototype=Object.create(F.prototype);ya.prototype.constructor=ya;vd.prototype=Object.create(J.prototype);vd.prototype.constructor=vd;xc.prototype=Object.create(ya.prototype);xc.prototype.constructor=xc;wd.prototype=Object.create(J.prototype);
wd.prototype.constructor=wd;Pb.prototype=Object.create(ya.prototype);Pb.prototype.constructor=Pb;xd.prototype=Object.create(J.prototype);xd.prototype.constructor=xd;yc.prototype=Object.create(ya.prototype);yc.prototype.constructor=yc;yd.prototype=Object.create(J.prototype);yd.prototype.constructor=yd;zc.prototype=Object.create(ya.prototype);zc.prototype.constructor=zc;zd.prototype=Object.create(J.prototype);zd.prototype.constructor=zd;Ac.prototype=Object.create(F.prototype);Ac.prototype.constructor=
Ac;Ad.prototype=Object.create(J.prototype);Ad.prototype.constructor=Ad;Bc.prototype=Object.create(F.prototype);Bc.prototype.constructor=Bc;Bd.prototype=Object.create(J.prototype);Bd.prototype.constructor=Bd;Cc.prototype=Object.create(F.prototype);Cc.prototype.constructor=Cc;var Yk={triangulate:function(a,b,c){c=c||2;var d,e,f,g=(d=b&&b.length)?b[0]*c:a.length,h=ci(a,0,g,c,!0),k=[];if(!h)return k;if(d){var m=c,l,p;var n=[];d=0;for(l=b.length;d<l;d++)(p=ci(a,b[d]*m,d<l-1?b[d+1]*m:a.length,m,!1))===
p.next&&(p.steiner=!0),n.push(Ok(p));n.sort(Mk);for(d=0;d<n.length;d++){b=n[d];p=h;if(p=Nk(b,p))b=fi(p,b),Dd(b,b.next);h=Dd(h,h.next)}}if(a.length>80*c){var r=d=a[0];var u=n=a[1];for(b=c;b<g;b+=c)(e=a[b])<r&&(r=e),(f=a[b+1])<u&&(u=f),d<e&&(d=e),n<f&&(n=f);var t=0!==(t=Math.max(d-r,n-u))?1/t:0}return Ed(h,k,c,r,u,t),k}},jb={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},isClockWise:function(a){return 0>jb.area(a)},triangulateShape:function(a,
b){var c=[],d=[],e=[];gi(a);hi(c,a);var f=a.length;b.forEach(gi);for(a=0;a<b.length;a++)d.push(f),f+=b[a].length,hi(c,b[a]);b=Yk.triangulate(c,d);for(a=0;a<b.length;a+=3)e.push(b.slice(a,a+3));return e}};Rb.prototype=Object.create(J.prototype);Rb.prototype.constructor=Rb;Rb.prototype.toJSON=function(){var a=J.prototype.toJSON.call(this);return ii(this.parameters.shapes,this.parameters.options,a)};$a.prototype=Object.create(F.prototype);$a.prototype.constructor=$a;$a.prototype.toJSON=function(){var a=
F.prototype.toJSON.call(this);return ii(this.parameters.shapes,this.parameters.options,a)};var Pk={generateTopUV:function(a,b,c,d,e){a=b[3*d];d=b[3*d+1];var f=b[3*e];e=b[3*e+1];return[new x(b[3*c],b[3*c+1]),new x(a,d),new x(f,e)]},generateSideWallUV:function(a,b,c,d,e,f){a=b[3*c];var g=b[3*c+1];c=b[3*c+2];var h=b[3*d],k=b[3*d+1];d=b[3*d+2];var m=b[3*e],l=b[3*e+1];e=b[3*e+2];var p=b[3*f],n=b[3*f+1];b=b[3*f+2];return.01>Math.abs(g-k)?[new x(a,1-c),new x(h,1-d),new x(m,1-e),new x(p,1-b)]:[new x(g,1-
c),new x(k,1-d),new x(l,1-e),new x(n,1-b)]}};Gd.prototype=Object.create(J.prototype);Gd.prototype.constructor=Gd;Dc.prototype=Object.create($a.prototype);Dc.prototype.constructor=Dc;Hd.prototype=Object.create(J.prototype);Hd.prototype.constructor=Hd;Sb.prototype=Object.create(F.prototype);Sb.prototype.constructor=Sb;Id.prototype=Object.create(J.prototype);Id.prototype.constructor=Id;Ec.prototype=Object.create(F.prototype);Ec.prototype.constructor=Ec;Jd.prototype=Object.create(J.prototype);Jd.prototype.constructor=
Jd;Fc.prototype=Object.create(F.prototype);Fc.prototype.constructor=Fc;Tb.prototype=Object.create(J.prototype);Tb.prototype.constructor=Tb;Tb.prototype.toJSON=function(){var a=J.prototype.toJSON.call(this);return ji(this.parameters.shapes,a)};Ub.prototype=Object.create(F.prototype);Ub.prototype.constructor=Ub;Ub.prototype.toJSON=function(){var a=F.prototype.toJSON.call(this);return ji(this.parameters.shapes,a)};Gc.prototype=Object.create(F.prototype);Gc.prototype.constructor=Gc;Vb.prototype=Object.create(J.prototype);
Vb.prototype.constructor=Vb;kb.prototype=Object.create(F.prototype);kb.prototype.constructor=kb;Kd.prototype=Object.create(Vb.prototype);Kd.prototype.constructor=Kd;Ld.prototype=Object.create(kb.prototype);Ld.prototype.constructor=Ld;Md.prototype=Object.create(J.prototype);Md.prototype.constructor=Md;Hc.prototype=Object.create(F.prototype);Hc.prototype.constructor=Hc;var Da=Object.freeze({WireframeGeometry:vc,ParametricGeometry:td,ParametricBufferGeometry:wc,TetrahedronGeometry:vd,TetrahedronBufferGeometry:xc,
OctahedronGeometry:wd,OctahedronBufferGeometry:Pb,IcosahedronGeometry:xd,IcosahedronBufferGeometry:yc,DodecahedronGeometry:yd,DodecahedronBufferGeometry:zc,PolyhedronGeometry:ud,PolyhedronBufferGeometry:ya,TubeGeometry:zd,TubeBufferGeometry:Ac,TorusKnotGeometry:Ad,TorusKnotBufferGeometry:Bc,TorusGeometry:Bd,TorusBufferGeometry:Cc,TextGeometry:Gd,TextBufferGeometry:Dc,SphereGeometry:Hd,SphereBufferGeometry:Sb,RingGeometry:Id,RingBufferGeometry:Ec,PlaneGeometry:kd,PlaneBufferGeometry:Mb,LatheGeometry:Jd,
LatheBufferGeometry:Fc,ShapeGeometry:Tb,ShapeBufferGeometry:Ub,ExtrudeGeometry:Rb,ExtrudeBufferGeometry:$a,EdgesGeometry:Gc,ConeGeometry:Kd,ConeBufferGeometry:Ld,CylinderGeometry:Vb,CylinderBufferGeometry:kb,CircleGeometry:Md,CircleBufferGeometry:Hc,BoxGeometry:mc,BoxBufferGeometry:Lb});Wb.prototype=Object.create(U.prototype);Wb.prototype.constructor=Wb;Wb.prototype.isShadowMaterial=!0;Wb.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.color.copy(a.color),this};Ic.prototype=Object.create(Ea.prototype);
Ic.prototype.constructor=Ic;Ic.prototype.isRawShaderMaterial=!0;ab.prototype=Object.create(U.prototype);ab.prototype.constructor=ab;ab.prototype.isMeshStandardMaterial=!0;ab.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),
this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapIntensity=a.envMapIntensity,this.refractionRatio=
a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};Xb.prototype=Object.create(ab.prototype);Xb.prototype.constructor=Xb;Xb.prototype.isMeshPhysicalMaterial=!0;Xb.prototype.copy=function(a){return ab.prototype.copy.call(this,a),this.defines={PHYSICAL:""},this.reflectivity=a.reflectivity,
this.clearCoat=a.clearCoat,this.clearCoatRoughness=a.clearCoatRoughness,this};Ma.prototype=Object.create(U.prototype);Ma.prototype.constructor=Ma;Ma.prototype.isMeshPhongMaterial=!0;Ma.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),
this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,
this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};Yb.prototype=Object.create(Ma.prototype);Yb.prototype.constructor=Yb;Yb.prototype.isMeshToonMaterial=!0;Yb.prototype.copy=function(a){return Ma.prototype.copy.call(this,a),this.gradientMap=a.gradientMap,this};Zb.prototype=Object.create(U.prototype);
Zb.prototype.constructor=Zb;Zb.prototype.isMeshNormalMaterial=!0;Zb.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.skinning=a.skinning,
this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};$b.prototype=Object.create(U.prototype);$b.prototype.constructor=$b;$b.prototype.isMeshLambertMaterial=!0;$b.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,
this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};ac.prototype=Object.create(U.prototype);ac.prototype.constructor=ac;ac.prototype.isMeshMatcapMaterial=
!0;ac.prototype.copy=function(a){return U.prototype.copy.call(this,a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.skinning=a.skinning,this.morphTargets=a.morphTargets,
this.morphNormals=a.morphNormals,this};bc.prototype=Object.create(aa.prototype);bc.prototype.constructor=bc;bc.prototype.isLineDashedMaterial=!0;bc.prototype.copy=function(a){return aa.prototype.copy.call(this,a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this};var Zk=Object.freeze({ShadowMaterial:Wb,SpriteMaterial:ib,RawShaderMaterial:Ic,ShaderMaterial:Ea,PointsMaterial:La,MeshPhysicalMaterial:Xb,MeshStandardMaterial:ab,MeshPhongMaterial:Ma,MeshToonMaterial:Yb,MeshNormalMaterial:Zb,
MeshLambertMaterial:$b,MeshDepthMaterial:sb,MeshDistanceMaterial:tb,MeshBasicMaterial:Ha,MeshMatcapMaterial:ac,LineDashedMaterial:bc,LineBasicMaterial:aa,Material:U}),ca={arraySlice:function(a,b,c){return ca.isTypedArray(a)?new a.constructor(a.subarray(b,void 0!==c?c:a.length)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"==typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof
DataView)},getKeyframeOrder:function(a){for(var b=a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;return c.sort(function(b,c){return a[b]-a[c]}),c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),f=0,g=0;g!==d;++f)for(var h=c[f]*b,k=0;k!==b;++k)e[g++]=a[h+k];return e},flattenJSON:function(a,b,c,d){for(var e=1,f=a[0];void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g))for(;void 0!==(g=f[d])&&(b.push(f.time),c.push.apply(c,g)),void 0!==(f=a[e++]););
else if(void 0!==g.toArray)for(;void 0!==(g=f[d])&&(b.push(f.time),g.toArray(c,c.length)),void 0!==(f=a[e++]););else for(;void 0!==(g=f[d])&&(b.push(f.time),c.push(g)),void 0!==(f=a[e++]););}}};Object.assign(Fa.prototype,{evaluate:function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;return c=b.length,this._cachedIndex=c,this.afterEnd_(c-1,a,e)}if(c===f)break;if(e=d,a<(d=b[++c]))break b}d=b.length;break c}if(e<=
a)break a;f=b[1];a<f&&(c=2,e=f);for(f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===f)break;if(d=e,(e=b[--c-1])<=a)break b}d=c;c=0}for(;c<d;)e=c+d>>>1,a<b[e]?d=e:c=e+1;if(d=b[c],void 0===(e=b[c-1]))return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return c=b.length,this._cachedIndex=c,this.afterEnd_(c-1,e,a)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||
this.DefaultSettings_},copySampleValue_:function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b},interpolate_:function(){throw Error("call to abstract method");},intervalChanged_:function(){}});Object.assign(Fa.prototype,{beforeStart_:Fa.prototype.copySampleValue_,afterEnd_:Fa.prototype.copySampleValue_});Ke.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Ke,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(a,
b,c){var d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=a;g=2*b-c;break;case 2402:g=b+d[e=d.length-2]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:f=a;h=2*c-b;break;case 2402:h=c+d[f=1]-d[0];break;default:f=a-1,h=b}a=.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-g);this._weightNext=a/(h-c);this._offsetPrev=e*d;this._offsetNext=f*d},interpolate_:function(a,b,c,d){var e=this.resultBuffer,
f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g,k=this._offsetPrev,m=this._offsetNext,l=this._weightPrev,p=this._weightNext,n=(c-b)/(d-b);c=n*n;d=c*n;b=-l*d+2*l*c-l*n;l=(1+l)*d+(-1.5-2*l)*c+(-.5+l)*n+1;n=(-1-p)*d+(1.5+p)*c+.5*n;p=p*d-p*c;for(c=0;c!==g;++c)e[c]=b*f[k+c]+l*f[h+c]+n*f[a+c]+p*f[m+c];return e}});Nd.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Nd,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g;b=(c-b)/(d-
b);c=1-b;for(d=0;d!==g;++d)e[d]=f[h+d]*c+f[a+d]*b;return e}});Le.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Le,interpolate_:function(a){return this.copySampleValue_(a-1)}});Object.assign(oa,{toJSON:function(a){var b=a.constructor;if(void 0!==b.toJSON)b=b.toJSON(a);else{b={name:a.name,times:ca.convertArray(a.times,Array),values:ca.convertArray(a.values,Array)};var c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}return b.type=a.ValueTypeName,b}});Object.assign(oa.prototype,
{constructor:oa,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(a){return new Le(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new Nd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new Ke(this.times,this.values,this.getValueSize(),a)},setInterpolation:function(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;
break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0!==b)return this.createInterpolant=b,this;b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(a===this.DefaultInterpolation)throw Error(b);this.setInterpolation(this.DefaultInterpolation)}return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;
case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this},scale:function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this},trim:function(a,b){for(var c=this.times,d=c.length,e=0,f=d-1;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;if(++f,0!==e||f!==d)f<=e&&(e=(f=
Math.max(f,1))-1),a=this.getValueSize(),this.times=ca.arraySlice(c,e,f),this.values=ca.arraySlice(this.values,e*a,f*a);return this},validate:function(){var a=!0,b=this.getValueSize();0!=b-Math.floor(b)&&(a=!1);var c=this.times;b=this.values;var d=c.length;0===d&&(a=!1);for(var e=null,f=0;f!==d;f++){var g=c[f];if("number"==typeof g&&isNaN(g)){a=!1;break}if(null!==e&&g<e){a=!1;break}e=g}if(void 0!==b&&ca.isTypedArray(b))for(f=0,c=b.length;f!==c;++f)if(isNaN(b[f])){a=!1;break}return a},optimize:function(){for(var a=
this.times,b=this.values,c=this.getValueSize(),d=2302===this.getInterpolation(),e=1,f=a.length-1,g=1;g<f;++g){var h=!1,k=a[g];if(k!==a[g+1]&&(1!==g||k!==k[0]))if(d)h=!0;else{var m=g*c,l=m-c,p=m+c;for(k=0;k!==c;++k){var n=b[m+k];if(n!==b[l+k]||n!==b[p+k]){h=!0;break}}}if(h){if(g!==e)for(a[e]=a[g],h=g*c,m=e*c,k=0;k!==c;++k)b[m+k]=b[h+k];++e}}if(0<f){a[e]=a[f];h=f*c;m=e*c;for(k=0;k!==c;++k)b[m+k]=b[h+k];++e}return e!==a.length&&(this.times=ca.arraySlice(a,0,e),this.values=ca.arraySlice(b,0,e*c)),this}});
Me.prototype=Object.assign(Object.create(oa.prototype),{constructor:Me,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});Ne.prototype=Object.assign(Object.create(oa.prototype),{constructor:Ne,ValueTypeName:"color"});Jc.prototype=Object.assign(Object.create(oa.prototype),{constructor:Jc,ValueTypeName:"number"});Oe.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Oe,interpolate_:function(a,
b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;b=(c-b)/(d-b);for(c=a+g;a!==c;a+=4)la.slerpFlat(e,0,f,a-g,f,a,b);return e}});Od.prototype=Object.assign(Object.create(oa.prototype),{constructor:Od,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(a){return new Oe(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:void 0});Pe.prototype=Object.assign(Object.create(oa.prototype),{constructor:Pe,ValueTypeName:"string",
ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});Kc.prototype=Object.assign(Object.create(oa.prototype),{constructor:Kc,ValueTypeName:"vector"});Object.assign(Na,{parse:function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,f=c.length;e!==f;++e)b.push(Rk(c[e]).scale(d));return new Na(a.name,a.duration,b)},toJSON:function(a){var b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid};for(var d=0,e=c.length;d!==
e;++d)b.push(oa.toJSON(c[d]));return a},CreateFromMorphTargetSequence:function(a,b,c,d){for(var e=b.length,f=[],g=0;g<e;g++){var h=[],k=[];h.push((g+e-1)%e,g,(g+1)%e);k.push(0,1,0);var m=ca.getKeyframeOrder(h);h=ca.sortedArray(h,1,m);k=ca.sortedArray(k,1,m);d||0!==h[0]||(h.push(e),k.push(k[0]));f.push((new Jc(".morphTargetInfluences["+b[g].name+"]",h,k)).scale(1/c))}return new Na(a,-1,f)},findByName:function(a,b){var c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(a=
0;a<c.length;a++)if(c[a].name===b)return c[a];return null},CreateClipsFromMorphTargetSequences:function(a,b,c){for(var d={},e=/^([\w-]*?)([\d]+)$/,f=0,g=a.length;f<g;f++){var h=a[f],k=h.name.match(e);k&&1<k.length&&((k=d[m=k[1]])||(d[m]=k=[]),k.push(h))}a=[];for(var m in d)a.push(Na.CreateFromMorphTargetSequence(m,d[m],b,c));return a},parseAnimation:function(a,b){if(!a)return null;var c=function(a,b,c,d,e){if(0!==c.length){var f=[],g=[];ca.flattenJSON(c,f,g,d);0!==f.length&&e.push(new a(b,f,g))}},
d=[],e=a.name||"default",f=a.length||-1,g=a.fps||30;a=a.hierarchy||[];for(var h=0;h<a.length;h++){var k=a[h].keys;if(k&&0!==k.length)if(k[0].morphTargets){f={};for(var m=0;m<k.length;m++)if(k[m].morphTargets)for(var l=0;l<k[m].morphTargets.length;l++)f[k[m].morphTargets[l]]=-1;for(var p in f){var n=[],r=[];for(l=0;l!==k[m].morphTargets.length;++l){var u=k[m];n.push(u.time);r.push(u.morphTarget===p?1:0)}d.push(new Jc(".morphTargetInfluence["+p+"]",n,r))}f=f.length*(g||1)}else m=".bones["+b[h].name+
"]",c(Kc,m+".position",k,"pos",d),c(Od,m+".quaternion",k,"rot",d),c(Kc,m+".scale",k,"scl",d)}return 0===d.length?null:new Na(e,f,d)}});Object.assign(Na.prototype,{resetDuration:function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b){var d=this.tracks[b];a=Math.max(a,d.times[d.times.length-1])}return this.duration=a,this},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},validate:function(){for(var a=!0,b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();
return a},optimize:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}});var fc={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}},za=new Of,Va={};Object.assign(Oa.prototype,{load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=fc.get(a);if(void 0!==
f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;if(void 0===Va[a]){var g=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){c=g[1];var h=!!g[2];g=g[3];g=decodeURIComponent(g);h&&(g=atob(g));try{var k=(this.responseType||"").toLowerCase();switch(k){case "arraybuffer":case "blob":var m=new Uint8Array(g.length);for(h=0;h<g.length;h++)m[h]=g.charCodeAt(h);var l="blob"===k?new Blob([m.buffer],{type:c}):m.buffer;break;case "document":l=(new DOMParser).parseFromString(g,
c);break;case "json":l=JSON.parse(g);break;default:l=g}setTimeout(function(){b&&b(l);e.manager.itemEnd(a)},0)}catch(w){setTimeout(function(){d&&d(w);e.manager.itemError(a);e.manager.itemEnd(a)},0)}}else{Va[a]=[];Va[a].push({onLoad:b,onProgress:c,onError:d});var p=new XMLHttpRequest;for(h in p.open("GET",a,!0),p.addEventListener("load",function(b){var c=this.response;fc.add(a,c);var d=Va[a];if(delete Va[a],200===this.status||0===this.status){this.status;for(var f=0,g=d.length;f<g;f++)(h=d[f]).onLoad&&
h.onLoad(c)}else{f=0;for(g=d.length;f<g;f++){var h;(h=d[f]).onError&&h.onError(b)}e.manager.itemError(a)}e.manager.itemEnd(a)},!1),p.addEventListener("progress",function(b){for(var c=Va[a],d=0,e=c.length;d<e;d++){var f=c[d];f.onProgress&&f.onProgress(b)}},!1),p.addEventListener("error",function(b){var c=Va[a];delete Va[a];for(var d=0,f=c.length;d<f;d++){var g=c[d];g.onError&&g.onError(b)}e.manager.itemError(a);e.manager.itemEnd(a)},!1),p.addEventListener("abort",function(b){var c=Va[a];delete Va[a];
for(var d=0,f=c.length;d<f;d++){var g=c[d];g.onError&&g.onError(b)}e.manager.itemError(a);e.manager.itemEnd(a)},!1),void 0!==this.responseType&&(p.responseType=this.responseType),void 0!==this.withCredentials&&(p.withCredentials=this.withCredentials),p.overrideMimeType&&p.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)p.setRequestHeader(h,this.requestHeader[h]);p.send(null)}return e.manager.itemStart(a),p}Va[a].push({onLoad:b,onProgress:c,onError:d})},setPath:function(a){return this.path=
a,this},setResponseType:function(a){return this.responseType=a,this},setWithCredentials:function(a){return this.withCredentials=a,this},setMimeType:function(a){return this.mimeType=a,this},setRequestHeader:function(a){return this.requestHeader=a,this}});Object.assign(ki.prototype,{load:function(a,b,c,d){var e=this,f=new Oa(e.manager);f.setPath(e.path);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a,b){for(var c=[],d=0;d<a.length;d++){var e=Na.parse(a[d]);c.push(e)}b(c)},setPath:function(a){return this.path=
a,this}});Object.assign(li.prototype,{load:function(a,b,c,d){function e(e){k.load(a[e],function(a){a=f._parser(a,!0);g[e]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};6===(m+=1)&&(1===a.mipmapCount&&(h.minFilter=1006),h.format=a.format,h.needsUpdate=!0,b&&b(h))},c,d)}var f=this,g=[],h=new uc;h.image=g;var k=new Oa(this.manager);if(k.setPath(this.path),k.setResponseType("arraybuffer"),Array.isArray(a))for(var m=0,l=0,p=a.length;l<p;++l)e(l);else k.load(a,function(a){a=f._parser(a,
!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};for(var e=0;e<a.mipmapCount;e++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+e]),g[d].format=a.format,g[d].width=a.width,g[d].height=a.height}else h.image.width=a.width,h.image.height=a.height,h.mipmaps=a.mipmaps;1===a.mipmapCount&&(h.minFilter=1006);h.format=a.format;h.needsUpdate=!0;b&&b(h)},c,d);return h},setPath:function(a){return this.path=a,this}});Object.assign(Pf.prototype,{load:function(a,b,c,d){var e=
this,f=new Hb,g=new Oa(this.manager);return g.setResponseType("arraybuffer"),g.setPath(this.path),g.load(a,function(a){(a=e._parser(a))&&(void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),f.wrapS=void 0!==a.wrapS?a.wrapS:1001,f.wrapT=void 0!==a.wrapT?a.wrapT:1001,f.magFilter=void 0!==a.magFilter?a.magFilter:1006,f.minFilter=void 0!==a.minFilter?a.minFilter:1008,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&
(f.format=a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===a.mipmapCount&&(f.minFilter=1006),f.needsUpdate=!0,b&&b(f,a))},c,d),f},setPath:function(a){return this.path=a,this}});Object.assign(Pd.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){function e(){k.removeEventListener("load",e,!1);k.removeEventListener("error",f,!1);fc.add(a,this);b&&b(this);g.manager.itemEnd(a)}function f(b){k.removeEventListener("load",e,!1);k.removeEventListener("error",
f,!1);d&&d(b);g.manager.itemError(a);g.manager.itemEnd(a)}void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var g=this,h=fc.get(a);if(void 0!==h)return g.manager.itemStart(a),setTimeout(function(){b&&b(h);g.manager.itemEnd(a)},0),h;var k=document.createElementNS("http://www.w3.org/1999/xhtml","img");return k.addEventListener("load",e,!1),k.addEventListener("error",f,!1),"data:"!==a.substr(0,5)&&void 0!==this.crossOrigin&&(k.crossOrigin=this.crossOrigin),g.manager.itemStart(a),
k.src=a,k},setCrossOrigin:function(a){return this.crossOrigin=a,this},setPath:function(a){return this.path=a,this}});Object.assign(Qf.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){function e(c){g.load(a[c],function(a){f.images[c]=a;6===++h&&(f.needsUpdate=!0,b&&b(f))},void 0,d)}var f=new gb,g=new Pd(this.manager);g.setCrossOrigin(this.crossOrigin);g.setPath(this.path);var h=0;for(c=0;c<a.length;++c)e(c);return f},setCrossOrigin:function(a){return this.crossOrigin=a,this},setPath:function(a){return this.path=
a,this}});Object.assign(Qe.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=new Z,f=new Pd(this.manager);return f.setCrossOrigin(this.crossOrigin),f.setPath(this.path),f.load(a,function(c){e.image=c;c=0<a.search(/\.jpe?g($|\?)/i)||0===a.search(/^data:image\/jpeg/);e.format=c?1022:1023;e.needsUpdate=!0;void 0!==b&&b(e)},c,d),e},setCrossOrigin:function(a){return this.crossOrigin=a,this},setPath:function(a){return this.path=a,this}});Object.assign(S.prototype,{getPoint:function(){return null},
getPointAt:function(a,b){a=this.getUtoTmapping(a);return this.getPoint(a,b)},getPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return b},getSpacedPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){if(void 0===a&&(a=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;
this.needsUpdate=!1;var b,c,d=[],e=this.getPoint(0),f=0;d.push(0);for(c=1;c<=a;c++)f+=(b=this.getPoint(c/a)).distanceTo(e),d.push(f),e=b;return this.cacheArcLengths=d},updateArcLengths:function(){this.needsUpdate=!0;this.getLengths()},getUtoTmapping:function(a,b){var c=this.getLengths(),d=c.length;a=b||a*c[d-1];for(var e,f=0,g=d-1;f<=g;)if(0>(e=c[b=Math.floor(f+(g-f)/2)]-a))f=b+1;else{if(!(0<e)){g=b;break}g=b-1}if(c[b=g]===a)return b/(d-1);e=c[b];return(b+(a-e)/(c[b+1]-e))/(d-1)},getTangent:function(a){var b=
a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()},getTangentAt:function(a){a=this.getUtoTmapping(a);return this.getTangent(a)},computeFrenetFrames:function(a,b){var c,d,e=new n,f=[],g=[],h=[],k=new n,m=new I;for(c=0;c<=a;c++){var l=c/a;f[c]=this.getTangentAt(l);f[c].normalize()}g[0]=new n;h[0]=new n;c=Number.MAX_VALUE;l=Math.abs(f[0].x);var p=Math.abs(f[0].y),w=Math.abs(f[0].z);l<=c&&(c=l,e.set(1,0,0));p<=c&&(c=p,e.set(0,1,0));w<=c&&e.set(0,
0,1);k.crossVectors(f[0],e).normalize();g[0].crossVectors(f[0],k);h[0].crossVectors(f[0],g[0]);for(c=1;c<=a;c++)g[c]=g[c-1].clone(),h[c]=h[c-1].clone(),k.crossVectors(f[c-1],f[c]),k.length()>Number.EPSILON&&(k.normalize(),d=Math.acos(Q.clamp(f[c-1].dot(f[c]),-1,1)),g[c].applyMatrix4(m.makeRotationAxis(k,d))),h[c].crossVectors(f[c],g[c]);if(!0===b)for(d=Math.acos(Q.clamp(g[0].dot(g[a]),-1,1)),d/=a,0<f[0].dot(k.crossVectors(g[0],g[a]))&&(d=-d),c=1;c<=a;c++)g[c].applyMatrix4(m.makeRotationAxis(f[c],
d*c)),h[c].crossVectors(f[c],g[c]);return{tangents:f,normals:g,binormals:h}},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this},toJSON:function(){var a={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a},fromJSON:function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}});Ga.prototype=Object.create(S.prototype);Ga.prototype.constructor=
Ga;Ga.prototype.isEllipseCurve=!0;Ga.prototype.getPoint=function(a,b){b=b||new x;for(var c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;0>d;)d+=c;for(;c<d;)d-=c;d<Number.EPSILON&&(d=e?0:c);!0!==this.aClockwise||e||(d===c?d=-c:d-=c);c=this.aStartAngle+a*d;a=this.aX+this.xRadius*Math.cos(c);var f=this.aY+this.yRadius*Math.sin(c);0!==this.aRotation&&(c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a-this.aX,f-=this.aY,a=e*c-f*d+this.aX,f=e*d+f*c+this.aY);return b.set(a,
f)};Ga.prototype.copy=function(a){return S.prototype.copy.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this};Ga.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=
this.aRotation,a};Ga.prototype.fromJSON=function(a){return S.prototype.fromJSON.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this};Lc.prototype=Object.create(Ga.prototype);Lc.prototype.constructor=Lc;Lc.prototype.isArcCurve=!0;var tf=new n,Yg=new Rf,Zg=new Rf,$g=new Rf;ra.prototype=Object.create(S.prototype);ra.prototype.constructor=ra;ra.prototype.isCatmullRomCurve3=
!0;ra.prototype.getPoint=function(a,b){var c,d;b=b||new n;var e=this.points;var f=e.length;a*=f-(this.closed?0:1);var g=Math.floor(a),h=a-g;if(this.closed?g+=0<g?0:(Math.floor(Math.abs(g)/f)+1)*f:0===h&&g===f-1&&(g=f-2,h=1),a=this.closed||0<g?e[(g-1)%f]:(tf.subVectors(e[0],e[1]).add(e[0]),tf),c=e[g%f],d=e[(g+1)%f],e=this.closed||g+2<f?e[(g+2)%f]:(tf.subVectors(e[f-1],e[f-2]).add(e[f-1]),tf),"centripetal"===this.curveType||"chordal"===this.curveType){var k="chordal"===this.curveType?.5:.25;f=Math.pow(a.distanceToSquared(c),
k);g=Math.pow(c.distanceToSquared(d),k);k=Math.pow(d.distanceToSquared(e),k);1E-4>g&&(g=1);1E-4>f&&(f=g);1E-4>k&&(k=g);Yg.initNonuniformCatmullRom(a.x,c.x,d.x,e.x,f,g,k);Zg.initNonuniformCatmullRom(a.y,c.y,d.y,e.y,f,g,k);$g.initNonuniformCatmullRom(a.z,c.z,d.z,e.z,f,g,k)}else"catmullrom"===this.curveType&&(Yg.initCatmullRom(a.x,c.x,d.x,e.x,this.tension),Zg.initCatmullRom(a.y,c.y,d.y,e.y,this.tension),$g.initCatmullRom(a.z,c.z,d.z,e.z,this.tension));return b.set(Yg.calc(h),Zg.calc(h),$g.calc(h)),b};
ra.prototype.copy=function(a){S.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this};ra.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a};ra.prototype.fromJSON=function(a){S.prototype.fromJSON.call(this,
a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new n).fromArray(d))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this};Pa.prototype=Object.create(S.prototype);Pa.prototype.constructor=Pa;Pa.prototype.isCubicBezierCurve=!0;Pa.prototype.getPoint=function(a,b){b=b||new x;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;return b.set(Rd(a,c.x,d.x,e.x,f.x),Rd(a,c.y,d.y,e.y,f.y)),b};Pa.prototype.copy=function(a){return S.prototype.copy.call(this,
a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this};Pa.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a};Pa.prototype.fromJSON=function(a){return S.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this};bb.prototype=Object.create(S.prototype);bb.prototype.constructor=bb;bb.prototype.isCubicBezierCurve3=
!0;bb.prototype.getPoint=function(a,b){b=b||new n;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;return b.set(Rd(a,c.x,d.x,e.x,f.x),Rd(a,c.y,d.y,e.y,f.y),Rd(a,c.z,d.z,e.z,f.z)),b};bb.prototype.copy=function(a){return S.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this};bb.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a};bb.prototype.fromJSON=
function(a){return S.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this};va.prototype=Object.create(S.prototype);va.prototype.constructor=va;va.prototype.isLineCurve=!0;va.prototype.getPoint=function(a,b){b=b||new x;return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b};va.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};va.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};
va.prototype.copy=function(a){return S.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this};va.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a};va.prototype.fromJSON=function(a){return S.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};Qa.prototype=Object.create(S.prototype);Qa.prototype.constructor=Qa;Qa.prototype.isLineCurve3=!0;Qa.prototype.getPoint=function(a,b){b=b||
new n;return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b};Qa.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};Qa.prototype.copy=function(a){return S.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this};Qa.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a};Qa.prototype.fromJSON=function(a){return S.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),
this};Ra.prototype=Object.create(S.prototype);Ra.prototype.constructor=Ra;Ra.prototype.isQuadraticBezierCurve=!0;Ra.prototype.getPoint=function(a,b){b=b||new x;var c=this.v0,d=this.v1,e=this.v2;return b.set(Qd(a,c.x,d.x,e.x),Qd(a,c.y,d.y,e.y)),b};Ra.prototype.copy=function(a){return S.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this};Ra.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=
this.v2.toArray(),a};Ra.prototype.fromJSON=function(a){return S.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};cb.prototype=Object.create(S.prototype);cb.prototype.constructor=cb;cb.prototype.isQuadraticBezierCurve3=!0;cb.prototype.getPoint=function(a,b){b=b||new n;var c=this.v0,d=this.v1,e=this.v2;return b.set(Qd(a,c.x,d.x,e.x),Qd(a,c.y,d.y,e.y),Qd(a,c.z,d.z,e.z)),b};cb.prototype.copy=function(a){return S.prototype.copy.call(this,a),
this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this};cb.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a};cb.prototype.fromJSON=function(a){return S.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};Sa.prototype=Object.create(S.prototype);Sa.prototype.constructor=Sa;Sa.prototype.isSplineCurve=!0;Sa.prototype.getPoint=function(a,b){b=b||
new x;var c=this.points,d=(c.length-1)*a;a=Math.floor(d);d-=a;var e=c[0===a?a:a-1],f=c[a],g=c[a>c.length-2?c.length-1:a+1];c=c[a>c.length-3?c.length-1:a+2];return b.set(mi(d,e.x,f.x,g.x,c.x),mi(d,e.y,f.y,g.y,c.y)),b};Sa.prototype.copy=function(a){S.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this};Sa.prototype.toJSON=function(){var a=S.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());
return a};Sa.prototype.fromJSON=function(a){S.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new x).fromArray(d))}return this};var ej=Object.freeze({ArcCurve:Lc,CatmullRomCurve3:ra,CubicBezierCurve:Pa,CubicBezierCurve3:bb,EllipseCurve:Ga,LineCurve:va,LineCurve3:Qa,QuadraticBezierCurve:Ra,QuadraticBezierCurve3:cb,SplineCurve:Sa});lb.prototype=Object.assign(Object.create(S.prototype),{constructor:lb,add:function(a){this.curves.push(a)},
closePath:function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new va(b,a))},getPoint:function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],c=a.getLength(),a.getPointAt(0===c?0:1-b/c);a++}return null},getLength:function(){var a=this.getCurveLengths();return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()},
getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a},getSpacedPoints:function(a){void 0===a&&(a=40);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return this.autoClose&&b.push(b[0]),b},getPoints:function(a){a=a||12;for(var b,c=[],d=0,e=this.curves;d<e.length;d++){var f=e[d];f=f.getPoints(f&&f.isEllipseCurve?
2*a:f&&(f.isLineCurve||f.isLineCurve3)?1:f&&f.isSplineCurve?a*f.points.length:a);for(var g=0;g<f.length;g++){var h=f[g];b&&b.equals(h)||(c.push(h),b=h)}}return this.autoClose&&1<c.length&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c},copy:function(a){S.prototype.copy.call(this,a);this.curves=[];for(var b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());return this.autoClose=a.autoClose,this},toJSON:function(){var a=S.prototype.toJSON.call(this);a.autoClose=this.autoClose;a.curves=
[];for(var b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a},fromJSON:function(a){S.prototype.fromJSON.call(this,a);this.autoClose=a.autoClose;this.curves=[];for(var b=0,c=a.curves.length;b<c;b++){var d=a.curves[b];this.curves.push((new ej[d.type]).fromJSON(d))}return this}});Ta.prototype=Object.assign(Object.create(lb.prototype),{constructor:Ta,setFromPoints:function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)},moveTo:function(a,
b){this.currentPoint.set(a,b)},lineTo:function(a,b){var c=new va(this.currentPoint.clone(),new x(a,b));this.curves.push(c);this.currentPoint.set(a,b)},quadraticCurveTo:function(a,b,c,d){a=new Ra(this.currentPoint.clone(),new x(a,b),new x(c,d));this.curves.push(a);this.currentPoint.set(c,d)},bezierCurveTo:function(a,b,c,d,e,f){a=new Pa(this.currentPoint.clone(),new x(a,b),new x(c,d),new x(e,f));this.curves.push(a);this.currentPoint.set(e,f)},splineThru:function(a){var b=new Sa([this.currentPoint.clone()].concat(a));
this.curves.push(b);this.currentPoint.copy(a[a.length-1])},arc:function(a,b,c,d,e,f){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f)},absarc:function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},ellipse:function(a,b,c,d,e,f,g,h){this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f,g,h)},absellipse:function(a,b,c,d,e,f,g,h){a=new Ga(a,b,c,d,e,f,g,h);0<this.curves.length&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);
this.currentPoint.copy(a)},copy:function(a){return lb.prototype.copy.call(this,a),this.currentPoint.copy(a.currentPoint),this},toJSON:function(){var a=lb.prototype.toJSON.call(this);return a.currentPoint=this.currentPoint.toArray(),a},fromJSON:function(a){return lb.prototype.fromJSON.call(this,a),this.currentPoint.fromArray(a.currentPoint),this}});wb.prototype=Object.assign(Object.create(Ta.prototype),{constructor:wb,getPointsHoles:function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);
return b},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(a){Ta.prototype.copy.call(this,a);this.holes=[];for(var b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this},toJSON:function(){var a=Ta.prototype.toJSON.call(this);a.uuid=this.uuid;a.holes=[];for(var b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());return a},fromJSON:function(a){Ta.prototype.fromJSON.call(this,a);this.uuid=a.uuid;this.holes=[];
for(var b=0,c=a.holes.length;b<c;b++){var d=a.holes[b];this.holes.push((new Ta).fromJSON(d))}return this}});ia.prototype=Object.assign(Object.create(E.prototype),{constructor:ia,isLight:!0,copy:function(a){return E.prototype.copy.call(this,a),this.color.copy(a.color),this.intensity=a.intensity,this},toJSON:function(a){a=E.prototype.toJSON.call(this,a);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex()),
void 0!==this.distance&&(a.object.distance=this.distance),void 0!==this.angle&&(a.object.angle=this.angle),void 0!==this.decay&&(a.object.decay=this.decay),void 0!==this.penumbra&&(a.object.penumbra=this.penumbra),void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON()),a}});Re.prototype=Object.assign(Object.create(ia.prototype),{constructor:Re,isHemisphereLight:!0,copy:function(a){return ia.prototype.copy.call(this,a),this.groundColor.copy(a.groundColor),this}});Object.assign(cc.prototype,{copy:function(a){return this.camera=
a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var a={};return 0!==this.bias&&(a.bias=this.bias),1!==this.radius&&(a.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}});Se.prototype=Object.assign(Object.create(cc.prototype),{constructor:Se,isSpotLightShadow:!0,update:function(a){var b=
this.camera,c=2*Q.RAD2DEG*a.angle,d=this.mapSize.width/this.mapSize.height;a=a.distance||b.far;c===b.fov&&d===b.aspect&&a===b.far||(b.fov=c,b.aspect=d,b.far=a,b.updateProjectionMatrix())}});Te.prototype=Object.assign(Object.create(ia.prototype),{constructor:Te,isSpotLight:!0,copy:function(a){return ia.prototype.copy.call(this,a),this.distance=a.distance,this.angle=a.angle,this.penumbra=a.penumbra,this.decay=a.decay,this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}});Ue.prototype=Object.assign(Object.create(ia.prototype),
{constructor:Ue,isPointLight:!0,copy:function(a){return ia.prototype.copy.call(this,a),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this}});Sd.prototype=Object.assign(Object.create(Za.prototype),{constructor:Sd,isOrthographicCamera:!0,copy:function(a,b){return Za.prototype.copy.call(this,a,b),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this},
setViewOffset:function(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-
this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a;c+=a;a=d+b;b=d-b;if(null!==this.view&&this.view.enabled){c=this.zoom/(this.view.width/this.view.fullWidth);b=this.zoom/(this.view.height/this.view.fullHeight);var f=(this.right-this.left)/this.view.width;d=(this.top-this.bottom)/this.view.height;c=(e+=this.view.offsetX/c*f)+this.view.width/c*f;b=(a-=this.view.offsetY/b*d)-this.view.height/b*d}this.projectionMatrix.makeOrthographic(e,c,a,b,this.near,this.far);this.projectionMatrixInverse.getInverse(this.projectionMatrix)},
toJSON:function(a){a=E.prototype.toJSON.call(this,a);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,null!==this.view&&(a.object.view=Object.assign({},this.view)),a}});Ve.prototype=Object.assign(Object.create(cc.prototype),{constructor:Ve});We.prototype=Object.assign(Object.create(ia.prototype),{constructor:We,isDirectionalLight:!0,copy:function(a){return ia.prototype.copy.call(this,
a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}});Xe.prototype=Object.assign(Object.create(ia.prototype),{constructor:Xe,isAmbientLight:!0});Ye.prototype=Object.assign(Object.create(ia.prototype),{constructor:Ye,isRectAreaLight:!0,copy:function(a){return ia.prototype.copy.call(this,a),this.width=a.width,this.height=a.height,this},toJSON:function(a){a=ia.prototype.toJSON.call(this,a);return a.object.width=this.width,a.object.height=this.height,a}});Object.assign(Ze.prototype,{load:function(a,
b,c,d){var e=this,f=new Oa(e.manager);f.setPath(e.path);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a){function b(a){return c[a],c[a]}var c=this.textures,d=new Zk[a.type];if(void 0!==a.uuid&&(d.uuid=a.uuid),void 0!==a.name&&(d.name=a.name),void 0!==a.color&&d.color.setHex(a.color),void 0!==a.roughness&&(d.roughness=a.roughness),void 0!==a.metalness&&(d.metalness=a.metalness),void 0!==a.emissive&&d.emissive.setHex(a.emissive),void 0!==a.specular&&d.specular.setHex(a.specular),
void 0!==a.shininess&&(d.shininess=a.shininess),void 0!==a.clearCoat&&(d.clearCoat=a.clearCoat),void 0!==a.clearCoatRoughness&&(d.clearCoatRoughness=a.clearCoatRoughness),void 0!==a.vertexColors&&(d.vertexColors=a.vertexColors),void 0!==a.fog&&(d.fog=a.fog),void 0!==a.flatShading&&(d.flatShading=a.flatShading),void 0!==a.blending&&(d.blending=a.blending),void 0!==a.combine&&(d.combine=a.combine),void 0!==a.side&&(d.side=a.side),void 0!==a.opacity&&(d.opacity=a.opacity),void 0!==a.transparent&&(d.transparent=
a.transparent),void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest),void 0!==a.depthTest&&(d.depthTest=a.depthTest),void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite),void 0!==a.colorWrite&&(d.colorWrite=a.colorWrite),void 0!==a.wireframe&&(d.wireframe=a.wireframe),void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth),void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap),void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin),void 0!==a.rotation&&(d.rotation=
a.rotation),1!==a.linewidth&&(d.linewidth=a.linewidth),void 0!==a.dashSize&&(d.dashSize=a.dashSize),void 0!==a.gapSize&&(d.gapSize=a.gapSize),void 0!==a.scale&&(d.scale=a.scale),void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset),void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor),void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits),void 0!==a.skinning&&(d.skinning=a.skinning),void 0!==a.morphTargets&&(d.morphTargets=a.morphTargets),void 0!==
a.dithering&&(d.dithering=a.dithering),void 0!==a.visible&&(d.visible=a.visible),void 0!==a.userData&&(d.userData=a.userData),void 0!==a.uniforms)for(var e in a.uniforms){var f=a.uniforms[e];switch(d.uniforms[e]={},f.type){case "t":d.uniforms[e].value=b(f.value);break;case "c":d.uniforms[e].value=(new L).setHex(f.value);break;case "v2":d.uniforms[e].value=(new x).fromArray(f.value);break;case "v3":d.uniforms[e].value=(new n).fromArray(f.value);break;case "v4":d.uniforms[e].value=(new da).fromArray(f.value);
break;case "m4":d.uniforms[e].value=(new I).fromArray(f.value);break;default:d.uniforms[e].value=f.value}}if(void 0!==a.defines&&(d.defines=a.defines),void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader),void 0!==a.fragmentShader&&(d.fragmentShader=a.fragmentShader),void 0!==a.shading&&(d.flatShading=1===a.shading),void 0!==a.size&&(d.size=a.size),void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation),void 0!==a.map&&(d.map=b(a.map)),void 0!==a.alphaMap&&(d.alphaMap=b(a.alphaMap),d.transparent=
!0),void 0!==a.bumpMap&&(d.bumpMap=b(a.bumpMap)),void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale),void 0!==a.normalMap&&(d.normalMap=b(a.normalMap)),void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType),void 0!==a.normalScale)e=a.normalScale,!1===Array.isArray(e)&&(e=[e,e]),d.normalScale=(new x).fromArray(e);return void 0!==a.displacementMap&&(d.displacementMap=b(a.displacementMap)),void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale),void 0!==a.displacementBias&&(d.displacementBias=
a.displacementBias),void 0!==a.roughnessMap&&(d.roughnessMap=b(a.roughnessMap)),void 0!==a.metalnessMap&&(d.metalnessMap=b(a.metalnessMap)),void 0!==a.emissiveMap&&(d.emissiveMap=b(a.emissiveMap)),void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity),void 0!==a.specularMap&&(d.specularMap=b(a.specularMap)),void 0!==a.envMap&&(d.envMap=b(a.envMap)),void 0!==a.envMapIntensity&&(d.envMapIntensity=a.envMapIntensity),void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity),void 0!==a.lightMap&&
(d.lightMap=b(a.lightMap)),void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity),void 0!==a.aoMap&&(d.aoMap=b(a.aoMap)),void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity),void 0!==a.gradientMap&&(d.gradientMap=b(a.gradientMap)),d},setPath:function(a){return this.path=a,this},setTextures:function(a){return this.textures=a,this}});var ah={decodeText:function(a){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);
return decodeURIComponent(escape(b))},extractUrlBase:function(a){var b=a.lastIndexOf("/");return-1===b?"./":a.substr(0,b+1)}};Object.assign(Sf.prototype,{load:function(a,b,c,d){var e=this,f=new Oa(e.manager);f.setPath(e.path);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a){var b=new F,c=a.data.index;void 0!==c&&(c=new fj[c.type](c.array),b.setIndex(new X(c,1)));var d=a.data.attributes;for(f in d){var e=d[f];c=new fj[e.type](e.array);b.addAttribute(f,new X(c,e.itemSize,e.normalized))}var f=
a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==f)for(c=0,d=f.length;c!==d;++c)e=f[c],b.addGroup(e.start,e.count,e.materialIndex);f=a.data.boundingSphere;void 0!==f&&(c=new n,void 0!==f.center&&c.fromArray(f.center),b.boundingSphere=new Ka(c,f.radius));return a.name&&(b.name=a.name),a.userData&&(b.userData=a.userData),b},setPath:function(a){return this.path=a,this}});var fj={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:
Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Object.assign(Tf.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=this,f=void 0===this.path?ah.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||f;f=new Oa(e.manager);f.setPath(this.path);f.load(a,function(a){var c=null;try{c=JSON.parse(a)}catch(k){return void(void 0!==d&&d(k))}a=c.metadata;void 0!==a&&void 0!==a.type&&
"geometry"!==a.type.toLowerCase()&&e.parse(c,b)},c,d)},setPath:function(a){return this.path=a,this},setResourcePath:function(a){return this.resourcePath=a,this},setCrossOrigin:function(a){return this.crossOrigin=a,this},parse:function(a,b){var c=this.parseShape(a.shapes);c=this.parseGeometries(a.geometries,c);var d=this.parseImages(a.images,function(){void 0!==b&&b(e)});d=this.parseTextures(a.textures,d);d=this.parseMaterials(a.materials,d);var e=this.parseObject(a.object,c,d);return a.animations&&
(e.animations=this.parseAnimations(a.animations)),void 0!==a.images&&0!==a.images.length||void 0!==b&&b(e),e},parseShape:function(a){var b={};if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var e=(new wb).fromJSON(a[c]);b[e.uuid]=e}return b},parseGeometries:function(a,b){var c={};if(void 0!==a)for(var d=new Sf,e=0,f=a.length;e<f;e++){var g=a[e];switch(g.type){case "PlaneGeometry":case "PlaneBufferGeometry":var h=new Da[g.type](g.width,g.height,g.widthSegments,g.heightSegments);break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":h=
new Da[g.type](g.width,g.height,g.depth,g.widthSegments,g.heightSegments,g.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":h=new Da[g.type](g.radius,g.segments,g.thetaStart,g.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":h=new Da[g.type](g.radiusTop,g.radiusBottom,g.height,g.radialSegments,g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case "ConeGeometry":case "ConeBufferGeometry":h=new Da[g.type](g.radius,g.height,g.radialSegments,
g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":h=new Da[g.type](g.radius,g.widthSegments,g.heightSegments,g.phiStart,g.phiLength,g.thetaStart,g.thetaLength);break;case "DodecahedronGeometry":case "DodecahedronBufferGeometry":case "IcosahedronGeometry":case "IcosahedronBufferGeometry":case "OctahedronGeometry":case "OctahedronBufferGeometry":case "TetrahedronGeometry":case "TetrahedronBufferGeometry":h=new Da[g.type](g.radius,g.detail);
break;case "RingGeometry":case "RingBufferGeometry":h=new Da[g.type](g.innerRadius,g.outerRadius,g.thetaSegments,g.phiSegments,g.thetaStart,g.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":h=new Da[g.type](g.radius,g.tube,g.radialSegments,g.tubularSegments,g.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":h=new Da[g.type](g.radius,g.tube,g.tubularSegments,g.radialSegments,g.p,g.q);break;case "LatheGeometry":case "LatheBufferGeometry":h=new Da[g.type](g.points,
g.segments,g.phiStart,g.phiLength);break;case "PolyhedronGeometry":case "PolyhedronBufferGeometry":h=new Da[g.type](g.vertices,g.indices,g.radius,g.details);break;case "ShapeGeometry":case "ShapeBufferGeometry":h=[];for(var k=0,m=g.shapes.length;k<m;k++){var l=b[g.shapes[k]];h.push(l)}h=new Da[g.type](h,g.curveSegments);break;case "ExtrudeGeometry":case "ExtrudeBufferGeometry":h=[];k=0;for(m=g.shapes.length;k<m;k++)l=b[g.shapes[k]],h.push(l);k=g.options.extrudePath;void 0!==k&&(g.options.extrudePath=
(new ej[k.type]).fromJSON(k));h=new Da[g.type](h,g.options);break;case "BufferGeometry":h=d.parse(g);break;case "Geometry":break;default:continue}h.uuid=g.uuid;void 0!==g.name&&(h.name=g.name);!0===h.isBufferGeometry&&void 0!==g.userData&&(h.userData=g.userData);c[g.uuid]=h}return c},parseMaterials:function(a,b){var c={},d={};if(void 0!==a){var e=new Ze;e.setTextures(b);b=0;for(var f=a.length;b<f;b++){var g=a[b];if("MultiMaterial"===g.type){for(var h=[],k=0;k<g.materials.length;k++){var m=g.materials[k];
void 0===c[m.uuid]&&(c[m.uuid]=e.parse(m));h.push(c[m.uuid])}d[g.uuid]=h}else d[g.uuid]=e.parse(g),c[g.uuid]=d[g.uuid]}}return d},parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=Na.parse(d);void 0!==d.uuid&&(e.uuid=d.uuid);b.push(e)}return b},parseImages:function(a,b){function c(a){return d.manager.itemStart(a),f.load(a,function(){d.manager.itemEnd(a)},void 0,function(){d.manager.itemError(a);d.manager.itemEnd(a)})}var d=this,e={};if(void 0!==a&&0<a.length){var f=new Pd(new Of(b));
f.setCrossOrigin(this.crossOrigin);b=0;for(var g=a.length;b<g;b++){var h=a[b],k=h.url;if(Array.isArray(k)){e[h.uuid]=[];for(var m=0,l=k.length;m<l;m++){var p=k[m];p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:d.resourcePath+p;e[h.uuid].push(c(p))}}else p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?h.url:d.resourcePath+h.url,e[h.uuid]=c(p)}}return e},parseTextures:function(a,b){function c(a,b){return"number"==typeof a?a:b[a]}var d={};if(void 0!==a)for(var e=0,f=a.length;e<f;e++){var g,h=a[e];h.image;b[h.image];
(g=Array.isArray(b[h.image])?new gb(b[h.image]):new Z(b[h.image])).needsUpdate=!0;g.uuid=h.uuid;void 0!==h.name&&(g.name=h.name);void 0!==h.mapping&&(g.mapping=c(h.mapping,$k));void 0!==h.offset&&g.offset.fromArray(h.offset);void 0!==h.repeat&&g.repeat.fromArray(h.repeat);void 0!==h.center&&g.center.fromArray(h.center);void 0!==h.rotation&&(g.rotation=h.rotation);void 0!==h.wrap&&(g.wrapS=c(h.wrap[0],gj),g.wrapT=c(h.wrap[1],gj));void 0!==h.format&&(g.format=h.format);void 0!==h.minFilter&&(g.minFilter=
c(h.minFilter,hj));void 0!==h.magFilter&&(g.magFilter=c(h.magFilter,hj));void 0!==h.anisotropy&&(g.anisotropy=h.anisotropy);void 0!==h.flipY&&(g.flipY=h.flipY);d[h.uuid]=g}return d},parseObject:function(a,b,c){function d(a){return b[a],b[a]}function e(a){if(void 0!==a){if(Array.isArray(a)){for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d];c[f];b.push(c[f])}return b}return c[a],c[a]}}switch(a.type){case "Scene":var f=new Ge;void 0!==a.background&&Number.isInteger(a.background)&&(f.background=new L(a.background));
void 0!==a.fog&&("Fog"===a.fog.type?f.fog=new rc(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(f.fog=new qc(a.fog.color,a.fog.density)));break;case "PerspectiveCamera":f=new ja(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(f.focus=a.focus);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.filmGauge&&(f.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(f.filmOffset=a.filmOffset);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "OrthographicCamera":f=new Sd(a.left,a.right,a.top,a.bottom,
a.near,a.far);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "AmbientLight":f=new Xe(a.color,a.intensity);break;case "DirectionalLight":f=new We(a.color,a.intensity);break;case "PointLight":f=new Ue(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":f=new Ye(a.color,a.intensity,a.width,a.height);break;case "SpotLight":f=new Te(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":f=new Re(a.color,a.groundColor,
a.intensity);break;case "SkinnedMesh":case "Mesh":f=d(a.geometry);var g=e(a.material);f=f.bones&&0<f.bones.length?new qd(f,g):new wa(f,g);break;case "LOD":f=new pd;break;case "Line":f=new xa(d(a.geometry),e(a.material),a.mode);break;case "LineLoop":f=new Ie(d(a.geometry),e(a.material));break;case "LineSegments":f=new ba(d(a.geometry),e(a.material));break;case "PointCloud":case "Points":f=new tc(d(a.geometry),e(a.material));break;case "Sprite":f=new vb(e(a.material));break;case "Group":f=new pc;break;
default:f=new E}if(f.uuid=a.uuid,void 0!==a.name&&(f.name=a.name),void 0!==a.matrix?(f.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(void 0!==a.position&&f.position.fromArray(a.position),void 0!==a.rotation&&f.rotation.fromArray(a.rotation),void 0!==a.quaternion&&f.quaternion.fromArray(a.quaternion),void 0!==a.scale&&f.scale.fromArray(a.scale)),void 0!==a.castShadow&&(f.castShadow=
a.castShadow),void 0!==a.receiveShadow&&(f.receiveShadow=a.receiveShadow),a.shadow&&(void 0!==a.shadow.bias&&(f.shadow.bias=a.shadow.bias),void 0!==a.shadow.radius&&(f.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&f.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(f.shadow.camera=this.parseObject(a.shadow.camera))),void 0!==a.visible&&(f.visible=a.visible),void 0!==a.frustumCulled&&(f.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(f.renderOrder=a.renderOrder),
void 0!==a.userData&&(f.userData=a.userData),void 0!==a.layers&&(f.layers.mask=a.layers),void 0!==a.children){g=a.children;for(var h=0;h<g.length;h++)f.add(this.parseObject(g[h],b,c))}if("LOD"===a.type)for(a=a.levels,g=0;g<a.length;g++){h=a[g];var k=f.getObjectByProperty("uuid",h.object);void 0!==k&&f.addLevel(k,h.distance)}return f}});var $k={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,
CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},gj={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},hj={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008},ij,uf,bh,ch,vf;Uf.prototype={constructor:Uf,setOptions:function(a){return this.options=a,this},load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);
var e=this,f=fc.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;fetch(a).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,e.options)}).then(function(c){fc.add(a,c);b&&b(c);e.manager.itemEnd(a)}).catch(function(b){d&&d(b);e.manager.itemError(a);e.manager.itemEnd(a)})},setCrossOrigin:function(){return this},setPath:function(a){return this.path=a,this}};Object.assign(Vf.prototype,{moveTo:function(a,b){this.currentPath=
new Ta;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},splineThru:function(a){this.currentPath.splineThru(a)},toShapes:function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new wb;f.curves=e.curves;b.push(f)}return b}function d(a,b){for(var c=b.length,
d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],k=h.x-g.x,m=h.y-g.y;if(Math.abs(m)>Number.EPSILON){if(!(0>m&&(g=b[f],k=-k,h=b[e],m=-m),a.y<g.y||a.y>h.y))if(a.y===g.y){if(a.x===g.x)return!0}else{e=m*(a.x-g.x)-k*(a.y-g.y);if(0===e)return!0;0>e||(d=!d)}}else if(a.y===g.y&&(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=h.x))return!0}return d}var e=jb.isClockWise,f=this.subPaths;if(0===f.length)return[];if(!0===b)return c(f);var g,h;b=[];if(1===f.length)return g=f[0],(h=new wb).curves=g.curves,b.push(h),b;var k=!e(f[0].getPoints());
k=a?!k:k;var m;h=[];var l=[],n=[],w=0;l[w]=void 0;n[w]=[];for(var r=0,u=f.length;r<u;r++){var t=e(m=(g=f[r]).getPoints());(t=a?!t:t)?(!k&&l[w]&&w++,l[w]={s:new wb,p:m},l[w].s.curves=g.curves,k&&w++,n[w]=[]):n[w].push({h:g,p:m[0]})}if(!l[0])return c(f);if(1<l.length){r=!1;a=[];e=0;for(f=l.length;e<f;e++)h[e]=[];e=0;for(f=l.length;e<f;e++)for(g=n[e],t=0;t<g.length;t++){k=g[t];m=!0;for(w=0;w<l.length;w++)d(k.p,l[w].p)&&(e!==w&&a.push({froms:e,tos:w,hole:t}),m?(m=!1,h[w].push(k)):r=!0);m&&h[e].push(k)}0<
a.length&&(r||(n=h))}r=0;for(e=l.length;r<e;r++)for(h=l[r].s,b.push(h),f=0,g=(a=n[r]).length;f<g;f++)h.holes.push(a[f].h);return b}});Object.assign(Wf.prototype,{isFont:!0,generateShapes:function(a,b){void 0===b&&(b=100);var c=[],d=b;b=this.data;var e=Array.from?Array.from(a):String(a).split("");d/=b.resolution;var f=(b.boundingBox.yMax-b.boundingBox.yMin+b.underlineThickness)*d;a=[];for(var g=0,h=0,k=0;k<e.length;k++){var m=e[k];if("\n"===m)g=0,h-=f;else{var l=d;var n=g,r=h;if(m=b.glyphs[m]||b.glyphs["?"]){var v=
new Vf;if(m.o)for(var u=m._cachedOutline||(m._cachedOutline=m.o.split(" ")),t=0,x=u.length;t<x;)switch(u[t++]){case "m":var z=u[t++]*l+n;var y=u[t++]*l+r;v.moveTo(z,y);break;case "l":z=u[t++]*l+n;y=u[t++]*l+r;v.lineTo(z,y);break;case "q":var A=u[t++]*l+n;var B=u[t++]*l+r;var C=u[t++]*l+n;var E=u[t++]*l+r;v.quadraticCurveTo(C,E,A,B);break;case "b":A=u[t++]*l+n,B=u[t++]*l+r,C=u[t++]*l+n,E=u[t++]*l+r,z=u[t++]*l+n,y=u[t++]*l+r,v.bezierCurveTo(C,E,z,y,A,B)}l={offsetX:m.ha*l,path:v}}else l=void 0;g+=l.offsetX;
a.push(l.path)}}b=0;for(e=a.length;b<e;b++)Array.prototype.push.apply(c,a[b].toShapes());return c}});Object.assign(ni.prototype,{load:function(a,b,c,d){var e=this,f=new Oa(this.manager);f.setPath(this.path);f.load(a,function(a){try{var c=JSON.parse(a)}catch(k){c=JSON.parse(a.substring(65,a.length-2))}a=e.parse(c);b&&b(a)},c,d)},parse:function(a){return new Wf(a)},setPath:function(a){return this.path=a,this}});Td.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=
this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}};Object.assign(Td.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:(ij={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},uf=new L,bh=new Qe,ch=new Ze,function(a,b,
c){function d(a,d,f,g,h){a=b+a;var k=Td.Handlers.get(a);a=null!==k?k.load(a):(bh.setCrossOrigin(c),bh.load(a));void 0!==d&&(a.repeat.fromArray(d),1!==d[0]&&(a.wrapS=1E3),1!==d[1]&&(a.wrapT=1E3));void 0!==f&&a.offset.fromArray(f);void 0!==g&&("repeat"===g[0]&&(a.wrapS=1E3),"mirror"===g[0]&&(a.wrapS=1002),"repeat"===g[1]&&(a.wrapT=1E3),"mirror"===g[1]&&(a.wrapT=1002));void 0!==h&&(a.anisotropy=h);d=Q.generateUUID();return e[d]=a,d}var e={},f={uuid:Q.generateUUID(),type:"MeshLambertMaterial"},g;for(g in a){var h=
a[g];switch(g){case "DbgName":f.name=h;break;case "blending":f.blending=ij[h];break;case "colorDiffuse":f.color=uf.fromArray(h).getHex();break;case "colorSpecular":f.specular=uf.fromArray(h).getHex();break;case "colorEmissive":f.emissive=uf.fromArray(h).getHex();break;case "specularCoef":f.shininess=h;break;case "shading":"basic"===h.toLowerCase()&&(f.type="MeshBasicMaterial");"phong"===h.toLowerCase()&&(f.type="MeshPhongMaterial");"standard"===h.toLowerCase()&&(f.type="MeshStandardMaterial");break;
case "mapDiffuse":f.map=d(h,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);break;case "mapEmissive":f.emissiveMap=d(h,a.mapEmissiveRepeat,a.mapEmissiveOffset,a.mapEmissiveWrap,a.mapEmissiveAnisotropy);break;case "mapLight":f.lightMap=d(h,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);break;case "mapAO":f.aoMap=d(h,a.mapAORepeat,a.mapAOOffset,a.mapAOWrap,a.mapAOAnisotropy);break;case "mapBump":f.bumpMap=d(h,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,
a.mapBumpAnisotropy);break;case "mapBumpScale":f.bumpScale=h;break;case "mapNormal":f.normalMap=d(h,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);break;case "mapNormalFactor":f.normalScale=h;break;case "mapSpecular":f.specularMap=d(h,a.mapSpecularRepeat,a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);break;case "mapMetalness":f.metalnessMap=d(h,a.mapMetalnessRepeat,a.mapMetalnessOffset,a.mapMetalnessWrap,a.mapMetalnessAnisotropy);break;case "mapRoughness":f.roughnessMap=
d(h,a.mapRoughnessRepeat,a.mapRoughnessOffset,a.mapRoughnessWrap,a.mapRoughnessAnisotropy);break;case "mapAlpha":f.alphaMap=d(h,a.mapAlphaRepeat,a.mapAlphaOffset,a.mapAlphaWrap,a.mapAlphaAnisotropy);break;case "flipSided":f.side=1;break;case "doubleSided":f.side=2;break;case "transparency":f.opacity=h;break;case "depthTest":case "depthWrite":case "colorWrite":case "opacity":case "reflectivity":case "transparent":case "visible":case "wireframe":f[g]=h;break;case "vertexColors":!0===h&&(f.vertexColors=
2),"face"===h&&(f.vertexColors=1)}}return"MeshBasicMaterial"===f.type&&delete f.emissive,"MeshPhongMaterial"!==f.type&&delete f.specular,1>f.opacity&&(f.transparent=!0),ch.setTextures(e),ch.parse(f)})});var $f={getContext:function(){return void 0===vf&&(vf=new (window.AudioContext||window.webkitAudioContext)),vf},setContext:function(a){vf=a}},jj,dh,eh,$c,ad,kj,fh,wf,gh,hh,Bb,ih,lj,Cb,mj,Db,jh,nj,Eb;Object.assign(Xf.prototype,{load:function(a,b,c,d){var e=new Oa(this.manager);e.setResponseType("arraybuffer");
e.setPath(this.path);e.load(a,function(a){a=a.slice(0);$f.getContext().decodeAudioData(a,function(a){b(a)})},c,d)},setPath:function(a){return this.path=a,this}});Object.assign(oi.prototype,{update:(gh=new I,hh=new I,function(a){if(jj!==this||dh!==a.focus||eh!==a.fov||$c!==a.aspect*this.aspect||ad!==a.near||kj!==a.far||fh!==a.zoom||wf!==this.eyeSep){jj=this;dh=a.focus;eh=a.fov;$c=a.aspect*this.aspect;ad=a.near;kj=a.far;fh=a.zoom;var b=a.projectionMatrix.clone(),c=(wf=this.eyeSep/2)*ad/dh,d=ad*Math.tan(Q.DEG2RAD*
eh*.5)/fh;hh.elements[12]=-wf;gh.elements[12]=wf;var e=-d*$c+c;var f=d*$c+c;b.elements[0]=2*ad/(f-e);b.elements[8]=(f+e)/(f-e);this.cameraL.projectionMatrix.copy(b);e=-d*$c-c;f=d*$c-c;b.elements[0]=2*ad/(f-e);b.elements[8]=(f+e)/(f-e);this.cameraR.projectionMatrix.copy(b)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(hh);this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(gh)})});Ud.prototype=Object.create(E.prototype);Ud.prototype.constructor=Ud;Object.assign(Yf.prototype,{start:function(){this.oldTime=
this.startTime=("undefined"==typeof performance?Date:performance).now();this.elapsedTime=0;this.running=!0},stop:function(){this.getElapsedTime();this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=("undefined"==typeof performance?Date:performance).now();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}});Zf.prototype=Object.assign(Object.create(E.prototype),
{constructor:Zf,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(a){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),
this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this},updateMatrixWorld:(Bb=new n,ih=new la,lj=new n,Cb=new n,mj=new Yf,function(a){E.prototype.updateMatrixWorld.call(this,a);a=this.context.listener;var b=this.up;if(this.timeDelta=mj.getDelta(),this.matrixWorld.decompose(Bb,ih,lj),Cb.set(0,0,-1).applyQuaternion(ih),a.positionX){var c=this.context.currentTime+
this.timeDelta;a.positionX.linearRampToValueAtTime(Bb.x,c);a.positionY.linearRampToValueAtTime(Bb.y,c);a.positionZ.linearRampToValueAtTime(Bb.z,c);a.forwardX.linearRampToValueAtTime(Cb.x,c);a.forwardY.linearRampToValueAtTime(Cb.y,c);a.forwardZ.linearRampToValueAtTime(Cb.z,c);a.upX.linearRampToValueAtTime(b.x,c);a.upY.linearRampToValueAtTime(b.y,c);a.upZ.linearRampToValueAtTime(b.z,c)}else a.setPosition(Bb.x,Bb.y,Bb.z),a.setOrientation(Cb.x,Cb.y,Cb.z,b.x,b.y,b.z)})});Mc.prototype=Object.assign(Object.create(E.prototype),
{constructor:Mc,getOutput:function(){return this.gain},setNodeSource:function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},setMediaElementSource:function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(a),this.connect(),this},setBuffer:function(a){return this.buffer=a,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying&&!1!==this.hasPlaybackControl){var a=
this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,a.onended=this.onEnded.bind(this),a.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,a.start(this.startTime,this.offset),this.isPlaying=!0,this.source=a,this.connect()}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=
!1),this},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);
for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(a){return a||(a=[]),!0===this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(a){return this.setFilters(a?[a]:[])},setPlaybackRate:function(a){if(!1!==
this.hasPlaybackControl)return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1!==this.hasPlaybackControl&&this.loop},setLoop:function(a){if(!1!==this.hasPlaybackControl)return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(a){return this.gain.gain.setTargetAtTime(a,
this.context.currentTime,.01),this}});ag.prototype=Object.assign(Object.create(Mc.prototype),{constructor:ag,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(a){return this.panner.refDistance=a,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(a){return this.panner.rolloffFactor=a,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(a){return this.panner.distanceModel=
a,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(a){return this.panner.maxDistance=a,this},setDirectionalCone:function(a,b,c){return this.panner.coneInnerAngle=a,this.panner.coneOuterAngle=b,this.panner.coneOuterGain=c,this},updateMatrixWorld:(Db=new n,jh=new la,nj=new n,Eb=new n,function(a){E.prototype.updateMatrixWorld.call(this,a);a=this.panner;if(this.matrixWorld.decompose(Db,jh,nj),Eb.set(0,0,1).applyQuaternion(jh),a.positionX){var b=this.context.currentTime+
this.listener.timeDelta;a.positionX.linearRampToValueAtTime(Db.x,b);a.positionY.linearRampToValueAtTime(Db.y,b);a.positionZ.linearRampToValueAtTime(Db.z,b);a.orientationX.linearRampToValueAtTime(Eb.x,b);a.orientationY.linearRampToValueAtTime(Eb.y,b);a.orientationZ.linearRampToValueAtTime(Eb.z,b)}else a.setPosition(Db.x,Db.y,Db.z),a.setOrientation(Eb.x,Eb.y,Eb.z)})});Object.assign(bg.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var a=
0,b=this.getFrequencyData(),c=0;c<b.length;c++)a+=b[c];return a/b.length}});Object.assign(cg.prototype,{accumulate:function(a,b){var c=this.buffer,d=this.valueSize;a=a*d+d;var e=this.cumulativeWeight;if(0===e){for(e=0;e!==d;++e)c[a+e]=c[e];e=b}else b/=e+=b,this._mixBufferRegion(c,a,0,b,d);this.cumulativeWeight=e},apply:function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.binding;(this.cumulativeWeight=0,1>d)&&this._mixBufferRegion(c,a,3*b,1-d,b);d=b;for(var f=
b+b;d!==f;++d)if(c[d]!==c[d+b]){e.setValue(c,a);break}},saveOriginalState:function(){var a=this.buffer,b=this.valueSize,c=3*b;this.binding.getValue(a,c);for(var d=b;d!==c;++d)a[d]=a[c+d%b];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(a,b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]},_slerp:function(a,b,c,d){la.slerpFlat(a,b,a,b,a,c,d)},_lerp:function(a,b,c,d,e){for(var f=1-d,g=0;g!==e;++g){var h=b+g;a[h]=a[h]*f+a[c+
g]*d}}});var oj,pj,qj,rj,sj,tj,uj,vj,wj,xj,kh,ue,Wa,eb,xf,lh,qb,ve,yf,yj,mh,nh,bd,we,oh,ph,xe,qh,ye,kg,wi,zj,rh;Object.assign(pi.prototype,{getValue:function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)},setValue:function(a,b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)},bind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()},unbind:function(){for(var a=
this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}});Object.assign(ta,{Composite:pi,create:function(a,b,c){return a&&a.isAnimationObjectGroup?new ta.Composite(a,b,c):new ta(a,b,c)},sanitizeNodeName:(vj=/[\[\]\.:\/]/g,function(a){return a.replace(/\s/g,"_").replace(vj,"")}),parseTrackName:(oj="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",pj=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),qj=/(WCOD+)?/.source.replace("WCOD",oj),rj=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",
"[^\\[\\]\\.:\\/]"),sj=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),tj=new RegExp("^"+pj+qj+rj+sj+"$"),uj=["material","materials","bones"],function(a){var b=tj.exec(a);if(!b)throw Error("PropertyBinding: Cannot parse trackName: "+a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]};var c=b.nodeName&&b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){var d=b.nodeName.substring(c+1);-1!==uj.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=
d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}),findNode:function(a,b){if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){var c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}return a.children&&(a=function f(a){for(var c=0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=f(e.children)))return e}return null}(a.children))?a:null}});Object.assign(ta.prototype,
{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,b){a[b]=this.node[this.propertyName]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)a[b++]=c[d]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,
b){this.targetObject[this.propertyName]=a[b]},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==
e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty.fromArray(a,b)},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,
b);this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(a,b){this.bind();this.getValue(a,b)},setValue:function(a,b){this.bind();this.setValue(a,b)},bind:function(){var a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;if(a||(a=ta.findNode(this.rootNode,b.nodeName)||this.rootNode,this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,a){if(c){var f=b.objectIndex;switch(c){case "materials":if(!a.material||!a.material.materials)return;
a=a.material.materials;break;case "bones":if(!a.skeleton)return;a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;default:if(void 0===a[c])return;a=a[c]}if(void 0!==f){if(void 0===a[f])return;a=a[f]}}f=a[d];if(void 0!==f){b=this.Versioning.None;void 0!==(this.targetObject=a).needsUpdate?b=this.Versioning.NeedsUpdate:void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate);c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry)return;
if(a.geometry.isBufferGeometry){if(!a.geometry.morphAttributes)return;for(c=0;c<this.node.geometry.morphAttributes.position.length;c++)if(a.geometry.morphAttributes.position[c].name===e){e=c;break}}else{if(!a.geometry.morphTargets)return;for(c=0;c<this.node.geometry.morphTargets.length;c++)if(a.geometry.morphTargets[c].name===e){e=c;break}}}c=this.BindingType.ArrayElement;this.resolvedProperty=f;this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,
this.resolvedProperty=f):Array.isArray(f)?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}else b.nodeName}},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});Object.assign(ta.prototype,{_getValue_unbound:ta.prototype.getValue,_setValue_unbound:ta.prototype.setValue});Object.assign(qi.prototype,{isAnimationObjectGroup:!0,
add:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._paths,f=this._parsedPaths,g=this._bindings,h=g.length,k=0,m=arguments.length;k!==m;++k){var l=arguments[k],n=l.uuid,r=d[n];if(void 0===r){r=b++;d[n]=r;a.push(l);n=0;for(var v=h;n!==v;++n)g[n].push(new ta(l,e[n],f[n]))}else if(r<c){a[r];var u=--c;v=a[u];a[d[v.uuid]=r]=v;a[d[n]=u]=l;n=0;for(v=h;n!==v;++n){var t=g[n],x=t[r];t[r]=t[u];void 0===x&&(x=new ta(l,e[n],f[n]));t[u]=x}}else a[r]}this.nCachedObjects_=
c},remove:function(){for(var a=this._objects,b=this.nCachedObjects_,c=this._indicesByUUID,d=this._bindings,e=d.length,f=0,g=arguments.length;f!==g;++f){var h=arguments[f],k=h.uuid,m=c[k];if(void 0!==m&&b<=m){var l=b++,n=a[l];a[c[n.uuid]=m]=n;a[c[k]=l]=h;h=0;for(k=e;h!==k;++h){n=d[h];var r=n[m];n[m]=n[l];n[l]=r}}}this.nCachedObjects_=b},uncache:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._bindings,f=e.length,g=0,h=arguments.length;g!==h;++g){var k=
arguments[g].uuid,m=d[k];if(void 0!==m)if(delete d[k],m<c){k=--c;var l=a[k],n=a[t=--b];a[d[l.uuid]=m]=l;a[d[n.uuid]=k]=n;a.pop();l=0;for(var r=f;l!==r;++l){var v=(x=e[l])[k],u=x[t];x[m]=v;x[k]=u;x.pop()}}else{var t;a[d[(n=a[t=--b]).uuid]=m]=n;a.pop();l=0;for(r=f;l!==r;++l){var x;(x=e[l])[m]=x[t];x.pop()}}}this.nCachedObjects_=c},subscribe_:function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var f=this._paths,g=this._parsedPaths,h=this._objects,k=this.nCachedObjects_,
m=Array(h.length);d=e.length;c[a]=d;f.push(a);g.push(b);e.push(m);c=k;for(d=h.length;c!==d;++c)m[c]=new ta(h[c],a,b);return m},unsubscribe_:function(a){var b=this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];f[b[a[g]]=c]=h;f.pop();e[c]=e[g];e.pop();d[c]=d[g];d.pop()}}});Object.assign(ri.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},
reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(a){return this._startTime=a,this},setLoop:function(a,b){return this.loop=a,this.repetitions=b,this},setEffectiveWeight:function(a){return this.weight=
a,this._effectiveWeight=this.enabled?a:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(a){return this._scheduleFading(a,0,1)},fadeOut:function(a){return this._scheduleFading(a,1,0)},crossFadeFrom:function(a,b,c){if(a.fadeOut(b),this.fadeIn(b),c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this},crossFadeTo:function(a,b,c){return a.crossFadeFrom(this,b,c)},stopFading:function(){var a=this._weightInterpolant;
return null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this},setEffectiveTimeScale:function(a){return this.timeScale=a,this._effectiveTimeScale=this.paused?0:a,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(a){return this.timeScale=this._clip.duration/a,this.stopWarping()},syncWith:function(a){return this.time=a.time,this.timeScale=a.timeScale,this.stopWarping()},halt:function(a){return this.warp(this._effectiveTimeScale,
0,a)},warp:function(a,b,c){var d=this._mixer,e=d.time,f=this._timeScaleInterpolant,g=this.timeScale;null===f&&(f=d._lendControlInterpolant(),this._timeScaleInterpolant=f);d=f.parameterPositions;f=f.sampleValues;return d[0]=e,d[1]=e+c,f[0]=a/g,f[1]=b/g,this},stopWarping:function(){var a=this._timeScaleInterpolant;return null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||
this._mixer._root},_update:function(a,b,c,d){if(this.enabled){var e=this._startTime;if(null!==e){b=(a-e)*c;if(0>b||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a){b=this._interpolants;e=this._propertyBindings;for(var f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}}else this._updateWeight(a)},_updateWeight:function(a){var b=0;if(this.enabled){b=this.weight;var c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0];
b*=d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){b=this.timeScale;var c=this._timeScaleInterpolant;null!==c&&(b*=c.evaluate(a)[0],a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b))}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a,c=this._clip.duration,d=this.loop,e=this._loopCount,f=2202===d;if(0===a)return-1===e?b:f&&1==
(1&e)?c-b:b;if(2200===d)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),c<=b)b=c;else{if(!(0>b))break a;b=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>a?-1:1})}else{if(-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f)),c<=b||0>b){d=Math.floor(b/c);b-=c*d;e+=Math.abs(d);var g=this.repetitions-e;0>=g?(this.clampWhenFinished?this.paused=!0:this.enabled=
!1,b=0<a?c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===g?(a=0>a,this._setEndings(a,!a,f)):this._setEndings(!1,!1,f),this._loopCount=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:d}))}if(f&&1==(1&e))return c-(this.time=b)}return this.time=b},_setEndings:function(a,b,c){var d=this._interpolantSettings;d.endingEnd=c?d.endingStart=2401:(d.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,b?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(a,
b,c){var d=this._mixer,e=d.time,f=this._weightInterpolant;null===f&&(f=d._lendControlInterpolant(),this._weightInterpolant=f);d=f.parameterPositions;f=f.sampleValues;return d[0]=e,f[0]=b,d[1]=e+a,f[1]=c,this}});dg.prototype=Object.assign(Object.create(Ja.prototype),{constructor:dg,_bindAction:function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings;a=a._interpolants;var g=c.uuid,h=this._bindingsByRootAndName,k=h[g];void 0===k&&(k={},h[g]=k);for(h=0;h!==e;++h){var m=
d[h],l=m.name,n=k[l];if(void 0===n){if(void 0!==(n=f[h])){null===n._cacheIndex&&(++n.referenceCount,this._addInactiveBinding(n,g,l));continue}++(n=new cg(ta.create(c,l,b&&b._propertyBindings[h].binding.parsedPath),m.ValueTypeName,m.getValueSize())).referenceCount;this._addInactiveBinding(n,g,l)}f[h]=n;a[h].resultBuffer=n.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid,d=this._actionsByClip[c];this._bindAction(a,
d&&d.knownActions[0]);this._addInactiveAction(a,c,b)}b=a._propertyBindings;c=0;for(d=b.length;c!==d;++c){var e=b[c];0==e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){for(var b=a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0==--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip=
{};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(a){a=a._cacheIndex;
return null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,b,c){var d=this._actions,e=this._actionsByClip,f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);f.actionByRoot[c]=a},_removeInactiveAction:function(a){var b=this._actions,c=b[b.length-1];b[c._cacheIndex=a._cacheIndex]=c;b.pop();a._cacheIndex=null;b=a._clip.uuid;c=this._actionsByClip;var d=c[b],e=d.knownActions,
f=e[e.length-1];e[f._byClipCacheIndex=a._byClipCacheIndex]=f;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){a=a._propertyBindings;for(var b=0,c=a.length;b!==c;++b){var d=a[b];0==--d.referenceCount&&this._removeInactiveBinding(d)}},_lendAction:function(a){var b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];b[a._cacheIndex=d]=a;b[e._cacheIndex=
c]=e},_takeBackAction:function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];b[a._cacheIndex=d]=a;b[e._cacheIndex=c]=e},_addInactiveBinding:function(a,b,c){var d=this._bindingsByRootAndName,e=d[b],f=this._bindings;void 0===e&&(e={},d[b]=e);(e[c]=a)._cacheIndex=f.length;f.push(a)},_removeInactiveBinding:function(a){var b=this._bindings,c=a.binding,d=c.rootNode.uuid;c=c.path;var e=this._bindingsByRootAndName,f=e[d],g=b[b.length-1];b[g._cacheIndex=a._cacheIndex]=g;b.pop();delete f[c];
a:{for(var h in f)break a;delete e[d]}},_lendBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];b[a._cacheIndex=d]=a;b[e._cacheIndex=c]=e},_takeBackBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=--this._nActiveBindings,e=b[d];b[a._cacheIndex=d]=a;b[e._cacheIndex=c]=e},_lendControlInterpolant:function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];return void 0===c&&(a[(c=new Nd(new Float32Array(2),new Float32Array(2),
1,this._controlInterpolantsResultBuffer)).__cacheIndex=b]=c),c},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];b[a.__cacheIndex=d]=a;b[e.__cacheIndex=c]=e},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(a,b){var c=b||this._root,d=c.uuid;c="string"==typeof a?Na.findByName(c,a):a;a=null!==c?c.uuid:a;var e=this._actionsByClip[a],f=null;if(void 0!==e){f=e.actionByRoot[d];if(void 0!==f)return f;
f=e.knownActions[0];null===c&&(c=f._clip)}if(null===c)return null;b=new ri(this,c,b);return this._bindAction(b,f),this._addInactiveAction(b,a,d),b},existingAction:function(a,b){var c=b||this._root;b=c.uuid;c="string"==typeof a?Na.findByName(c,a):a;a=this._actionsByClip[c?c.uuid:a];return void 0!==a&&a.actionByRoot[b]||null},stopAllAction:function(){for(var a=this._actions,b=this._nActiveActions,c=this._bindings,d=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=0;e!==b;++e)a[e].reset();
for(e=0;e!==d;++e)c[e].useCount=0;return this},update:function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1,g=0;g!==c;++g)b[g]._update(d,a,e,f);a=this._bindings;b=this._nActiveBindings;for(g=0;g!==b;++g)a[g].apply(f);return this},getRoot:function(){return this._root},uncacheClip:function(a){var b=this._actions;a=a.uuid;var c=this._actionsByClip,d=c[a];if(void 0!==d){d=d.knownActions;for(var e=0,f=d.length;e!==f;++e){var g=d[e];
this._deactivateAction(g);var h=g._cacheIndex,k=b[b.length-1];g._cacheIndex=null;g._byClipCacheIndex=null;b[k._cacheIndex=h]=k;b.pop();this._removeInactiveBindingsForAction(g)}delete c[a]}},uncacheRoot:function(a){a=a.uuid;var b=this._actionsByClip;for(d in b){var c=b[d].actionByRoot[a];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}var d=this._bindingsByRootAndName[a];if(void 0!==d)for(var e in d)a=d[e],a.restoreOriginalState(),this._removeInactiveBinding(a)},uncacheAction:function(a,
b){a=this.existingAction(a,b);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}});$e.prototype.clone=function(){return new $e(void 0===this.value.clone?this.value:this.value.clone())};eg.prototype=Object.assign(Object.create(F.prototype),{constructor:eg,isInstancedBufferGeometry:!0,copy:function(a){return F.prototype.copy.call(this,a),this.maxInstancedCount=a.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}});fg.prototype=Object.assign(Object.create(Ob.prototype),
{constructor:fg,isInstancedInterleavedBuffer:!0,copy:function(a){return Ob.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this}});gg.prototype=Object.assign(Object.create(X.prototype),{constructor:gg,isInstancedBufferAttribute:!0,copy:function(a){return X.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this}});Object.assign(hg.prototype,{linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(a,b){b&&b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),
this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize()):b&&b.isOrthographicCamera&&(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld))},intersectObject:function(a,b,c){c=c||[];return ig(a,this,c,b),c.sort(si),c},intersectObjects:function(a,b,c){c=c||[];if(!1===Array.isArray(a))return c;for(var d=0,e=a.length;d<e;d++)ig(a[d],this,c,b);return c.sort(si),c}});Object.assign(ti.prototype,{set:function(a,
b,c){return this.radius=a,this.phi=b,this.theta=c,this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.radius=a.radius,this.phi=a.phi,this.theta=a.theta,this},makeSafe:function(){return this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi)),this},setFromVector3:function(a){return this.setFromCartesianCoords(a.x,a.y,a.z)},setFromCartesianCoords:function(a,b,c){return this.radius=Math.sqrt(a*a+b*b+c*c),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(a,
c),this.phi=Math.acos(Q.clamp(b/this.radius,-1,1))),this}});Object.assign(ui.prototype,{set:function(a,b,c){return this.radius=a,this.theta=b,this.y=c,this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.radius=a.radius,this.theta=a.theta,this.y=a.y,this},setFromVector3:function(a){return this.setFromCartesianCoords(a.x,a.y,a.z)},setFromCartesianCoords:function(a,b,c){return this.radius=Math.sqrt(a*a+c*c),this.theta=Math.atan2(a,c),this.y=b,this}});Object.assign(af.prototype,
{set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:(xj=new x,function(a,b){b=xj.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,
this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(a){return void 0===a&&(a=new x),this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){return void 0===a&&(a=new x),this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),
this.max.addScalar(a),this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){return void 0===b&&(b=new x),b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},
clampPoint:function(a,b){return void 0===b&&(b=new x),b.copy(a).clamp(this.min,this.max)},distanceToPoint:(wj=new x,function(a){return wj.copy(a).clamp(this.min,this.max).sub(a).length()}),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(jg.prototype,
{set:function(a,b){return this.start.copy(a),this.end.copy(b),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.start.copy(a.start),this.end.copy(a.end),this},getCenter:function(a){return void 0===a&&(a=new n),a.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(a){return void 0===a&&(a=new n),a.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},
at:function(a,b){return void 0===b&&(b=new n),this.delta(b).multiplyScalar(a).add(this.start)},closestPointToPointParameter:(kh=new n,ue=new n,function(a,b){kh.subVectors(a,this.start);ue.subVectors(this.end,this.start);a=ue.dot(ue);a=ue.dot(kh)/a;return b&&(a=Q.clamp(a,0,1)),a}),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);return void 0===c&&(c=new n),this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){return this.start.applyMatrix4(a),this.end.applyMatrix4(a),
this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}});Vd.prototype=Object.create(E.prototype);Vd.prototype.constructor=Vd;Vd.prototype.isImmediateRenderObject=!0;Wd.prototype=Object.create(ba.prototype);Wd.prototype.constructor=Wd;Wd.prototype.update=(Wa=new n,eb=new n,xf=new ua,function(){var a=["a","b","c"];this.object.updateMatrixWorld(!0);xf.getNormalMatrix(this.object.matrixWorld);var b=this.object.matrixWorld,c=this.geometry.attributes.position,d=this.object.geometry;
if(d&&d.isGeometry)for(var e=d.vertices,f=d.faces,g=d=0,h=f.length;g<h;g++)for(var k=f[g],m=0,l=k.vertexNormals.length;m<l;m++){var n=k.vertexNormals[m];Wa.copy(e[k[a[m]]]).applyMatrix4(b);eb.copy(n).applyMatrix3(xf).normalize().multiplyScalar(this.size).add(Wa);c.setXYZ(d,Wa.x,Wa.y,Wa.z);d+=1;c.setXYZ(d,eb.x,eb.y,eb.z);d+=1}else if(d&&d.isBufferGeometry)for(a=d.attributes.position,e=d.attributes.normal,m=d=0,l=a.count;m<l;m++)Wa.set(a.getX(m),a.getY(m),a.getZ(m)).applyMatrix4(b),eb.set(e.getX(m),
e.getY(m),e.getZ(m)),eb.applyMatrix3(xf).normalize().multiplyScalar(this.size).add(Wa),c.setXYZ(d,Wa.x,Wa.y,Wa.z),d+=1,c.setXYZ(d,eb.x,eb.y,eb.z),d+=1;c.needsUpdate=!0});Nc.prototype=Object.create(E.prototype);Nc.prototype.constructor=Nc;Nc.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};Nc.prototype.update=(lh=new n,function(){this.light.updateMatrixWorld();var a=this.light.distance?this.light.distance:1E3,b=a*Math.tan(this.light.angle);this.cone.scale.set(b,
b,a);lh.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(lh);void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)});Oc.prototype=Object.create(ba.prototype);Oc.prototype.constructor=Oc;Oc.prototype.updateMatrixWorld=(qb=new n,ve=new I,yf=new I,function(a){var b=this.bones,c=this.geometry,d=c.getAttribute("position");yf.getInverse(this.root.matrixWorld);for(var e=0,f=0;e<b.length;e++){var g=b[e];g.parent&&g.parent.isBone&&
(ve.multiplyMatrices(yf,g.matrixWorld),qb.setFromMatrixPosition(ve),d.setXYZ(f,qb.x,qb.y,qb.z),ve.multiplyMatrices(yf,g.parent.matrixWorld),qb.setFromMatrixPosition(ve),d.setXYZ(f+1,qb.x,qb.y,qb.z),f+=2)}c.getAttribute("position").needsUpdate=!0;E.prototype.updateMatrixWorld.call(this,a)});Pc.prototype=Object.create(wa.prototype);Pc.prototype.constructor=Pc;Pc.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};Pc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):
this.material.color.copy(this.light.color)};Qc.prototype=Object.create(E.prototype);Qc.prototype.constructor=Qc;Qc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};Qc.prototype.update=function(){var a=.5*this.light.width,b=.5*this.light.height,c=this.line.geometry.attributes.position,d=c.array;d[0]=a;d[1]=-b;d[2]=0;d[3]=a;d[4]=b;d[5]=0;d[6]=-a;d[7]=b;d[8]=0;d[9]=-a;d[10]=-b;d[11]=0;d[12]=a;d[13]=-b;d[14]=0;c.needsUpdate=!0;void 0!==this.color?this.line.material.color.set(this.color):
this.line.material.color.copy(this.light.color)};Rc.prototype=Object.create(E.prototype);Rc.prototype.constructor=Rc;Rc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};Rc.prototype.update=(yj=new n,mh=new L,nh=new L,function(){var a=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var b=a.geometry.getAttribute("color");mh.copy(this.light.color);nh.copy(this.light.groundColor);for(var c=0,d=b.count;c<d;c++){var e=
c<d/2?mh:nh;b.setXYZ(c,e.r,e.g,e.b)}b.needsUpdate=!0}a.lookAt(yj.setFromMatrixPosition(this.light.matrixWorld).negate())});Xd.prototype=Object.create(ba.prototype);Xd.prototype.constructor=Xd;bf.prototype=Object.create(ba.prototype);bf.prototype.constructor=bf;Yd.prototype=Object.create(ba.prototype);Yd.prototype.constructor=Yd;Yd.prototype.update=(bd=new n,we=new n,oh=new ua,function(){this.object.updateMatrixWorld(!0);oh.getNormalMatrix(this.object.matrixWorld);var a=this.object.matrixWorld,b=this.geometry.attributes.position,
c=this.object.geometry,d=c.vertices;c=c.faces;for(var e=0,f=0,g=c.length;f<g;f++){var h=c[f],k=h.normal;bd.copy(d[h.a]).add(d[h.b]).add(d[h.c]).divideScalar(3).applyMatrix4(a);we.copy(k).applyMatrix3(oh).normalize().multiplyScalar(this.size).add(bd);b.setXYZ(e,bd.x,bd.y,bd.z);e+=1;b.setXYZ(e,we.x,we.y,we.z);e+=1}b.needsUpdate=!0});Sc.prototype=Object.create(E.prototype);Sc.prototype.constructor=Sc;Sc.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();
this.targetLine.geometry.dispose();this.targetLine.material.dispose()};Sc.prototype.update=(ph=new n,xe=new n,qh=new n,function(){ph.setFromMatrixPosition(this.light.matrixWorld);xe.setFromMatrixPosition(this.light.target.matrixWorld);qh.subVectors(xe,ph);this.lightPlane.lookAt(xe);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));
this.targetLine.lookAt(xe);this.targetLine.scale.z=qh.length()});Zd.prototype=Object.create(ba.prototype);Zd.prototype.constructor=Zd;Zd.prototype.update=function(){function a(a,g,h,k){d.set(g,h,k).unproject(e);a=c[a];if(void 0!==a)for(g=b.getAttribute("position"),h=0,k=a.length;h<k;h++)g.setXYZ(a[h],d.x,d.y,d.z)}var b,c,d=new n,e=new Za;return function(){b=this.geometry;c=this.pointMap;e.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);
a("n3",-1,1,-1);a("n4",1,1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",.7,1.1,-1);a("u2",-.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);b.getAttribute("position").needsUpdate=!0}}();mb.prototype=Object.create(ba.prototype);mb.prototype.constructor=mb;mb.prototype.update=(ye=new fb,function(a){if(void 0!==this.object&&ye.setFromObject(this.object),!ye.isEmpty()){a=
ye.min;var b=ye.max,c=this.geometry.attributes.position,d=c.array;d[0]=b.x;d[1]=b.y;d[2]=b.z;d[3]=a.x;d[4]=b.y;d[5]=b.z;d[6]=a.x;d[7]=a.y;d[8]=b.z;d[9]=b.x;d[10]=a.y;d[11]=b.z;d[12]=b.x;d[13]=b.y;d[14]=a.z;d[15]=a.x;d[16]=b.y;d[17]=a.z;d[18]=a.x;d[19]=a.y;d[20]=a.z;d[21]=b.x;d[22]=a.y;d[23]=a.z;c.needsUpdate=!0;this.geometry.computeBoundingSphere()}});mb.prototype.setFromObject=function(a){return this.object=a,this.update(),this};mb.prototype.copy=function(a){return ba.prototype.copy.call(this,a),
this.object=a.object,this};mb.prototype.clone=function(){return(new this.constructor).copy(this)};$d.prototype=Object.create(ba.prototype);$d.prototype.constructor=$d;$d.prototype.updateMatrixWorld=function(a){var b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),E.prototype.updateMatrixWorld.call(this,a))};ae.prototype=Object.create(xa.prototype);ae.prototype.constructor=ae;ae.prototype.updateMatrixWorld=function(a){var b=-this.plane.constant;
1E-8>Math.abs(b)&&(b=1E-8);this.scale.set(.5*this.size,.5*this.size,b);this.children[0].material.side=0>b?1:0;this.lookAt(this.plane.normal);E.prototype.updateMatrixWorld.call(this,a)};nb.prototype=Object.create(E.prototype);nb.prototype.constructor=nb;nb.prototype.setDirection=(rh=new n,function(a){.99999<a.y?this.quaternion.set(0,0,0,1):-.99999>a.y?this.quaternion.set(1,0,0,0):(rh.set(a.z,0,-a.x).normalize(),zj=Math.acos(a.y),this.quaternion.setFromAxisAngle(rh,zj))});nb.prototype.setLength=function(a,
b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,Math.max(0,a-b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};nb.prototype.setColor=function(a){this.line.material.color.copy(a);this.cone.material.color.copy(a)};nb.prototype.copy=function(a){return E.prototype.copy.call(this,a,!1),this.line.copy(a.line),this.cone.copy(a.cone),this};nb.prototype.clone=function(){return(new this.constructor).copy(this)};be.prototype=Object.create(ba.prototype);
be.prototype.constructor=be;var sh;S.create=function(a,b){return a.prototype=Object.create(S.prototype),(a.prototype.constructor=a).prototype.getPoint=b,a};Object.assign(lb.prototype,{createPointsGeometry:function(a){a=this.getPoints(a);return this.createGeometry(a)},createSpacedPointsGeometry:function(a){a=this.getSpacedPoints(a);return this.createGeometry(a)},createGeometry:function(a){for(var b=new J,c=0,d=a.length;c<d;c++){var e=a[c];b.vertices.push(new n(e.x,e.y,e.z||0))}return b}});Object.assign(Ta.prototype,
{fromPoints:function(a){this.setFromPoints(a)}});xi.prototype=Object.create(ra.prototype);yi.prototype=Object.create(ra.prototype);lg.prototype=Object.create(ra.prototype);Object.assign(lg.prototype,{initFromArray:function(){},getControlPointsArray:function(){},reparametrizeByArcLength:function(){}});Xd.prototype.setColors=function(){};Oc.prototype.update=function(){};Object.assign(Td.prototype,{extractUrlBase:function(a){return ah.extractUrlBase(a)}});Object.assign(Tf.prototype,{setTexturePath:function(a){return this.setResourcePath(a)}});
Object.assign(af.prototype,{center:function(a){return this.getCenter(a)},empty:function(){return this.isEmpty()},isIntersectionBox:function(a){return this.intersectsBox(a)},size:function(a){return this.getSize(a)}});Object.assign(fb.prototype,{center:function(a){return this.getCenter(a)},empty:function(){return this.isEmpty()},isIntersectionBox:function(a){return this.intersectsBox(a)},isIntersectionSphere:function(a){return this.intersectsSphere(a)},size:function(a){return this.getSize(a)}});jg.prototype.center=
function(a){return this.getCenter(a)};Object.assign(Q,{random16:function(){return Math.random()},nearestPowerOfTwo:function(a){return Q.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){return Q.ceilPowerOfTwo(a)}});Object.assign(ua.prototype,{flattenToArrayOffset:function(a,b){return this.toArray(a,b)},multiplyVector3:function(a){return a.applyMatrix3(this)},multiplyVector3Array:function(){},applyToBuffer:function(a){return this.applyToBufferAttribute(a)},applyToVector3Array:function(){}});Object.assign(I.prototype,
{extractPosition:function(a){return this.copyPosition(a)},flattenToArrayOffset:function(a,b){return this.toArray(a,b)},getPosition:function(){return void 0===sh&&(sh=new n),sh.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(a){return this.makeRotationFromQuaternion(a)},multiplyToArray:function(){},multiplyVector3:function(a){return a.applyMatrix4(this)},multiplyVector4:function(a){return a.applyMatrix4(this)},multiplyVector3Array:function(){},rotateAxis:function(a){a.transformDirection(this)},
crossVector:function(a){return a.applyMatrix4(this)},translate:function(){},rotateX:function(){},rotateY:function(){},rotateZ:function(){},rotateByAxis:function(){},applyToBuffer:function(a){return this.applyToBufferAttribute(a)},applyToVector3Array:function(){},makeFrustum:function(a,b,c,d,e,f){return this.makePerspective(a,b,d,c,e,f)}});Xa.prototype.isIntersectionLine=function(a){return this.intersectsLine(a)};la.prototype.multiplyVector3=function(a){return a.applyQuaternion(this)};Object.assign(Nb.prototype,
{isIntersectionBox:function(a){return this.intersectsBox(a)},isIntersectionPlane:function(a){return this.intersectsPlane(a)},isIntersectionSphere:function(a){return this.intersectsSphere(a)}});Object.assign(sa.prototype,{area:function(){return this.getArea()},barycoordFromPoint:function(a,b){return this.getBarycoord(a,b)},midpoint:function(a){return this.getMidpoint(a)},normal:function(a){return this.getNormal(a)},plane:function(a){return this.getPlane(a)}});Object.assign(sa,{barycoordFromPoint:function(a,
b,c,d,e){return sa.getBarycoord(a,b,c,d,e)},normal:function(a,b,c,d){return sa.getNormal(a,b,c,d)}});Object.assign(wb.prototype,{extractAllPoints:function(a){return this.extractPoints(a)},extrude:function(a){return new Rb(this,a)},makeGeometry:function(a){return new Tb(this,a)}});Object.assign(x.prototype,{fromAttribute:function(a,b,c){return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){return this.manhattanDistanceTo(a)},lengthManhattan:function(){return this.manhattanLength()}});
Object.assign(n.prototype,{setEulerFromRotationMatrix:function(){},setEulerFromQuaternion:function(){},getPositionFromMatrix:function(a){return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){return this.setFromMatrixColumn(b,a)},applyProjection:function(a){return this.applyMatrix4(a)},fromAttribute:function(a,b,c){return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){return this.manhattanDistanceTo(a)},
lengthManhattan:function(){return this.manhattanLength()}});Object.assign(da.prototype,{fromAttribute:function(a,b,c){return this.fromBufferAttribute(a,b,c)},lengthManhattan:function(){return this.manhattanLength()}});Object.assign(J.prototype,{computeTangents:function(){},computeLineDistances:function(){}});Object.assign(E.prototype,{getChildByName:function(a){return this.getObjectByName(a)},renderDepth:function(){},translate:function(a,b){return this.translateOnAxis(b,a)},getWorldRotation:function(){}});
Object.defineProperties(E.prototype,{eulerOrder:{get:function(){return this.rotation.order},set:function(a){this.rotation.order=a}},useQuaternion:{get:function(){},set:function(){}}});Object.defineProperties(pd.prototype,{objects:{get:function(){return this.levels}}});Object.defineProperty(He.prototype,"useVertexTexture",{get:function(){},set:function(){}});qd.prototype.initBones=function(){};Object.defineProperty(S.prototype,"__arcLengthDivisions",{get:function(){return this.arcLengthDivisions},
set:function(a){this.arcLengthDivisions=a}});ja.prototype.setLens=function(a,b){void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties(ia.prototype,{onlyShadow:{set:function(){}},shadowCameraFov:{set:function(a){this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){this.shadow.camera.bottom=
a}},shadowCameraNear:{set:function(a){this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){}},shadowBias:{set:function(a){this.shadow.bias=a}},shadowDarkness:{set:function(){}},shadowMapWidth:{set:function(a){this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){this.shadow.mapSize.height=a}}});Object.defineProperties(X.prototype,{length:{get:function(){return this.array.length}},copyIndicesArray:function(){}});Object.assign(F.prototype,
{addIndex:function(a){this.setIndex(a)},addDrawCall:function(a,b,c){this.addGroup(a,b)},clearDrawCalls:function(){this.clearGroups()},computeTangents:function(){},computeOffsets:function(){}});Object.defineProperties(F.prototype,{drawcalls:{get:function(){return this.groups}},offsets:{get:function(){return this.groups}}});Object.assign($a.prototype,{getArrays:function(){},addShapeList:function(){},addShape:function(){}});Object.defineProperties($e.prototype,{dynamic:{set:function(){}},onUpdate:{value:function(){return this}}});
Object.defineProperties(U.prototype,{wrapAround:{get:function(){},set:function(){}},overdraw:{get:function(){},set:function(){}},wrapRGB:{get:function(){return new L}},shading:{get:function(){},set:function(a){this.flatShading=1===a}}});Object.defineProperties(Ma.prototype,{metal:{get:function(){return!1},set:function(){}}});Object.defineProperties(Ea.prototype,{derivatives:{get:function(){return this.extensions.derivatives},set:function(a){this.extensions.derivatives=a}}});Object.assign(Jf.prototype,
{clearTarget:function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)},animate:function(a){this.setAnimationLoop(a)},getCurrentRenderTarget:function(){return this.getRenderTarget()},getMaxAnisotropy:function(){return this.capabilities.getMaxAnisotropy()},getPrecision:function(){return this.capabilities.precision},resetGLState:function(){return this.state.reset()},supportsFloatTextures:function(){return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return this.extensions.get("OES_texture_half_float")},
supportsStandardDerivatives:function(){return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return this.extensions.get("ANGLE_instanced_arrays")},
enableScissorTest:function(a){this.setScissorTest(a)},initMaterial:function(){},addPrePlugin:function(){},addPostPlugin:function(){},updateShadowMap:function(){},setFaceCulling:function(){}});Object.defineProperties(Jf.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){this.shadowMap.type=a}},shadowMapCullFace:{get:function(){},set:function(){}}});Object.defineProperties(Wh.prototype,
{cullFace:{get:function(){},set:function(){}},renderReverseSided:{get:function(){},set:function(){}},renderSingleSided:{get:function(){},set:function(){}}});Object.defineProperties(Gb.prototype,{wrapS:{get:function(){return this.texture.wrapS},set:function(a){this.texture.wrapS=a}},wrapT:{get:function(){return this.texture.wrapT},set:function(a){this.texture.wrapT=a}},magFilter:{get:function(){return this.texture.magFilter},set:function(a){this.texture.magFilter=a}},minFilter:{get:function(){return this.texture.minFilter},
set:function(a){this.texture.minFilter=a}},anisotropy:{get:function(){return this.texture.anisotropy},set:function(a){this.texture.anisotropy=a}},offset:{get:function(){return this.texture.offset},set:function(a){this.texture.offset=a}},repeat:{get:function(){return this.texture.repeat},set:function(a){this.texture.repeat=a}},format:{get:function(){return this.texture.format},set:function(a){this.texture.format=a}},type:{get:function(){return this.texture.type},set:function(a){this.texture.type=a}},
generateMipmaps:{get:function(){return this.texture.generateMipmaps},set:function(a){this.texture.generateMipmaps=a}}});Object.defineProperties(bi.prototype,{standing:{set:function(){}},userHeight:{set:function(){}}});Mc.prototype.load=function(a){var b=this;return(new Xf).load(a,function(a){b.setBuffer(a)}),this};bg.prototype.getData=function(){return this.getFrequencyData()};Ud.prototype.updateCubeMap=function(a,b){return this.update(a,b)};zb.crossOrigin=void 0;zb.loadTexture=function(a,b,c,d){var e=
new Qe;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);return b&&(a.mapping=b),a};zb.loadTextureCube=function(a,b,c,d){var e=new Qf;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);return b&&(a.mapping=b),a};zb.loadCompressedTexture=function(){};zb.loadCompressedTextureCube=function(){};var A=Object.freeze({WebGLRenderTargetCube:jc,WebGLRenderTarget:Gb,WebGLRenderer:Jf,ShaderLib:Ya,UniformsLib:H,UniformsUtils:Wk,ShaderChunk:Y,FogExp2:qc,Fog:rc,Scene:Ge,Sprite:vb,LOD:pd,SkinnedMesh:qd,
Skeleton:He,Bone:Kf,Mesh:wa,LineSegments:ba,LineLoop:Ie,Line:xa,Points:tc,Group:pc,VideoTexture:Lf,DataTexture:Hb,DataTexture3D:nc,CompressedTexture:uc,CubeTexture:gb,CanvasTexture:rd,DepthTexture:sd,Texture:Z,AnimationLoader:ki,CompressedTextureLoader:li,DataTextureLoader:Pf,CubeTextureLoader:Qf,TextureLoader:Qe,ObjectLoader:Tf,MaterialLoader:Ze,BufferGeometryLoader:Sf,DefaultLoadingManager:za,LoadingManager:Of,ImageLoader:Pd,ImageBitmapLoader:Uf,FontLoader:ni,FileLoader:Oa,Loader:Td,LoaderUtils:ah,
Cache:fc,AudioLoader:Xf,SpotLightShadow:Se,SpotLight:Te,PointLight:Ue,RectAreaLight:Ye,HemisphereLight:Re,DirectionalLightShadow:Ve,DirectionalLight:We,AmbientLight:Xe,LightShadow:cc,Light:ia,StereoCamera:oi,PerspectiveCamera:ja,OrthographicCamera:Sd,CubeCamera:Ud,ArrayCamera:nd,Camera:Za,AudioListener:Zf,PositionalAudio:ag,AudioContext:$f,AudioAnalyser:bg,Audio:Mc,VectorKeyframeTrack:Kc,StringKeyframeTrack:Pe,QuaternionKeyframeTrack:Od,NumberKeyframeTrack:Jc,ColorKeyframeTrack:Ne,BooleanKeyframeTrack:Me,
PropertyMixer:cg,PropertyBinding:ta,KeyframeTrack:oa,AnimationUtils:ca,AnimationObjectGroup:qi,AnimationMixer:dg,AnimationClip:Na,Uniform:$e,InstancedBufferGeometry:eg,BufferGeometry:F,Geometry:J,InterleavedBufferAttribute:od,InstancedInterleavedBuffer:fg,InterleavedBuffer:Ob,InstancedBufferAttribute:gg,Face3:lc,Object3D:E,Raycaster:hg,Layers:Df,EventDispatcher:Ja,Clock:Yf,QuaternionLinearInterpolant:Oe,LinearInterpolant:Nd,DiscreteInterpolant:Le,CubicInterpolant:Ke,Interpolant:Fa,Triangle:sa,Math:Q,
Spherical:ti,Cylindrical:ui,Plane:Xa,Frustum:Ae,Sphere:Ka,Ray:Nb,Matrix4:I,Matrix3:ua,Box3:fb,Box2:af,Line3:jg,Euler:Ib,Vector4:da,Vector3:n,Vector2:x,Quaternion:la,Color:L,ImmediateRenderObject:Vd,VertexNormalsHelper:Wd,SpotLightHelper:Nc,SkeletonHelper:Oc,PointLightHelper:Pc,RectAreaLightHelper:Qc,HemisphereLightHelper:Rc,GridHelper:Xd,PolarGridHelper:bf,FaceNormalsHelper:Yd,DirectionalLightHelper:Sc,CameraHelper:Zd,BoxHelper:mb,Box3Helper:$d,PlaneHelper:ae,ArrowHelper:nb,AxesHelper:be,Shape:wb,
Path:Ta,ShapePath:Vf,Font:Wf,CurvePath:lb,Curve:S,ImageUtils:zb,ShapeUtils:jb,WebGLUtils:Yh,WireframeGeometry:vc,ParametricGeometry:td,ParametricBufferGeometry:wc,TetrahedronGeometry:vd,TetrahedronBufferGeometry:xc,OctahedronGeometry:wd,OctahedronBufferGeometry:Pb,IcosahedronGeometry:xd,IcosahedronBufferGeometry:yc,DodecahedronGeometry:yd,DodecahedronBufferGeometry:zc,PolyhedronGeometry:ud,PolyhedronBufferGeometry:ya,TubeGeometry:zd,TubeBufferGeometry:Ac,TorusKnotGeometry:Ad,TorusKnotBufferGeometry:Bc,
TorusGeometry:Bd,TorusBufferGeometry:Cc,TextGeometry:Gd,TextBufferGeometry:Dc,SphereGeometry:Hd,SphereBufferGeometry:Sb,RingGeometry:Id,RingBufferGeometry:Ec,PlaneGeometry:kd,PlaneBufferGeometry:Mb,LatheGeometry:Jd,LatheBufferGeometry:Fc,ShapeGeometry:Tb,ShapeBufferGeometry:Ub,ExtrudeGeometry:Rb,ExtrudeBufferGeometry:$a,EdgesGeometry:Gc,ConeGeometry:Kd,ConeBufferGeometry:Ld,CylinderGeometry:Vb,CylinderBufferGeometry:kb,CircleGeometry:Md,CircleBufferGeometry:Hc,BoxGeometry:mc,BoxBufferGeometry:Lb,
ShadowMaterial:Wb,SpriteMaterial:ib,RawShaderMaterial:Ic,ShaderMaterial:Ea,PointsMaterial:La,MeshPhysicalMaterial:Xb,MeshStandardMaterial:ab,MeshPhongMaterial:Ma,MeshToonMaterial:Yb,MeshNormalMaterial:Zb,MeshLambertMaterial:$b,MeshDepthMaterial:sb,MeshDistanceMaterial:tb,MeshBasicMaterial:Ha,MeshMatcapMaterial:ac,LineDashedMaterial:bc,LineBasicMaterial:aa,Material:U,Float64BufferAttribute:jd,Float32BufferAttribute:B,Uint32BufferAttribute:Kb,Int32BufferAttribute:id,Uint16BufferAttribute:Jb,Int16BufferAttribute:hd,
Uint8ClampedBufferAttribute:gd,Uint8BufferAttribute:fd,Int8BufferAttribute:ed,BufferAttribute:X,ArcCurve:Lc,CatmullRomCurve3:ra,CubicBezierCurve:Pa,CubicBezierCurve3:bb,EllipseCurve:Ga,LineCurve:va,LineCurve3:Qa,QuadraticBezierCurve:Ra,QuadraticBezierCurve3:cb,SplineCurve:Sa,REVISION:"99dev",MOUSE:{LEFT:0,MIDDLE:1,RIGHT:2},CullFaceNone:0,CullFaceBack:1,CullFaceFront:2,CullFaceFrontBack:3,FrontFaceDirectionCW:0,FrontFaceDirectionCCW:1,BasicShadowMap:0,PCFShadowMap:1,PCFSoftShadowMap:2,FrontSide:0,
BackSide:1,DoubleSide:2,FlatShading:1,SmoothShading:2,NoColors:0,FaceColors:1,VertexColors:2,NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5,AddEquation:100,SubtractEquation:101,ReverseSubtractEquation:102,MinEquation:103,MaxEquation:104,ZeroFactor:200,OneFactor:201,SrcColorFactor:202,OneMinusSrcColorFactor:203,SrcAlphaFactor:204,OneMinusSrcAlphaFactor:205,DstAlphaFactor:206,OneMinusDstAlphaFactor:207,DstColorFactor:208,OneMinusDstColorFactor:209,
SrcAlphaSaturateFactor:210,NeverDepth:0,AlwaysDepth:1,LessDepth:2,LessEqualDepth:3,EqualDepth:4,GreaterEqualDepth:5,GreaterDepth:6,NotEqualDepth:7,MultiplyOperation:0,MixOperation:1,AddOperation:2,NoToneMapping:0,LinearToneMapping:1,ReinhardToneMapping:2,Uncharted2ToneMapping:3,CineonToneMapping:4,ACESFilmicToneMapping:5,UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,
CubeUVRefractionMapping:307,RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002,NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008,UnsignedByteType:1009,ByteType:1010,ShortType:1011,UnsignedShortType:1012,IntType:1013,UnsignedIntType:1014,FloatType:1015,HalfFloatType:1016,UnsignedShort4444Type:1017,UnsignedShort5551Type:1018,UnsignedShort565Type:1019,UnsignedInt248Type:1020,
AlphaFormat:1021,RGBFormat:1022,RGBAFormat:1023,LuminanceFormat:1024,LuminanceAlphaFormat:1025,RGBEFormat:1023,DepthFormat:1026,DepthStencilFormat:1027,RedFormat:1028,RGB_S3TC_DXT1_Format:33776,RGBA_S3TC_DXT1_Format:33777,RGBA_S3TC_DXT3_Format:33778,RGBA_S3TC_DXT5_Format:33779,RGB_PVRTC_4BPPV1_Format:35840,RGB_PVRTC_2BPPV1_Format:35841,RGBA_PVRTC_4BPPV1_Format:35842,RGBA_PVRTC_2BPPV1_Format:35843,RGB_ETC1_Format:36196,RGBA_ASTC_4x4_Format:37808,RGBA_ASTC_5x4_Format:37809,RGBA_ASTC_5x5_Format:37810,
RGBA_ASTC_6x5_Format:37811,RGBA_ASTC_6x6_Format:37812,RGBA_ASTC_8x5_Format:37813,RGBA_ASTC_8x6_Format:37814,RGBA_ASTC_8x8_Format:37815,RGBA_ASTC_10x5_Format:37816,RGBA_ASTC_10x6_Format:37817,RGBA_ASTC_10x8_Format:37818,RGBA_ASTC_10x10_Format:37819,RGBA_ASTC_12x10_Format:37820,RGBA_ASTC_12x12_Format:37821,LoopOnce:2200,LoopRepeat:2201,LoopPingPong:2202,InterpolateDiscrete:2300,InterpolateLinear:2301,InterpolateSmooth:2302,ZeroCurvatureEnding:2400,ZeroSlopeEnding:2401,WrapAroundEnding:2402,TrianglesDrawMode:0,
TriangleStripDrawMode:1,TriangleFanDrawMode:2,LinearEncoding:3E3,sRGBEncoding:3001,GammaEncoding:3007,RGBEEncoding:3002,LogLuvEncoding:3003,RGBM7Encoding:3004,RGBM16Encoding:3005,RGBDEncoding:3006,BasicDepthPacking:3200,RGBADepthPacking:3201,TangentSpaceNormalMap:0,ObjectSpaceNormalMap:1,CubeGeometry:mc,Face4:function(a,b,c,d,e,f,g){return new lc(a,b,c,e,f,g)},LineStrip:0,LinePieces:1,MeshFaceMaterial:function(a){return a},MultiMaterial:function(a){return void 0===a&&(a=[]),a.isMultiMaterial=!0,(a.materials=
a).clone=function(){return a.slice()},a},PointCloud:function(a,b){return new tc(a,b)},Particle:function(a){return new vb(a)},ParticleSystem:function(a,b){return new tc(a,b)},PointCloudMaterial:function(a){return new La(a)},ParticleBasicMaterial:function(a){return new La(a)},ParticleSystemMaterial:function(a){return new La(a)},Vertex:function(a,b,c){return new n(a,b,c)},DynamicBufferAttribute:function(a,b){return(new X(a,b)).setDynamic(!0)},Int8Attribute:function(a,b){return new ed(a,b)},Uint8Attribute:function(a,
b){return new fd(a,b)},Uint8ClampedAttribute:function(a,b){return new gd(a,b)},Int16Attribute:function(a,b){return new hd(a,b)},Uint16Attribute:function(a,b){return new Jb(a,b)},Int32Attribute:function(a,b){return new id(a,b)},Uint32Attribute:function(a,b){return new Kb(a,b)},Float32Attribute:function(a,b){return new B(a,b)},Float64Attribute:function(a,b){return new jd(a,b)},ClosedSplineCurve3:xi,SplineCurve3:yi,Spline:lg,AxisHelper:function(a){return new be(a)},BoundingBoxHelper:function(a,b){return new mb(a,
b)},EdgesHelper:function(a,b){return new ba(new Gc(a.geometry),new aa({color:void 0!==b?b:16777215}))},WireframeHelper:function(a,b){return new ba(new vc(a.geometry),new aa({color:void 0!==b?b:16777215}))},XHRLoader:function(a){return new Oa(a)},BinaryTextureLoader:function(a){return new Pf(a)},GeometryUtils:{merge:function(a,b,c){var d;b.isMesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,b=b.geometry);a.merge(b,d,c)},center:function(a){return a.center()}},Projector:function(){this.projectVector=
function(a,b){a.project(b)};this.unprojectVector=function(a,b){a.unproject(b)};this.pickingRay=function(){}},CanvasRenderer:function(){},JSONLoader:function(){},SceneUtils:{createMultiMaterialObject:function(){},detach:function(){},attach:function(){}},LensFlare:function(){}}),al=(th=new hg,uh=new x,vh=new n(uh.x,uh.y,.5),wh=function(a,b,c){if(0!==Fb(b._overlays).concat([b]).filter(function(b){return b.hasEventListener(a)}).length)return c=c.touches?c.touches[0]:c,vh.set(c.pageX/b.$wrapper.clientWidth*
2-1,-c.pageY/b.$wrapper.clientHeight*2+1,.5),th.setFromCamera(vh,b._camera),th.intersectObjects(Fb(b._overlays).filter(function(b){return b.hasEventListener(a)}).concat(b.building.floors).map(function(a){return a.object3D}).filter(function(a){return a.visible}),!0)},function(a){a.control.onClickListener=function(b){var c,d=wh("click",a,b);d&&0!==d.length&&(d[0].object.handler&&d[0].object.handler.isOverlay&&(c=d[0].object.handler,d[0].object.handler.dispatchEvent({type:"click",message:{overlay:c,
domEvent:b}})),a.hasEventListener("click"))&&(d=d.filter(function(a){return"floor"===a.object.name})[0])&&a.dispatchEvent({type:"click",message:{x:Math.round(d.point.x),y:-Math.round(d.point.z),floor:d.object.handler.name,overlay:c,domEvent:b}})};a.control.onHoverListener=function(b){b=wh("hover",a,b);b&&b.length}}),th,uh,vh,wh,gc=function(){function a(){r(this,a)}return v(a,[{key:"show",value:function(){this.visible=!0}},{key:"hide",value:function(){this.visible=!1}},{key:"removeFromParent",value:function(){this.object3D&&
this.object3D.parent&&this.object3D.parent.remove(this.object3D)}},{key:"setLocation",value:function(a){this.currentLocation=a;this.object3D.position.copy(a.localPosition)}}]),a}();Object.assign(gc.prototype,A.EventDispatcher.prototype);zi(gc);Object.defineProperties(gc.prototype,{visible:{enumerable:!0,configurable:!1,get:function(){return this.object3D&&this.object3D.visible},set:function(a){this.object3D&&(this.object3D.visible=a)}},isOverlay:{value:!0,writable:!1}});var xh=function(a){function b(a){var c,
e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(r(this,b),(c=P(this,W(b).call(this))).location=a,c.options=e,"function"!=typeof c.initialize||"function"!=typeof c.render)throw Error("initialize && render must be implements");return c.$el=c.initialize(),c}return C(b,gc),b}();Object.defineProperties(xh.prototype,{isHTMLOverlay:{value:!0,writable:!1}});var bl=new A.Vector2(20,20),cl=function(a){function b(a){var c,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r(this,
b),(c=P(this,W(b).call(this))).options=e,c.currentLocation=a,c.location=a,c.floor=a.floor,c.position=a.localPosition,c.makeObject3D(),c}return C(b,gc),v(b,[{key:"makeObject3D",value:function(){var a=this,b=this.options.icon;this.texture=(new A.TextureLoader).load(b,function(a){a.needsUpdate=!0});this.texture.minFilter=A.LinearFilter;this.material=new A.SpriteMaterial({map:this.texture,sizeAttenuation:!1,transparent:!0,alphaTest:.1,depthTest:!1});var e=new A.Sprite(this.material);b=this.options.size||
bl;var f=this.options.align||"CENTER";return e.width=b.width,e.height=b.height,e.scale.set(b.width/this.canvasScale,b.width/this.canvasScale,1),e.position.copy(this.position),e.handler=this,e.type="Marker","CENTER"===f?e.center.set(.5,.5):"BOTTOM"===f&&e.center.set(.5,0),e.renderOrder=10,e.onViewModeChange=function(b){return e.position.setZ(b?a.currentLocation.z:3)},this.object3D=e}}]),b}(),dl=function(a){function b(a,d){return r(this,b),P(this,W(b).call(this,a,d))}return C(b,xh),v(b,[{key:"initialize",
value:function(){var a=document.createElement("span");return a.style.border="solid 1px red",a.style.background="white",a.style.position="absolute",a.style.padding="3px 4px",a.style.padding="3px 4px",a.style.width="130px",a.style.fontSize="14px",a.appendChild(document.createTextNode(this.options.content)),a}},{key:"render",value:function(a){this.$el.style.left=a.x+"px";this.$el.style.top=a.y-this.$el.clientHeight+"px";this.$el.style.zIndex=a.zIndex}}]),b}(),el={Overlay:gc,HTMLOverlay:xh,Marker:cl,
HTMLInfoWindow:dl},fl=function(a){Object.defineProperties(gc.prototype,{canvasScale:{enumerable:!1,configurable:!1,get:function(){return a._canvasScale}}})},Ai=function(a,b,c,d){a.addEventListener(b,c,d)},gl=function(a,b,c,d){a.removeEventListener(b,c,d)},ze=2*Math.PI/60/60,yh=function(){function a(b,c){r(this,a);this.camera=b;this.wrapper=c;this.minPolarAngle=0;this.maxPolarAngle=Math.PI/2;this.minDistance=0;this.maxDistance=1/0;this.viewChanged=this.scrollWheelZoomEnabled=this.enabled=!0;this.onHoverListener=
this.onClickListener=null;this.is3dMode=!0;this._initListeners();this._initVars()}return v(a,[{key:"destroy",value:function(){this._initListeners(!0)}},{key:"reset",value:function(){this._initVars()}},{key:"pan",value:function(a,c){a=this.viewToWorld(a).sub(this.viewToWorld(c));this.camera.position.add(a);this.center.add(a);this.viewChanged=!0}},{key:"rotateLeft",value:function(){this.thetaDelta-=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ze}},{key:"rotateRight",value:function(){this.thetaDelta+=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:ze}},{key:"rotateUp",value:function(){this.phiDelta-=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ze}},{key:"rotateDown",value:function(){this.phiDelta+=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ze}},{key:"zoomIn",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1.25;this.scale*=a;this.currentScale*=a}},{key:"zoomOut",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:
.8;this.scale*=a;this.currentScale*=a}},{key:"changeViewMode",value:function(a){var b=this;if(this.is3dMode!==a){var d=10;if(this.is3dMode=a)var e=setInterval(function(){b.phiDelta=b.phi/10;--d||clearInterval(e)},1E3/60);else var f=setInterval(function(){b.phiDelta=-b.phi/10;--d||clearInterval(f)},1E3/60)}}},{key:"update",value:function(){var a=this.camera.position,c=a.clone().sub(this.center),d=Math.atan2(c.x,c.z),e=Math.atan2(Math.sqrt(c.x*c.x+c.z*c.z),c.y);this.autoRotate&&this.rotateLeft(ze);
d+=this.thetaDelta;e+=this.phiDelta;e=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,e));e=this.phi=Math.max(1E-7,Math.min(.37*Math.PI-1E-7,e));this.is3dMode&&(this.phi=e);var f=c.length()/this.scale;f=Math.max(this.minDistance,Math.min(this.maxDistance,f));c.x=f*Math.sin(e)*Math.sin(d);c.y=f*Math.cos(e);c.z=f*Math.sin(e)*Math.cos(d);a.copy(this.center).add(c);this.camera.lookAt(this.center);this.phiDelta=this.thetaDelta=0;this.scale=1;0<this.lastPosition.distanceTo(this.camera.position)&&
(this.lastPosition.copy(this.camera.position),this.viewChanged=!0)}},{key:"_initVars",value:function(){this.startPosition=new A.Vector2;this.endPosition=new A.Vector2;this.deltaVector=new A.Vector2;this.touchStartPoints=[new A.Vector2,new A.Vector2,new A.Vector2];this.touchEndPoints=[new A.Vector2,new A.Vector2,new A.Vector2];this.cameraInverseMatrix=new A.Matrix4;this.thetaDelta=this.phiDelta=0;this.currentScale=this.scale=1;this.state=-1;this.lastPosition=new A.Vector3;this.center=new A.Vector3}},
{key:"_initListeners",value:function(a){a=a?gl:Ai;a(this.wrapper,"touchstart",this,{passive:!1});a(this.wrapper,"mousedown",this,{passive:!1});a(window,"touchend",this,{passive:!1});a(window,"mouseup",this,{passive:!1});a(window,"touchmove",this,{passive:!1});a(window,"mousemove",this);a(this.wrapper,"mousewheel",this);a(window,"contextmenu",this,!1)}},{key:"handleEvent",value:function(a){switch(a.type){case "touchstart":case "mousedown":a.touches&&1<a.touches.length?this._touchStart(a):this._start(a);
break;case "touchmove":case "mousemove":a.touches&&1<a.touches.length&&(1===this.state||0===this.state)?this._touchMove(a):this._move(a);break;case "mouseout":this.state=-1;break;case "touchend":case "mouseup":this._end(a);break;case "mousewheel":this._wheel(a);break;case "contextmenu":a.preventDefault()}a.preventDefault()}},{key:"_start",value:function(a){this.enabled&&(-1===this.state&&(0===a.button||a.touches&&1==a.touches.length?this.state=3:1===a.button?this.state=1:2===a.button&&(this.state=
0)),a=a.touches?a.touches[0]:a,this.startPosition.set(a.pageX,a.pageY))}},{key:"_move",value:function(a){if(this.enabled)if(-1!==this.state){if(a=a.touches?a.touches[0]:a,this.endPosition.set(a.pageX,a.pageY),this.deltaVector.subVectors(this.endPosition,this.startPosition),0!=this.deltaVector.length())0===this.state?(this.rotateLeft(2*Math.PI*this.deltaVector.x/1800*2),this.is3dMode&&this.rotateUp(2*Math.PI*this.deltaVector.y/1800*2)):1===this.state?0<this.deltaVector.y?this.zoomIn():this.zoomOut():
3!==this.state&&2!==this.state||(this.state=2,this.pan(this.startPosition,this.endPosition)),this.startPosition.copy(this.endPosition)}else this.onHoverListener&&this.wrapper.contains(a.target)&&this.onHoverListener(a)}},{key:"_end",value:function(a){if(this.enabled&&-1!==this.state){var b=this.state;this.state=-1;3===b&&this.onClickListener&&this.onClickListener(a)}}},{key:"_wheel",value:function(a){this.enabled&&this.scrollWheelZoomEnabled&&(a=Math.pow(1.05,a.wheelDelta?a.wheelDelta/120:-a.detail/
3),this.scale*=a,this.currentScale*=a)}},{key:"_touchStart",value:function(a){var b=this;this.enabled&&(Fb(a.touches).filter(function(a,b){return 3>b}).map(function(a,c){return b.touchStartPoints[c].set(a.pageX,a.pageY)}),2===a.touches.length?(this.state=1,this.span.innerHTML="_touchStart"):this.state=0)}},{key:"_touchMove",value:function(a){var b=this;if(this.enabled&&-1!==this.state){if(Fb(a.touches).filter(function(a,b){return 3>b}).map(function(a,c){return b.touchEndPoints[c].set(a.pageX,a.pageY)}),
this.span.innerHTML="_touchMove",1===this.state){a=this.touchStartPoints[1].distanceTo(this.touchStartPoints[0]);var d=this.touchEndPoints[1].distanceTo(this.touchEndPoints[0]);if(5>Math.abs(a-d))return;a<d?this.zoomIn(1.03):this.zoomOut(1/1.03)}this.touchEndPoints.forEach(function(a,c){return b.touchStartPoints[c].copy(a)})}}}]),a}(),zh,zf,Aj;Object.assign(yh.prototype,Object.create(A.EventDispatcher.prototype));Object.assign(yh.prototype,{viewToWorld:(zh=new A.Raycaster,zf=new A.Vector3(0,0,.5),
Aj=new A.Plane(new A.Vector3(0,1,0),0),function(a){zf.x=a.x/this.wrapper.clientWidth*2-1;zf.y=-a.y/this.wrapper.clientHeight*2+1;zh.setFromCamera(zf,this.camera);a=new A.Vector3;return zh.ray.intersectPlane(Aj,a),a})});var hl=function b(){r(this,b)},hc=function(b){for(var c=[],d=0;d<b.length;d+=2){var e=new A.Vector2(b[d],b[d+1]);0<d?1E-4<c[c.length-1].manhattanDistanceTo(e)&&c.push(e):c.push(e)}return c},il=function(b,c){var d=document.createElement("div"),e=document.createDocumentFragment();d.innerHTML=
c;c=0;for(var f=(d=d.childNodes).length;c<f;c+=1)e.appendChild(d[c].cloneNode(!0));b.appendChild(e)},jl=function(b){b=b.replace(/<%=(.+?)%>/g,"`); \n  echo( $1 ); \n  echo(`").replace(/<%([\s\S]+?)%>/g,"`); \n $1 \n  echo(`");b='(function parse(data){\n      let output = "";\n      function echo(html){\n        output += html;\n      }\n      '.concat("echo(`"+b+"`);","\n      return output;\n    })");return eval(b)}("\n<ul class='imap-floor-control'>\n  <% for(let i=0; i < data.length; i++) { %>\n    <li><%= data[i] %></li>\n  <% } %>\n</ul>\n"),
kl=function(b){function c(b,e){var d;return r(this,c),(d=P(this,W(c).call(this))).camera=b,d.wrapper=e,d}return C(c,hl),v(c,[{key:"show",value:function(b,c){var d=this;this.building=c;var e=new Map(c.floors.map(function(b){return[b.info.name,b]}));2>e.size||(il(b,jl(["All"].concat(Fb(c.floors.map(function(b){return b.name}).reverse())))),Fb(b.getElementsByTagName("li")).forEach(function(b){return b.addEventListener("click",function(){return d.showFloor(e.get(b.innerHTML))})}))}},{key:"showFloor",
value:function(b){b?this.building.showFloor(b.name):this.building.showAllFloors();this.building.updateBound(this.camera)}}]),c}(),cd=function c(){r(this,c)};Object.assign(cd.prototype,{parsePoints:hc});var ll=function(c){Object.defineProperties(cd.prototype,{map:{enumerable:!1,configurable:!0,get:function(){return c}},mapStyle:{enumerable:!1,configurable:!0,get:function(){return c.getMapStyle()}},canvasScale:{enumerable:!1,configurable:!0,get:function(){return c._canvasScale}}})},Af={MODE_3D:"3d",
MODE_2D:"2d"},ml=Object.freeze({ViewMode:Af,Scale:{Max:1}}),nl=function(){function c(c,d,e,f,k,m){g.subVectors(c,e).addScalar(.5).multiply(f);void 0!==k?(h.x=m*g.x-k*g.y,h.y=k*g.x+m*g.y):h.copy(g);c.copy(d);c.x+=h.x;c.y+=h.y}var d=new n,e=new n,f=new da,g=new x,h=new x,k=new I,m=new n,l=new n,p=new n;return function(g){d.set(this.width,this.height,1);k.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld);e.setFromMatrixPosition(this.modelViewMatrix);e.applyMatrix4(k);e.project(g._camera);
f.copy(e).applyMatrix4(g.viewportMatrix);var h,n;g=this.material.rotation;0!==g&&(n=Math.cos(g),h=Math.sin(g));g=this.center;c(m.set(-.5,-.5,0),f,g,d,h,n);c(l.set(.5,-.5,0),f,g,d,h,n);c(p.set(.5,.5,0),f,g,d,h,n);this.boundBox.setFromPoints([m,l,p])}}();Object.assign(vb.prototype,{updateBound:nl});cf.prototype=Object.assign(Object.create(vb.prototype),{constructor:cf,isLabel:!0,setText:function(c){this.text=c;c=this.options.fontface||"sans-serif";var d=this.options.fontsize||16,e=this.options.color||
"rgba(0,0,0,1)",f=this.canvas;f.width=512;var g=f.getContext("2d");g.font=d+"px "+c;g=g.measureText(this.text);f.width=g.width||1;f.height=1.44*d;(g=f.getContext("2d")).font=d+"px "+c;g.fillStyle=e;g.strokeStyle="#ffffff";g.lineWidth=3;g.strokeText(this.text,0,d);g.fillText(this.text,0,d);this.texture.needsUpdate=!0;this.originScale=this.scale.clone();this.width=f.width;this.height=f.height}});var ol=function(c){function d(c,f){var e;r(this,d);(e=P(this,W(d).call(this,f))).floor=c;c=(e.info=f).name;
return e.name=c,e}return C(d,cd),v(d,[{key:"makeObject3D",value:function(){var c=this,d=hc(this.info.outline[0][0]),g=new A.Shape(d),h=new A.Group;var k=new A.ShapeGeometry(g);var m=new A.MeshStandardMaterial({roughness:.8,metalness:.5});if((new A.TextureLoader).load("./textures/floor-board.jpg",function(c){c.wrapS=A.RepeatWrapping;c.wrapT=A.RepeatWrapping;c.anisotropy=16;c.repeat.set(.005,.005);c.minFilter=A.LinearFilter;m.map=c;m.needsUpdate=!0}),(new A.Mesh(k,m)).position.set(0,0,1),this.info.walls){var l=
new A.MeshPhongMaterial({color:1401481,emissive:468276,side:A.DoubleSide,flatShading:!0,opacity:.5,transparent:!0});this.info.walls.forEach(function(d){d=hc(d);var e=new A.BoxGeometry(5,d[0].distanceTo(d[1]),c.floor.info.height),f=new A.PlaneGeometry(5,d[0].distanceTo(d[1])),g=new A.Mesh(e,l);g.position.set((d[0].x+d[1].x)/2,(d[0].y+d[1].y)/2,c.floor.info.height/2);g.rotation.z=d[0].sub(d[1]).angle()+Math.PI/2;g.onViewModeChange=function(d){g.geometry=d?e:f;g.position.setZ(d?c.floor.info.height/2:
2)};h.add(g)})}else{k=new A.MeshLambertMaterial(this.mapStyle.roomStyle[this.info.category||this.info.type]||this.mapStyle.roomStyle.default);var n=new A.ExtrudeGeometry(g,{depth:this.floor.info.height,bevelEnabled:!1}),r=new A.ShapeGeometry(g),v=new A.Mesh(n,k);v.onViewModeChange=function(c){v.geometry=c?n:r;v.position.setZ(c?0:1)};h.add(v);k=(new A.Geometry).setFromPoints(d);var u=new A.LineLoop(k,new A.LineBasicMaterial(this.mapStyle.strokeStyle));u.position.set(0,0,this.floor.info.height);u.onViewModeChange=
function(d){return u.position.setZ(d?c.floor.info.height:2)};h.add(u)}if(this.info.pillars){var t=new A.MeshLambertMaterial({color:16777215,emissive:5592405}),x=new A.Box2,z=new A.Vector2,y=new A.Vector2;this.info.pillars.forEach(function(d){d=hc(d);x.setFromPoints(d).getCenter(z);x.getSize(y);var e=new A.BoxBufferGeometry(y.width,y.height,c.floor.info.height),f=new A.PlaneGeometry(y.width,y.height),g=new A.Mesh(e,t);g.position.set(z.x,z.y,c.floor.info.height/2);g.onViewModeChange=function(d){g.geometry=
d?e:f;g.position.setZ(d?c.floor.info.height/2:2)};h.add(g)})}h.name="room";h.handler=this;h.box=(new A.Box2).setFromPoints(d);var B=new cf(this.info.name);d=h.box.getCenter(new A.Vector2);B.position.set(d.x,d.y,this.floor.info.height+5);B.scale.set(B.width/this.canvasScale,B.height/this.canvasScale,1);B.center.set(.5,0);B.onViewModeChange=function(d){return B.position.setZ(d?c.floor.info.height+5:3)};h.add(B);return h.label=B,h}}]),d}(),Bf=new A.Vector2(18,18),pl=function(c){function d(c,f){var e;
r(this,d);c=((e=P(this,W(d).call(this,c))).info=c).name;return e.name=c,e.floor=f,e.center=new A.Vector2(e.info.outline[0][0][0],e.info.outline[0][0][1]),e.boundBox=new A.Box2,e}return C(d,cd),v(d,[{key:"render",value:function(){if(!this.bounds)throw Error("call updateOutline first");}},{key:"makeObject3D",value:function(){var c=this,d=this.mapStyle.materialMap.get(this.info.type),g=new A.Sprite(d);return g.width=Bf.width,g.height=Bf.height,g.scale.set(Bf.width/this.canvasScale,Bf.height/this.canvasScale,
1),g.position.copy(this.center).setZ(this.floor.info.height+5),g.handler=this,g.center.set(.5,0),g.boundBox=new A.Box2,g.onViewModeChange=function(d){return g.position.setZ(d?c.floor.info.height+5:3)},this.object3D=g}}]),d}(),ql=function(c){function d(c){var e;r(this,d);var g=((e=P(this,W(d).call(this,c))).info=c).funcAreas;c=c.pubPoint;return e.name=e.info.name,e.rooms=[],g.forEach(function(c){e.rooms.push(new ol(ka(ka(e)),c))}),e.pubPoints=[],c.forEach(function(c){e.pubPoints.push(new pl(c,ka(ka(e))))}),
e}return C(d,cd),v(d,[{key:"makeObject3D",value:function(){var c=new A.Group,d=this.info.height;(!d||1E-4>d)&&(d=500);this.info.height=d;var g=hc(this.info.outline[0][0]).reverse(),h=new A.Shape(g);this.info.outline[1]&&this.info.outline[1].map(function(c){h.holes.push(new A.Path(hc(c)))});var k=new A.ExtrudeBufferGeometry(h,{depth:10,bevelEnabled:!1}),m=new A.ShapeGeometry(h);g=new A.MeshPhongMaterial(this.mapStyle.floor);var l=new A.Mesh(k,g);return l.name="floor",l.handler=this,l.position.set(0,
0,-10),l.onViewModeChange=function(c){l.geometry=c?k:m;l.position.setZ(c?-10:-1)},c.add(l),c.height=d,c.handler=this,c.name="floor",c.sprites=[],this.rooms.filter(function(c){return"\u4e2d\u7a7a\u533a\u57df"!==c.name}).forEach(function(d){d=d.makeObject3D();c.sprites.push(d.label);c.add(d)}),this.pubPoints.forEach(function(d){d=d.makeObject3D();c.sprites.push(d);c.add(d)}),this.object3D=c}},{key:"render",value:function(c){c.beginPath();this.drawOutline.getPoints().forEach(function(d,e){0===e?c.moveTo(d.x,
-d.y):c.lineTo(d.x,-d.y)});c.closePath();c.fillStyle="#e0e0e0";c.fill();c.strokeStyle="#666666";c.lineWidth=1;c.stroke();this.rooms.forEach(function(d){d.render(c)})}}]),d}(),rl=function(c){function d(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,d);var f=P(this,W(d).call(this,c.building));var g=c.building,h=g.groundFloors;h=void 0===h?1:h;var k=g.underFloors;k=void 0===k?0:k;g=g.defaultFloor;var l=c.floors;l=void 0===l?[]:l;var n=c.floorSize;n=void 0===n?l.length:n;if(f.info=
c.building,0>h||0>k||0===h+k||h+k!=n)throw Error("Invalid floor count.");return f.groundFloor=h,f.underFloor=k,f.showFloor(void 0===g?1:g),f.floors=[],l.forEach(function(c){f.floors.push(new ql(c))}),f.object3D=f.makeObject3D(),f}return C(d,cd),v(d,[{key:"render",value:function(c){if(!this.drawOutline)throw Error("call updateOutline first");this.getFloor(this.currentFloorNum).render(c)}},{key:"makeObject3D",value:function(){var c=this,d=new A.Group;d.name="building";d.sprites=[];this.floors.forEach(function(e){var f,
g=e.makeObject3D();d.add(g);(f=d.sprites).push.apply(f,Fb(g.sprites));g.visible=c.getFloor(c.currentFloorNum)===e});var g=hc(this.info.outline[0][0]);if(0<g.length){g=new A.Shape(g);var h={depth:4*d.children.map(function(c){return c.height}).reduce(function(c,d){return c+d}),bevelEnabled:!1};g=new A.ExtrudeGeometry(g,h);g=new A.Mesh(g,new A.MeshBasicMaterial(this.mapStyle.building));g.material.depthTest=!1;d.outline=g}return d.rotateOnAxis(new A.Vector3(1,0,0),-Math.PI/2),d.handler=this,d}},{key:"updateBound",
value:function(c){var d=this;this.floors.forEach(function(e){if(d.showAll||e.name===d.currentFloorNum)for(var f in e.object3D.sprites){var g=e.object3D.sprites[f];g.updateBound(c);g.visible=!0;for(var l=0;l<f;l++){var n=e.object3D.sprites[l];if(n.visible&&n.boundBox.intersectsBox(g.boundBox)){g.visible=!1;break}}}})}},{key:"showFloor",value:function(c){var d=this;if(c>this.groundFloor||c<-this.underFloor||0===c)throw Error("Invalid floor number.");this.currentFloorNum=c;this.showAll=!1;this.object3D&&
(this.object3D.visible=!0,this.object3D.children.filter(function(c){return"floor"===c.name}).forEach(function(e){e.visible=e.handler===d.getFloor(c)||e.handler.name===c;e.position.set(0,0,0)}),this.object3D.scale.set(1,1,1))}},{key:"showAllFloors",value:function(){if(this.showAll=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],this.object3D)this.object3D.visible=!0,this.object3D.children.forEach(function(c,d){c.visible=!0;"floor"===c.name&&c.position.set(0,0,d*c.height*4)}),this.object3D.scale.set(1,
1,1)}},{key:"getCurrentFloor",value:function(){return this.currentFloorNum}},{key:"getFloor",value:function(c){return this.floors.find(function(d){return d.name==c})}}]),d}(),Bj=function(){function c(d){r(this,c);A.Loader.call(this,d);this.withCredentials=!1;this.is3d=d;this.jsonLoader=new A.FileLoader}return v(c,[{key:"load",value:function(c){var d=this;return new Promise(function(e,g){return d.jsonLoader.load(c,function(c){c=JSON.parse(c);e(d.parse(c))},void 0,function(c){return g(c)})})}},{key:"parse",
value:function(c){return new rl(c.data)}}]),c}();Object.assign(Bj.prototype,Object.create(A.Loader.prototype).__proto__);var sl={name:"test",building:{color:"#000000",opacity:.1,transparent:!0,depthTest:!1},floor:{color:"#f4f4f4",opacity:1,transparent:!1},selected:"#ffff55",strokeStyle:{color:"#5C4433",opacity:.5,transparent:!0,linewidth:2},fontStyle:{color:"#231815",fontsize:40,fontface:"Helvetica, MicrosoftYaHei "},pubPointImg:{11001:"img/toilet.png",11002:"img/ATM.png",21001:"img/stair.png",21002:"img/escalator.png",
21003:"img/lift.png",22006:"img/entry.png"},roomStyle:{101:{color:"#1f77b4",opacity:.7,transparent:!0},102:{color:"#aec7e8",opacity:.7,transparent:!0},103:{color:"#ffbb78",opacity:.7,transparent:!0},104:{color:"#98df8a",opacity:.7,transparent:!0},105:{color:"#bcbd22",opacity:.7,transparent:!0},106:{color:"#2ca02c",opacity:.7,transparent:!0},107:{color:"#dbdb8d",opacity:.7,transparent:!0},108:{color:"#EE8A31",opacity:.7,transparent:!0},109:{color:"#c49c94",opacity:.7,transparent:!0},300:{color:"#AAAAAA",
opacity:.7,transparent:!0},400:{color:"#D3D3D3",opacity:.7,transparent:!0},default:{color:"#c49c94",opacity:.4,transparent:!0}}},Cj=function(){function c(){r(this,c);this.jsonLoader=new A.FileLoader;this.textureLoader=new A.TextureLoader;this.themeMap=new Map;this._loadTheme("normal",sl)}return v(c,[{key:"load",value:function(c,e){var d=this;this.jsonLoader.load(e,function(e){return d._loadTheme(c,e)},void 0,function(c){})}},{key:"getTheme",value:function(){return this.themeMap.get(0<arguments.length&&
void 0!==arguments[0]?arguments[0]:"normal")||this.themeMap.get("normal")}},{key:"_loadTheme",value:function(c,e){var d=this;e="string"==typeof e?JSON.parse(e):e;this.themeMap.set(c,e);Object.keys(e.pubPointImg)&&(e.materialMap=new Map,Object.entries(e.pubPointImg).forEach(function(c){var f=dd(c,2);c=f[0];f=d.textureLoader.load(f[1],function(c){c.needsUpdate=!0;d.textureUpdated=!0});f.minFilter=A.LinearFilter;f=new A.SpriteMaterial({map:f,sizeAttenuation:!1,transparent:!0,alphaTest:.1});e.materialMap.set(c,
f)}));this.themeUpdated=!0}}]),c}();Object.assign(Cj.prototype,Object.create(A.Loader.prototype).__proto__);(function(c,d){void 0===d&&(d={});d=d.insertAt;if(c&&"undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.type="text/css";"top"===d&&e.firstChild?e.insertBefore(f,e.firstChild):e.appendChild(f);f.styleSheet?f.styleSheet.cssText=c:f.appendChild(document.createTextNode(c))}})(".imap-controls, .imap-overlays {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: -webkit-fill-available;\r\n    height: -webkit-fill-available;\r\n    pointer-events: none;\r\n    overflow: hidden;\r\n}\r\n\r\n.imap-controls *, .imap-overlays * {\r\n    pointer-events: auto;\r\n}\r\n\r\n.imap-floor-control {\r\n    position: absolute;\r\n    right: 10px;\r\n    top: 10px;\r\n    z-index: 100;\r\n    background: white;\r\n    border: solid 1px #dfdfdf;\r\n    text-align: center;\r\n    border-radius: 3px;\r\n    font-size: 14px;\r\n    padding: 0;\r\n}\r\n\r\n.imap-floor-control li {\r\n    list-style: none;\r\n    line-height: 25px;\r\n    width: 25px;\r\n    height: 25px;\r\n    border-bottom: solid 1px #dfdfdf;\r\n}\r\n\r\n.imap-floor-control li:last-child {\r\n    border-bottom: none;\r\n}");
var ic=function e(d){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r(this,e);this._init(d,f)};(function(d){Object.assign(d.prototype,Ja.prototype);Object.assign(d.prototype,{_init:function(d,f){this.options=f;this.$wrapper="string"==typeof d?document.querySelector(d):d;this.$wrapper.style.overflow="hidden";this._overlays=new Set;Vk(this);this.control=new yh(this._camera,this.$mapWrapper);this.floorControl=new kl(this._camera,this.$mapWrapper);al(this);this.mapLoader=new Bj(!1);this.themeLoader=
new Cj;ll(this);fl(this);window.map=this}})})(ic);zi(ic);(function(d){Object.assign(d.prototype,{addOverlay:function(d){this._overlays.add(d);this._addOverlay(d)},removeOverlay:function(){for(var d=arguments.length,f=Array(d),g=0;g<d;g++)f[g]=arguments[g];this._removeOverlays(f)},clearOverlays:function(){this._removeOverlays(this._overlays)},_addOverlay:function(d){if(this.building)if(d.isHTMLOverlay)this.$overlayWrapper.appendChild(d.$el),d.render(this.locationToViewport(d.location));else{var e=
this.building.getFloor(d.floor).object3D;e.add(d.object3D);d.onAppend&&d.onAppend(e)}},_removeOverlays:function(d){var e=this;d.forEach(function(d){d.removeFromParent();e._overlays.delete(d)})}})})(ic);(function(d){Object.assign(d.prototype,{load:function(d){var e=this;this.mapLoader.load(d).then(function(d){e.floorControl.show(e.$controlWrapper,d);e.building=d;e.renderer.setClearColor("#ffffff");e._scene.add(d.object3D);d.showFloor("F1");e.dispatchEvent({type:"mapLoaded"});e._overlays.forEach(function(d){return e._addOverlay(d)});
e.setDefaultView();e.renderStarted||(e.renderStarted=!0,e.render());e.renderer.domElement.style.opacity=1;e.building.updateBound(e);e.setViewMode(e.options.viewMode)})},loadTheme:function(){},getMapStyle:function(){return this.themeLoader.getTheme()}})})(ic);(function(d){var e,f;Object.assign(d.prototype,{setDefaultView:function(){var d=Math.PI/2;d=[Math.cos(d),Math.sin(d)];return this._camera.position.set(5E3*-d[1],5E3*Math.sin(75*Math.PI/180),5E3*d[0]),this._camera.lookAt(this._scene.position),
this.control.reset(),this.control.viewChanged=!0,this},setViewMode:function(d){d!==Af.MODE_2D&&d!==Af.MODE_3D||d===this._currentViewMode||(this._currentViewMode=d,Sk(this,d===Af.MODE_3D))},locationToViewport:(e=new A.Vector3,f=new A.Vector4,function(d){e.copy(d);d=this.building.getFloor(d.floor);if(!d)throw Error("invalid floor");return(d=d.object3D).visible?(d.localToWorld(e),d=e.distanceTo(this._camera.position),e.project(this._camera),f.copy(e).applyMatrix4(this.viewportMatrix).round(),{x:f.x,
y:f.y,distance:d}):{x:-1/0,y:-1/0}})});Object.defineProperties(d.prototype,{viewportMatrix:{writable:!1,value:new A.Matrix4}})})(ic);(function(d){Object.assign(d.prototype,{render:function(){var d=this;this.renderStarted=!0;requestAnimationFrame(function(){return d.render()});this.control.update();this.control.viewChanged?(this.control.viewChanged=!1,this._camera.updateProjectionMatrix(),this.updateProjectionMatrix=!0,Bi(this)):this.updateProjectionMatrix&&(this.updateProjectionMatrix=!1,Bi(this));
this.renderer.clear();this.renderer.render(this._scene,this._camera);this.renderer.clearDepth()}})})(ic);return function(d){for(var e=1;e<arguments.length;e++){var f=null!=arguments[e]?arguments[e]:{},g=Object.keys(f);"function"==typeof Object.getOwnPropertySymbols&&(g=g.concat(Object.getOwnPropertySymbols(f).filter(function(d){return Object.getOwnPropertyDescriptor(f,d).enumerable})));g.forEach(function(e){var g=f[e];e in d?Object.defineProperty(d,e,{value:g,enumerable:!0,configurable:!0,writable:!0}):
d[e]=g})}return d}({Map:ic},ml,{Location:function h(e,f,g){var k=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;r(this,h);this.floor=e;this.x=f;this.y=g;this.z=k;this.localPosition=new A.Vector3(f,g,k)}},el,A,{Label:cf})});
